/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId])
/******/ 			return installedModules[moduleId].exports;
/******/
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// identity function for calling harmony imports with the correct context
/******/ 	__webpack_require__.i = function(value) { return value; };
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, {
/******/ 				configurable: false,
/******/ 				enumerable: true,
/******/ 				get: getter
/******/ 			});
/******/ 		}
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = 6);
/******/ })
/************************************************************************/
/******/ ([
/* 0 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _fastclick = __webpack_require__(3);\n\nvar _fastclick2 = _interopRequireDefault(_fastclick);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n_fastclick2.default.attach(document.body);//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMC5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL2pzL19mYXN0Y2xpY2suanM/MTJkMiJdLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG5cbnZhciBfZmFzdGNsaWNrID0gcmVxdWlyZSgnZmFzdGNsaWNrJyk7XG5cbnZhciBfZmFzdGNsaWNrMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2Zhc3RjbGljayk7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cbl9mYXN0Y2xpY2syLmRlZmF1bHQuYXR0YWNoKGRvY3VtZW50LmJvZHkpO1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vanMvX2Zhc3RjbGljay5qc1xuLy8gbW9kdWxlIGlkID0gMFxuLy8gbW9kdWxlIGNodW5rcyA9IDAiXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZVJvb3QiOiIifQ==");

/***/ }),
/* 1 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _webfontloader = __webpack_require__(5);\n\nvar _webfontloader2 = _interopRequireDefault(_webfontloader);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n_webfontloader2.default.load({\n  google: {\n    families: ['Roboto']\n  }\n});//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMS5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL2pzL19mb250cy5qcz9mMDViIl0sInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcblxudmFyIF93ZWJmb250bG9hZGVyID0gcmVxdWlyZSgnd2ViZm9udGxvYWRlcicpO1xuXG52YXIgX3dlYmZvbnRsb2FkZXIyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfd2ViZm9udGxvYWRlcik7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cbl93ZWJmb250bG9hZGVyMi5kZWZhdWx0LmxvYWQoe1xuICBnb29nbGU6IHtcbiAgICBmYW1pbGllczogWydSb2JvdG8nXVxuICB9XG59KTtcblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL2pzL19mb250cy5qc1xuLy8gbW9kdWxlIGlkID0gMVxuLy8gbW9kdWxlIGNodW5rcyA9IDAiXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlUm9vdCI6IiJ9");

/***/ }),
/* 2 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _plyr = __webpack_require__(4);\n\nvar _plyr2 = _interopRequireDefault(_plyr);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n_plyr2.default.setup({\n  iconUrl: '/wp-content/themes/flex-with-benefits/images/plyr.svg'\n});//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMi5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL2pzL192aWRlb3MuanM/NjAyNyJdLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG5cbnZhciBfcGx5ciA9IHJlcXVpcmUoJ3BseXInKTtcblxudmFyIF9wbHlyMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3BseXIpO1xuXG5mdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfVxuXG5fcGx5cjIuZGVmYXVsdC5zZXR1cCh7XG4gIGljb25Vcmw6ICcvd3AtY29udGVudC90aGVtZXMvZmxleC13aXRoLWJlbmVmaXRzL2ltYWdlcy9wbHlyLnN2Zydcbn0pO1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vanMvX3ZpZGVvcy5qc1xuLy8gbW9kdWxlIGlkID0gMlxuLy8gbW9kdWxlIGNodW5rcyA9IDAiXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VSb290IjoiIn0=");

/***/ }),
/* 3 */
/***/ (function(module, exports, __webpack_require__) {

eval("var __WEBPACK_AMD_DEFINE_RESULT__;;(function () {\n\t'use strict';\n\n\t/**\n\t * @preserve FastClick: polyfill to remove click delays on browsers with touch UIs.\n\t *\n\t * @codingstandard ftlabs-jsv2\n\t * @copyright The Financial Times Limited [All Rights Reserved]\n\t * @license MIT License (see LICENSE.txt)\n\t */\n\n\t/*jslint browser:true, node:true*/\n\t/*global define, Event, Node*/\n\n\n\t/**\n\t * Instantiate fast-clicking listeners on the specified layer.\n\t *\n\t * @constructor\n\t * @param {Element} layer The layer to listen on\n\t * @param {Object} [options={}] The options to override the defaults\n\t */\n\tfunction FastClick(layer, options) {\n\t\tvar oldOnClick;\n\n\t\toptions = options || {};\n\n\t\t/**\n\t\t * Whether a click is currently being tracked.\n\t\t *\n\t\t * @type boolean\n\t\t */\n\t\tthis.trackingClick = false;\n\n\n\t\t/**\n\t\t * Timestamp for when click tracking started.\n\t\t *\n\t\t * @type number\n\t\t */\n\t\tthis.trackingClickStart = 0;\n\n\n\t\t/**\n\t\t * The element being tracked for a click.\n\t\t *\n\t\t * @type EventTarget\n\t\t */\n\t\tthis.targetElement = null;\n\n\n\t\t/**\n\t\t * X-coordinate of touch start event.\n\t\t *\n\t\t * @type number\n\t\t */\n\t\tthis.touchStartX = 0;\n\n\n\t\t/**\n\t\t * Y-coordinate of touch start event.\n\t\t *\n\t\t * @type number\n\t\t */\n\t\tthis.touchStartY = 0;\n\n\n\t\t/**\n\t\t * ID of the last touch, retrieved from Touch.identifier.\n\t\t *\n\t\t * @type number\n\t\t */\n\t\tthis.lastTouchIdentifier = 0;\n\n\n\t\t/**\n\t\t * Touchmove boundary, beyond which a click will be cancelled.\n\t\t *\n\t\t * @type number\n\t\t */\n\t\tthis.touchBoundary = options.touchBoundary || 10;\n\n\n\t\t/**\n\t\t * The FastClick layer.\n\t\t *\n\t\t * @type Element\n\t\t */\n\t\tthis.layer = layer;\n\n\t\t/**\n\t\t * The minimum time between tap(touchstart and touchend) events\n\t\t *\n\t\t * @type number\n\t\t */\n\t\tthis.tapDelay = options.tapDelay || 200;\n\n\t\t/**\n\t\t * The maximum time for a tap\n\t\t *\n\t\t * @type number\n\t\t */\n\t\tthis.tapTimeout = options.tapTimeout || 700;\n\n\t\tif (FastClick.notNeeded(layer)) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Some old versions of Android don't have Function.prototype.bind\n\t\tfunction bind(method, context) {\n\t\t\treturn function() { return method.apply(context, arguments); };\n\t\t}\n\n\n\t\tvar methods = ['onMouse', 'onClick', 'onTouchStart', 'onTouchMove', 'onTouchEnd', 'onTouchCancel'];\n\t\tvar context = this;\n\t\tfor (var i = 0, l = methods.length; i < l; i++) {\n\t\t\tcontext[methods[i]] = bind(context[methods[i]], context);\n\t\t}\n\n\t\t// Set up event handlers as required\n\t\tif (deviceIsAndroid) {\n\t\t\tlayer.addEventListener('mouseover', this.onMouse, true);\n\t\t\tlayer.addEventListener('mousedown', this.onMouse, true);\n\t\t\tlayer.addEventListener('mouseup', this.onMouse, true);\n\t\t}\n\n\t\tlayer.addEventListener('click', this.onClick, true);\n\t\tlayer.addEventListener('touchstart', this.onTouchStart, false);\n\t\tlayer.addEventListener('touchmove', this.onTouchMove, false);\n\t\tlayer.addEventListener('touchend', this.onTouchEnd, false);\n\t\tlayer.addEventListener('touchcancel', this.onTouchCancel, false);\n\n\t\t// Hack is required for browsers that don't support Event#stopImmediatePropagation (e.g. Android 2)\n\t\t// which is how FastClick normally stops click events bubbling to callbacks registered on the FastClick\n\t\t// layer when they are cancelled.\n\t\tif (!Event.prototype.stopImmediatePropagation) {\n\t\t\tlayer.removeEventListener = function(type, callback, capture) {\n\t\t\t\tvar rmv = Node.prototype.removeEventListener;\n\t\t\t\tif (type === 'click') {\n\t\t\t\t\trmv.call(layer, type, callback.hijacked || callback, capture);\n\t\t\t\t} else {\n\t\t\t\t\trmv.call(layer, type, callback, capture);\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tlayer.addEventListener = function(type, callback, capture) {\n\t\t\t\tvar adv = Node.prototype.addEventListener;\n\t\t\t\tif (type === 'click') {\n\t\t\t\t\tadv.call(layer, type, callback.hijacked || (callback.hijacked = function(event) {\n\t\t\t\t\t\tif (!event.propagationStopped) {\n\t\t\t\t\t\t\tcallback(event);\n\t\t\t\t\t\t}\n\t\t\t\t\t}), capture);\n\t\t\t\t} else {\n\t\t\t\t\tadv.call(layer, type, callback, capture);\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\n\t\t// If a handler is already declared in the element's onclick attribute, it will be fired before\n\t\t// FastClick's onClick handler. Fix this by pulling out the user-defined handler function and\n\t\t// adding it as listener.\n\t\tif (typeof layer.onclick === 'function') {\n\n\t\t\t// Android browser on at least 3.2 requires a new reference to the function in layer.onclick\n\t\t\t// - the old one won't work if passed to addEventListener directly.\n\t\t\toldOnClick = layer.onclick;\n\t\t\tlayer.addEventListener('click', function(event) {\n\t\t\t\toldOnClick(event);\n\t\t\t}, false);\n\t\t\tlayer.onclick = null;\n\t\t}\n\t}\n\n\t/**\n\t* Windows Phone 8.1 fakes user agent string to look like Android and iPhone.\n\t*\n\t* @type boolean\n\t*/\n\tvar deviceIsWindowsPhone = navigator.userAgent.indexOf(\"Windows Phone\") >= 0;\n\n\t/**\n\t * Android requires exceptions.\n\t *\n\t * @type boolean\n\t */\n\tvar deviceIsAndroid = navigator.userAgent.indexOf('Android') > 0 && !deviceIsWindowsPhone;\n\n\n\t/**\n\t * iOS requires exceptions.\n\t *\n\t * @type boolean\n\t */\n\tvar deviceIsIOS = /iP(ad|hone|od)/.test(navigator.userAgent) && !deviceIsWindowsPhone;\n\n\n\t/**\n\t * iOS 4 requires an exception for select elements.\n\t *\n\t * @type boolean\n\t */\n\tvar deviceIsIOS4 = deviceIsIOS && (/OS 4_\\d(_\\d)?/).test(navigator.userAgent);\n\n\n\t/**\n\t * iOS 6.0-7.* requires the target element to be manually derived\n\t *\n\t * @type boolean\n\t */\n\tvar deviceIsIOSWithBadTarget = deviceIsIOS && (/OS [6-7]_\\d/).test(navigator.userAgent);\n\n\t/**\n\t * BlackBerry requires exceptions.\n\t *\n\t * @type boolean\n\t */\n\tvar deviceIsBlackBerry10 = navigator.userAgent.indexOf('BB10') > 0;\n\n\t/**\n\t * Determine whether a given element requires a native click.\n\t *\n\t * @param {EventTarget|Element} target Target DOM element\n\t * @returns {boolean} Returns true if the element needs a native click\n\t */\n\tFastClick.prototype.needsClick = function(target) {\n\t\tswitch (target.nodeName.toLowerCase()) {\n\n\t\t// Don't send a synthetic click to disabled inputs (issue #62)\n\t\tcase 'button':\n\t\tcase 'select':\n\t\tcase 'textarea':\n\t\t\tif (target.disabled) {\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tbreak;\n\t\tcase 'input':\n\n\t\t\t// File inputs need real clicks on iOS 6 due to a browser bug (issue #68)\n\t\t\tif ((deviceIsIOS && target.type === 'file') || target.disabled) {\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tbreak;\n\t\tcase 'label':\n\t\tcase 'iframe': // iOS8 homescreen apps can prevent events bubbling into frames\n\t\tcase 'video':\n\t\t\treturn true;\n\t\t}\n\n\t\treturn (/\\bneedsclick\\b/).test(target.className);\n\t};\n\n\n\t/**\n\t * Determine whether a given element requires a call to focus to simulate click into element.\n\t *\n\t * @param {EventTarget|Element} target Target DOM element\n\t * @returns {boolean} Returns true if the element requires a call to focus to simulate native click.\n\t */\n\tFastClick.prototype.needsFocus = function(target) {\n\t\tswitch (target.nodeName.toLowerCase()) {\n\t\tcase 'textarea':\n\t\t\treturn true;\n\t\tcase 'select':\n\t\t\treturn !deviceIsAndroid;\n\t\tcase 'input':\n\t\t\tswitch (target.type) {\n\t\t\tcase 'button':\n\t\t\tcase 'checkbox':\n\t\t\tcase 'file':\n\t\t\tcase 'image':\n\t\t\tcase 'radio':\n\t\t\tcase 'submit':\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\t// No point in attempting to focus disabled inputs\n\t\t\treturn !target.disabled && !target.readOnly;\n\t\tdefault:\n\t\t\treturn (/\\bneedsfocus\\b/).test(target.className);\n\t\t}\n\t};\n\n\n\t/**\n\t * Send a click event to the specified element.\n\t *\n\t * @param {EventTarget|Element} targetElement\n\t * @param {Event} event\n\t */\n\tFastClick.prototype.sendClick = function(targetElement, event) {\n\t\tvar clickEvent, touch;\n\n\t\t// On some Android devices activeElement needs to be blurred otherwise the synthetic click will have no effect (#24)\n\t\tif (document.activeElement && document.activeElement !== targetElement) {\n\t\t\tdocument.activeElement.blur();\n\t\t}\n\n\t\ttouch = event.changedTouches[0];\n\n\t\t// Synthesise a click event, with an extra attribute so it can be tracked\n\t\tclickEvent = document.createEvent('MouseEvents');\n\t\tclickEvent.initMouseEvent(this.determineEventType(targetElement), true, true, window, 1, touch.screenX, touch.screenY, touch.clientX, touch.clientY, false, false, false, false, 0, null);\n\t\tclickEvent.forwardedTouchEvent = true;\n\t\ttargetElement.dispatchEvent(clickEvent);\n\t};\n\n\tFastClick.prototype.determineEventType = function(targetElement) {\n\n\t\t//Issue #159: Android Chrome Select Box does not open with a synthetic click event\n\t\tif (deviceIsAndroid && targetElement.tagName.toLowerCase() === 'select') {\n\t\t\treturn 'mousedown';\n\t\t}\n\n\t\treturn 'click';\n\t};\n\n\n\t/**\n\t * @param {EventTarget|Element} targetElement\n\t */\n\tFastClick.prototype.focus = function(targetElement) {\n\t\tvar length;\n\n\t\t// Issue #160: on iOS 7, some input elements (e.g. date datetime month) throw a vague TypeError on setSelectionRange. These elements don't have an integer value for the selectionStart and selectionEnd properties, but unfortunately that can't be used for detection because accessing the properties also throws a TypeError. Just check the type instead. Filed as Apple bug #15122724.\n\t\tif (deviceIsIOS && targetElement.setSelectionRange && targetElement.type.indexOf('date') !== 0 && targetElement.type !== 'time' && targetElement.type !== 'month') {\n\t\t\tlength = targetElement.value.length;\n\t\t\ttargetElement.setSelectionRange(length, length);\n\t\t} else {\n\t\t\ttargetElement.focus();\n\t\t}\n\t};\n\n\n\t/**\n\t * Check whether the given target element is a child of a scrollable layer and if so, set a flag on it.\n\t *\n\t * @param {EventTarget|Element} targetElement\n\t */\n\tFastClick.prototype.updateScrollParent = function(targetElement) {\n\t\tvar scrollParent, parentElement;\n\n\t\tscrollParent = targetElement.fastClickScrollParent;\n\n\t\t// Attempt to discover whether the target element is contained within a scrollable layer. Re-check if the\n\t\t// target element was moved to another parent.\n\t\tif (!scrollParent || !scrollParent.contains(targetElement)) {\n\t\t\tparentElement = targetElement;\n\t\t\tdo {\n\t\t\t\tif (parentElement.scrollHeight > parentElement.offsetHeight) {\n\t\t\t\t\tscrollParent = parentElement;\n\t\t\t\t\ttargetElement.fastClickScrollParent = parentElement;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tparentElement = parentElement.parentElement;\n\t\t\t} while (parentElement);\n\t\t}\n\n\t\t// Always update the scroll top tracker if possible.\n\t\tif (scrollParent) {\n\t\t\tscrollParent.fastClickLastScrollTop = scrollParent.scrollTop;\n\t\t}\n\t};\n\n\n\t/**\n\t * @param {EventTarget} targetElement\n\t * @returns {Element|EventTarget}\n\t */\n\tFastClick.prototype.getTargetElementFromEventTarget = function(eventTarget) {\n\n\t\t// On some older browsers (notably Safari on iOS 4.1 - see issue #56) the event target may be a text node.\n\t\tif (eventTarget.nodeType === Node.TEXT_NODE) {\n\t\t\treturn eventTarget.parentNode;\n\t\t}\n\n\t\treturn eventTarget;\n\t};\n\n\n\t/**\n\t * On touch start, record the position and scroll offset.\n\t *\n\t * @param {Event} event\n\t * @returns {boolean}\n\t */\n\tFastClick.prototype.onTouchStart = function(event) {\n\t\tvar targetElement, touch, selection;\n\n\t\t// Ignore multiple touches, otherwise pinch-to-zoom is prevented if both fingers are on the FastClick element (issue #111).\n\t\tif (event.targetTouches.length > 1) {\n\t\t\treturn true;\n\t\t}\n\n\t\ttargetElement = this.getTargetElementFromEventTarget(event.target);\n\t\ttouch = event.targetTouches[0];\n\n\t\tif (deviceIsIOS) {\n\n\t\t\t// Only trusted events will deselect text on iOS (issue #49)\n\t\t\tselection = window.getSelection();\n\t\t\tif (selection.rangeCount && !selection.isCollapsed) {\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tif (!deviceIsIOS4) {\n\n\t\t\t\t// Weird things happen on iOS when an alert or confirm dialog is opened from a click event callback (issue #23):\n\t\t\t\t// when the user next taps anywhere else on the page, new touchstart and touchend events are dispatched\n\t\t\t\t// with the same identifier as the touch event that previously triggered the click that triggered the alert.\n\t\t\t\t// Sadly, there is an issue on iOS 4 that causes some normal touch events to have the same identifier as an\n\t\t\t\t// immediately preceeding touch event (issue #52), so this fix is unavailable on that platform.\n\t\t\t\t// Issue 120: touch.identifier is 0 when Chrome dev tools 'Emulate touch events' is set with an iOS device UA string,\n\t\t\t\t// which causes all touch events to be ignored. As this block only applies to iOS, and iOS identifiers are always long,\n\t\t\t\t// random integers, it's safe to to continue if the identifier is 0 here.\n\t\t\t\tif (touch.identifier && touch.identifier === this.lastTouchIdentifier) {\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tthis.lastTouchIdentifier = touch.identifier;\n\n\t\t\t\t// If the target element is a child of a scrollable layer (using -webkit-overflow-scrolling: touch) and:\n\t\t\t\t// 1) the user does a fling scroll on the scrollable layer\n\t\t\t\t// 2) the user stops the fling scroll with another tap\n\t\t\t\t// then the event.target of the last 'touchend' event will be the element that was under the user's finger\n\t\t\t\t// when the fling scroll was started, causing FastClick to send a click event to that layer - unless a check\n\t\t\t\t// is made to ensure that a parent layer was not scrolled before sending a synthetic click (issue #42).\n\t\t\t\tthis.updateScrollParent(targetElement);\n\t\t\t}\n\t\t}\n\n\t\tthis.trackingClick = true;\n\t\tthis.trackingClickStart = event.timeStamp;\n\t\tthis.targetElement = targetElement;\n\n\t\tthis.touchStartX = touch.pageX;\n\t\tthis.touchStartY = touch.pageY;\n\n\t\t// Prevent phantom clicks on fast double-tap (issue #36)\n\t\tif ((event.timeStamp - this.lastClickTime) < this.tapDelay) {\n\t\t\tevent.preventDefault();\n\t\t}\n\n\t\treturn true;\n\t};\n\n\n\t/**\n\t * Based on a touchmove event object, check whether the touch has moved past a boundary since it started.\n\t *\n\t * @param {Event} event\n\t * @returns {boolean}\n\t */\n\tFastClick.prototype.touchHasMoved = function(event) {\n\t\tvar touch = event.changedTouches[0], boundary = this.touchBoundary;\n\n\t\tif (Math.abs(touch.pageX - this.touchStartX) > boundary || Math.abs(touch.pageY - this.touchStartY) > boundary) {\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t};\n\n\n\t/**\n\t * Update the last position.\n\t *\n\t * @param {Event} event\n\t * @returns {boolean}\n\t */\n\tFastClick.prototype.onTouchMove = function(event) {\n\t\tif (!this.trackingClick) {\n\t\t\treturn true;\n\t\t}\n\n\t\t// If the touch has moved, cancel the click tracking\n\t\tif (this.targetElement !== this.getTargetElementFromEventTarget(event.target) || this.touchHasMoved(event)) {\n\t\t\tthis.trackingClick = false;\n\t\t\tthis.targetElement = null;\n\t\t}\n\n\t\treturn true;\n\t};\n\n\n\t/**\n\t * Attempt to find the labelled control for the given label element.\n\t *\n\t * @param {EventTarget|HTMLLabelElement} labelElement\n\t * @returns {Element|null}\n\t */\n\tFastClick.prototype.findControl = function(labelElement) {\n\n\t\t// Fast path for newer browsers supporting the HTML5 control attribute\n\t\tif (labelElement.control !== undefined) {\n\t\t\treturn labelElement.control;\n\t\t}\n\n\t\t// All browsers under test that support touch events also support the HTML5 htmlFor attribute\n\t\tif (labelElement.htmlFor) {\n\t\t\treturn document.getElementById(labelElement.htmlFor);\n\t\t}\n\n\t\t// If no for attribute exists, attempt to retrieve the first labellable descendant element\n\t\t// the list of which is defined here: http://www.w3.org/TR/html5/forms.html#category-label\n\t\treturn labelElement.querySelector('button, input:not([type=hidden]), keygen, meter, output, progress, select, textarea');\n\t};\n\n\n\t/**\n\t * On touch end, determine whether to send a click event at once.\n\t *\n\t * @param {Event} event\n\t * @returns {boolean}\n\t */\n\tFastClick.prototype.onTouchEnd = function(event) {\n\t\tvar forElement, trackingClickStart, targetTagName, scrollParent, touch, targetElement = this.targetElement;\n\n\t\tif (!this.trackingClick) {\n\t\t\treturn true;\n\t\t}\n\n\t\t// Prevent phantom clicks on fast double-tap (issue #36)\n\t\tif ((event.timeStamp - this.lastClickTime) < this.tapDelay) {\n\t\t\tthis.cancelNextClick = true;\n\t\t\treturn true;\n\t\t}\n\n\t\tif ((event.timeStamp - this.trackingClickStart) > this.tapTimeout) {\n\t\t\treturn true;\n\t\t}\n\n\t\t// Reset to prevent wrong click cancel on input (issue #156).\n\t\tthis.cancelNextClick = false;\n\n\t\tthis.lastClickTime = event.timeStamp;\n\n\t\ttrackingClickStart = this.trackingClickStart;\n\t\tthis.trackingClick = false;\n\t\tthis.trackingClickStart = 0;\n\n\t\t// On some iOS devices, the targetElement supplied with the event is invalid if the layer\n\t\t// is performing a transition or scroll, and has to be re-detected manually. Note that\n\t\t// for this to function correctly, it must be called *after* the event target is checked!\n\t\t// See issue #57; also filed as rdar://13048589 .\n\t\tif (deviceIsIOSWithBadTarget) {\n\t\t\ttouch = event.changedTouches[0];\n\n\t\t\t// In certain cases arguments of elementFromPoint can be negative, so prevent setting targetElement to null\n\t\t\ttargetElement = document.elementFromPoint(touch.pageX - window.pageXOffset, touch.pageY - window.pageYOffset) || targetElement;\n\t\t\ttargetElement.fastClickScrollParent = this.targetElement.fastClickScrollParent;\n\t\t}\n\n\t\ttargetTagName = targetElement.tagName.toLowerCase();\n\t\tif (targetTagName === 'label') {\n\t\t\tforElement = this.findControl(targetElement);\n\t\t\tif (forElement) {\n\t\t\t\tthis.focus(targetElement);\n\t\t\t\tif (deviceIsAndroid) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\ttargetElement = forElement;\n\t\t\t}\n\t\t} else if (this.needsFocus(targetElement)) {\n\n\t\t\t// Case 1: If the touch started a while ago (best guess is 100ms based on tests for issue #36) then focus will be triggered anyway. Return early and unset the target element reference so that the subsequent click will be allowed through.\n\t\t\t// Case 2: Without this exception for input elements tapped when the document is contained in an iframe, then any inputted text won't be visible even though the value attribute is updated as the user types (issue #37).\n\t\t\tif ((event.timeStamp - trackingClickStart) > 100 || (deviceIsIOS && window.top !== window && targetTagName === 'input')) {\n\t\t\t\tthis.targetElement = null;\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tthis.focus(targetElement);\n\t\t\tthis.sendClick(targetElement, event);\n\n\t\t\t// Select elements need the event to go through on iOS 4, otherwise the selector menu won't open.\n\t\t\t// Also this breaks opening selects when VoiceOver is active on iOS6, iOS7 (and possibly others)\n\t\t\tif (!deviceIsIOS || targetTagName !== 'select') {\n\t\t\t\tthis.targetElement = null;\n\t\t\t\tevent.preventDefault();\n\t\t\t}\n\n\t\t\treturn false;\n\t\t}\n\n\t\tif (deviceIsIOS && !deviceIsIOS4) {\n\n\t\t\t// Don't send a synthetic click event if the target element is contained within a parent layer that was scrolled\n\t\t\t// and this tap is being used to stop the scrolling (usually initiated by a fling - issue #42).\n\t\t\tscrollParent = targetElement.fastClickScrollParent;\n\t\t\tif (scrollParent && scrollParent.fastClickLastScrollTop !== scrollParent.scrollTop) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\t// Prevent the actual click from going though - unless the target node is marked as requiring\n\t\t// real clicks or if it is in the whitelist in which case only non-programmatic clicks are permitted.\n\t\tif (!this.needsClick(targetElement)) {\n\t\t\tevent.preventDefault();\n\t\t\tthis.sendClick(targetElement, event);\n\t\t}\n\n\t\treturn false;\n\t};\n\n\n\t/**\n\t * On touch cancel, stop tracking the click.\n\t *\n\t * @returns {void}\n\t */\n\tFastClick.prototype.onTouchCancel = function() {\n\t\tthis.trackingClick = false;\n\t\tthis.targetElement = null;\n\t};\n\n\n\t/**\n\t * Determine mouse events which should be permitted.\n\t *\n\t * @param {Event} event\n\t * @returns {boolean}\n\t */\n\tFastClick.prototype.onMouse = function(event) {\n\n\t\t// If a target element was never set (because a touch event was never fired) allow the event\n\t\tif (!this.targetElement) {\n\t\t\treturn true;\n\t\t}\n\n\t\tif (event.forwardedTouchEvent) {\n\t\t\treturn true;\n\t\t}\n\n\t\t// Programmatically generated events targeting a specific element should be permitted\n\t\tif (!event.cancelable) {\n\t\t\treturn true;\n\t\t}\n\n\t\t// Derive and check the target element to see whether the mouse event needs to be permitted;\n\t\t// unless explicitly enabled, prevent non-touch click events from triggering actions,\n\t\t// to prevent ghost/doubleclicks.\n\t\tif (!this.needsClick(this.targetElement) || this.cancelNextClick) {\n\n\t\t\t// Prevent any user-added listeners declared on FastClick element from being fired.\n\t\t\tif (event.stopImmediatePropagation) {\n\t\t\t\tevent.stopImmediatePropagation();\n\t\t\t} else {\n\n\t\t\t\t// Part of the hack for browsers that don't support Event#stopImmediatePropagation (e.g. Android 2)\n\t\t\t\tevent.propagationStopped = true;\n\t\t\t}\n\n\t\t\t// Cancel the event\n\t\t\tevent.stopPropagation();\n\t\t\tevent.preventDefault();\n\n\t\t\treturn false;\n\t\t}\n\n\t\t// If the mouse event is permitted, return true for the action to go through.\n\t\treturn true;\n\t};\n\n\n\t/**\n\t * On actual clicks, determine whether this is a touch-generated click, a click action occurring\n\t * naturally after a delay after a touch (which needs to be cancelled to avoid duplication), or\n\t * an actual click which should be permitted.\n\t *\n\t * @param {Event} event\n\t * @returns {boolean}\n\t */\n\tFastClick.prototype.onClick = function(event) {\n\t\tvar permitted;\n\n\t\t// It's possible for another FastClick-like library delivered with third-party code to fire a click event before FastClick does (issue #44). In that case, set the click-tracking flag back to false and return early. This will cause onTouchEnd to return early.\n\t\tif (this.trackingClick) {\n\t\t\tthis.targetElement = null;\n\t\t\tthis.trackingClick = false;\n\t\t\treturn true;\n\t\t}\n\n\t\t// Very odd behaviour on iOS (issue #18): if a submit element is present inside a form and the user hits enter in the iOS simulator or clicks the Go button on the pop-up OS keyboard the a kind of 'fake' click event will be triggered with the submit-type input element as the target.\n\t\tif (event.target.type === 'submit' && event.detail === 0) {\n\t\t\treturn true;\n\t\t}\n\n\t\tpermitted = this.onMouse(event);\n\n\t\t// Only unset targetElement if the click is not permitted. This will ensure that the check for !targetElement in onMouse fails and the browser's click doesn't go through.\n\t\tif (!permitted) {\n\t\t\tthis.targetElement = null;\n\t\t}\n\n\t\t// If clicks are permitted, return true for the action to go through.\n\t\treturn permitted;\n\t};\n\n\n\t/**\n\t * Remove all FastClick's event listeners.\n\t *\n\t * @returns {void}\n\t */\n\tFastClick.prototype.destroy = function() {\n\t\tvar layer = this.layer;\n\n\t\tif (deviceIsAndroid) {\n\t\t\tlayer.removeEventListener('mouseover', this.onMouse, true);\n\t\t\tlayer.removeEventListener('mousedown', this.onMouse, true);\n\t\t\tlayer.removeEventListener('mouseup', this.onMouse, true);\n\t\t}\n\n\t\tlayer.removeEventListener('click', this.onClick, true);\n\t\tlayer.removeEventListener('touchstart', this.onTouchStart, false);\n\t\tlayer.removeEventListener('touchmove', this.onTouchMove, false);\n\t\tlayer.removeEventListener('touchend', this.onTouchEnd, false);\n\t\tlayer.removeEventListener('touchcancel', this.onTouchCancel, false);\n\t};\n\n\n\t/**\n\t * Check whether FastClick is needed.\n\t *\n\t * @param {Element} layer The layer to listen on\n\t */\n\tFastClick.notNeeded = function(layer) {\n\t\tvar metaViewport;\n\t\tvar chromeVersion;\n\t\tvar blackberryVersion;\n\t\tvar firefoxVersion;\n\n\t\t// Devices that don't support touch don't need FastClick\n\t\tif (typeof window.ontouchstart === 'undefined') {\n\t\t\treturn true;\n\t\t}\n\n\t\t// Chrome version - zero for other browsers\n\t\tchromeVersion = +(/Chrome\\/([0-9]+)/.exec(navigator.userAgent) || [,0])[1];\n\n\t\tif (chromeVersion) {\n\n\t\t\tif (deviceIsAndroid) {\n\t\t\t\tmetaViewport = document.querySelector('meta[name=viewport]');\n\n\t\t\t\tif (metaViewport) {\n\t\t\t\t\t// Chrome on Android with user-scalable=\"no\" doesn't need FastClick (issue #89)\n\t\t\t\t\tif (metaViewport.content.indexOf('user-scalable=no') !== -1) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t\t// Chrome 32 and above with width=device-width or less don't need FastClick\n\t\t\t\t\tif (chromeVersion > 31 && document.documentElement.scrollWidth <= window.outerWidth) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t// Chrome desktop doesn't need FastClick (issue #15)\n\t\t\t} else {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\tif (deviceIsBlackBerry10) {\n\t\t\tblackberryVersion = navigator.userAgent.match(/Version\\/([0-9]*)\\.([0-9]*)/);\n\n\t\t\t// BlackBerry 10.3+ does not require Fastclick library.\n\t\t\t// https://github.com/ftlabs/fastclick/issues/251\n\t\t\tif (blackberryVersion[1] >= 10 && blackberryVersion[2] >= 3) {\n\t\t\t\tmetaViewport = document.querySelector('meta[name=viewport]');\n\n\t\t\t\tif (metaViewport) {\n\t\t\t\t\t// user-scalable=no eliminates click delay.\n\t\t\t\t\tif (metaViewport.content.indexOf('user-scalable=no') !== -1) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t\t// width=device-width (or less than device-width) eliminates click delay.\n\t\t\t\t\tif (document.documentElement.scrollWidth <= window.outerWidth) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// IE10 with -ms-touch-action: none or manipulation, which disables double-tap-to-zoom (issue #97)\n\t\tif (layer.style.msTouchAction === 'none' || layer.style.touchAction === 'manipulation') {\n\t\t\treturn true;\n\t\t}\n\n\t\t// Firefox version - zero for other browsers\n\t\tfirefoxVersion = +(/Firefox\\/([0-9]+)/.exec(navigator.userAgent) || [,0])[1];\n\n\t\tif (firefoxVersion >= 27) {\n\t\t\t// Firefox 27+ does not have tap delay if the content is not zoomable - https://bugzilla.mozilla.org/show_bug.cgi?id=922896\n\n\t\t\tmetaViewport = document.querySelector('meta[name=viewport]');\n\t\t\tif (metaViewport && (metaViewport.content.indexOf('user-scalable=no') !== -1 || document.documentElement.scrollWidth <= window.outerWidth)) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\t// IE11: prefixed -ms-touch-action is no longer supported and it's recomended to use non-prefixed version\n\t\t// http://msdn.microsoft.com/en-us/library/windows/apps/Hh767313.aspx\n\t\tif (layer.style.touchAction === 'none' || layer.style.touchAction === 'manipulation') {\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t};\n\n\n\t/**\n\t * Factory method for creating a FastClick object\n\t *\n\t * @param {Element} layer The layer to listen on\n\t * @param {Object} [options={}] The options to override the defaults\n\t */\n\tFastClick.attach = function(layer, options) {\n\t\treturn new FastClick(layer, options);\n\t};\n\n\n\tif (true) {\n\n\t\t// AMD. Register as an anonymous module.\n\t\t!(__WEBPACK_AMD_DEFINE_RESULT__ = function() {\n\t\t\treturn FastClick;\n\t\t}.call(exports, __webpack_require__, exports, module),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n\t} else if (typeof module !== 'undefined' && module.exports) {\n\t\tmodule.exports = FastClick.attach;\n\t\tmodule.exports.FastClick = FastClick;\n\t} else {\n\t\twindow.FastClick = FastClick;\n\t}\n}());\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL34vZmFzdGNsaWNrL2xpYi9mYXN0Y2xpY2suanM/ZjFkOSJdLCJzb3VyY2VzQ29udGVudCI6WyI7KGZ1bmN0aW9uICgpIHtcblx0J3VzZSBzdHJpY3QnO1xuXG5cdC8qKlxuXHQgKiBAcHJlc2VydmUgRmFzdENsaWNrOiBwb2x5ZmlsbCB0byByZW1vdmUgY2xpY2sgZGVsYXlzIG9uIGJyb3dzZXJzIHdpdGggdG91Y2ggVUlzLlxuXHQgKlxuXHQgKiBAY29kaW5nc3RhbmRhcmQgZnRsYWJzLWpzdjJcblx0ICogQGNvcHlyaWdodCBUaGUgRmluYW5jaWFsIFRpbWVzIExpbWl0ZWQgW0FsbCBSaWdodHMgUmVzZXJ2ZWRdXG5cdCAqIEBsaWNlbnNlIE1JVCBMaWNlbnNlIChzZWUgTElDRU5TRS50eHQpXG5cdCAqL1xuXG5cdC8qanNsaW50IGJyb3dzZXI6dHJ1ZSwgbm9kZTp0cnVlKi9cblx0LypnbG9iYWwgZGVmaW5lLCBFdmVudCwgTm9kZSovXG5cblxuXHQvKipcblx0ICogSW5zdGFudGlhdGUgZmFzdC1jbGlja2luZyBsaXN0ZW5lcnMgb24gdGhlIHNwZWNpZmllZCBsYXllci5cblx0ICpcblx0ICogQGNvbnN0cnVjdG9yXG5cdCAqIEBwYXJhbSB7RWxlbWVudH0gbGF5ZXIgVGhlIGxheWVyIHRvIGxpc3RlbiBvblxuXHQgKiBAcGFyYW0ge09iamVjdH0gW29wdGlvbnM9e31dIFRoZSBvcHRpb25zIHRvIG92ZXJyaWRlIHRoZSBkZWZhdWx0c1xuXHQgKi9cblx0ZnVuY3Rpb24gRmFzdENsaWNrKGxheWVyLCBvcHRpb25zKSB7XG5cdFx0dmFyIG9sZE9uQ2xpY2s7XG5cblx0XHRvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcblxuXHRcdC8qKlxuXHRcdCAqIFdoZXRoZXIgYSBjbGljayBpcyBjdXJyZW50bHkgYmVpbmcgdHJhY2tlZC5cblx0XHQgKlxuXHRcdCAqIEB0eXBlIGJvb2xlYW5cblx0XHQgKi9cblx0XHR0aGlzLnRyYWNraW5nQ2xpY2sgPSBmYWxzZTtcblxuXG5cdFx0LyoqXG5cdFx0ICogVGltZXN0YW1wIGZvciB3aGVuIGNsaWNrIHRyYWNraW5nIHN0YXJ0ZWQuXG5cdFx0ICpcblx0XHQgKiBAdHlwZSBudW1iZXJcblx0XHQgKi9cblx0XHR0aGlzLnRyYWNraW5nQ2xpY2tTdGFydCA9IDA7XG5cblxuXHRcdC8qKlxuXHRcdCAqIFRoZSBlbGVtZW50IGJlaW5nIHRyYWNrZWQgZm9yIGEgY2xpY2suXG5cdFx0ICpcblx0XHQgKiBAdHlwZSBFdmVudFRhcmdldFxuXHRcdCAqL1xuXHRcdHRoaXMudGFyZ2V0RWxlbWVudCA9IG51bGw7XG5cblxuXHRcdC8qKlxuXHRcdCAqIFgtY29vcmRpbmF0ZSBvZiB0b3VjaCBzdGFydCBldmVudC5cblx0XHQgKlxuXHRcdCAqIEB0eXBlIG51bWJlclxuXHRcdCAqL1xuXHRcdHRoaXMudG91Y2hTdGFydFggPSAwO1xuXG5cblx0XHQvKipcblx0XHQgKiBZLWNvb3JkaW5hdGUgb2YgdG91Y2ggc3RhcnQgZXZlbnQuXG5cdFx0ICpcblx0XHQgKiBAdHlwZSBudW1iZXJcblx0XHQgKi9cblx0XHR0aGlzLnRvdWNoU3RhcnRZID0gMDtcblxuXG5cdFx0LyoqXG5cdFx0ICogSUQgb2YgdGhlIGxhc3QgdG91Y2gsIHJldHJpZXZlZCBmcm9tIFRvdWNoLmlkZW50aWZpZXIuXG5cdFx0ICpcblx0XHQgKiBAdHlwZSBudW1iZXJcblx0XHQgKi9cblx0XHR0aGlzLmxhc3RUb3VjaElkZW50aWZpZXIgPSAwO1xuXG5cblx0XHQvKipcblx0XHQgKiBUb3VjaG1vdmUgYm91bmRhcnksIGJleW9uZCB3aGljaCBhIGNsaWNrIHdpbGwgYmUgY2FuY2VsbGVkLlxuXHRcdCAqXG5cdFx0ICogQHR5cGUgbnVtYmVyXG5cdFx0ICovXG5cdFx0dGhpcy50b3VjaEJvdW5kYXJ5ID0gb3B0aW9ucy50b3VjaEJvdW5kYXJ5IHx8IDEwO1xuXG5cblx0XHQvKipcblx0XHQgKiBUaGUgRmFzdENsaWNrIGxheWVyLlxuXHRcdCAqXG5cdFx0ICogQHR5cGUgRWxlbWVudFxuXHRcdCAqL1xuXHRcdHRoaXMubGF5ZXIgPSBsYXllcjtcblxuXHRcdC8qKlxuXHRcdCAqIFRoZSBtaW5pbXVtIHRpbWUgYmV0d2VlbiB0YXAodG91Y2hzdGFydCBhbmQgdG91Y2hlbmQpIGV2ZW50c1xuXHRcdCAqXG5cdFx0ICogQHR5cGUgbnVtYmVyXG5cdFx0ICovXG5cdFx0dGhpcy50YXBEZWxheSA9IG9wdGlvbnMudGFwRGVsYXkgfHwgMjAwO1xuXG5cdFx0LyoqXG5cdFx0ICogVGhlIG1heGltdW0gdGltZSBmb3IgYSB0YXBcblx0XHQgKlxuXHRcdCAqIEB0eXBlIG51bWJlclxuXHRcdCAqL1xuXHRcdHRoaXMudGFwVGltZW91dCA9IG9wdGlvbnMudGFwVGltZW91dCB8fCA3MDA7XG5cblx0XHRpZiAoRmFzdENsaWNrLm5vdE5lZWRlZChsYXllcikpIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHQvLyBTb21lIG9sZCB2ZXJzaW9ucyBvZiBBbmRyb2lkIGRvbid0IGhhdmUgRnVuY3Rpb24ucHJvdG90eXBlLmJpbmRcblx0XHRmdW5jdGlvbiBiaW5kKG1ldGhvZCwgY29udGV4dCkge1xuXHRcdFx0cmV0dXJuIGZ1bmN0aW9uKCkgeyByZXR1cm4gbWV0aG9kLmFwcGx5KGNvbnRleHQsIGFyZ3VtZW50cyk7IH07XG5cdFx0fVxuXG5cblx0XHR2YXIgbWV0aG9kcyA9IFsnb25Nb3VzZScsICdvbkNsaWNrJywgJ29uVG91Y2hTdGFydCcsICdvblRvdWNoTW92ZScsICdvblRvdWNoRW5kJywgJ29uVG91Y2hDYW5jZWwnXTtcblx0XHR2YXIgY29udGV4dCA9IHRoaXM7XG5cdFx0Zm9yICh2YXIgaSA9IDAsIGwgPSBtZXRob2RzLmxlbmd0aDsgaSA8IGw7IGkrKykge1xuXHRcdFx0Y29udGV4dFttZXRob2RzW2ldXSA9IGJpbmQoY29udGV4dFttZXRob2RzW2ldXSwgY29udGV4dCk7XG5cdFx0fVxuXG5cdFx0Ly8gU2V0IHVwIGV2ZW50IGhhbmRsZXJzIGFzIHJlcXVpcmVkXG5cdFx0aWYgKGRldmljZUlzQW5kcm9pZCkge1xuXHRcdFx0bGF5ZXIuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VvdmVyJywgdGhpcy5vbk1vdXNlLCB0cnVlKTtcblx0XHRcdGxheWVyLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIHRoaXMub25Nb3VzZSwgdHJ1ZSk7XG5cdFx0XHRsYXllci5hZGRFdmVudExpc3RlbmVyKCdtb3VzZXVwJywgdGhpcy5vbk1vdXNlLCB0cnVlKTtcblx0XHR9XG5cblx0XHRsYXllci5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMub25DbGljaywgdHJ1ZSk7XG5cdFx0bGF5ZXIuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hzdGFydCcsIHRoaXMub25Ub3VjaFN0YXJ0LCBmYWxzZSk7XG5cdFx0bGF5ZXIuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2htb3ZlJywgdGhpcy5vblRvdWNoTW92ZSwgZmFsc2UpO1xuXHRcdGxheWVyLmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoZW5kJywgdGhpcy5vblRvdWNoRW5kLCBmYWxzZSk7XG5cdFx0bGF5ZXIuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hjYW5jZWwnLCB0aGlzLm9uVG91Y2hDYW5jZWwsIGZhbHNlKTtcblxuXHRcdC8vIEhhY2sgaXMgcmVxdWlyZWQgZm9yIGJyb3dzZXJzIHRoYXQgZG9uJ3Qgc3VwcG9ydCBFdmVudCNzdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24gKGUuZy4gQW5kcm9pZCAyKVxuXHRcdC8vIHdoaWNoIGlzIGhvdyBGYXN0Q2xpY2sgbm9ybWFsbHkgc3RvcHMgY2xpY2sgZXZlbnRzIGJ1YmJsaW5nIHRvIGNhbGxiYWNrcyByZWdpc3RlcmVkIG9uIHRoZSBGYXN0Q2xpY2tcblx0XHQvLyBsYXllciB3aGVuIHRoZXkgYXJlIGNhbmNlbGxlZC5cblx0XHRpZiAoIUV2ZW50LnByb3RvdHlwZS5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24pIHtcblx0XHRcdGxheWVyLnJlbW92ZUV2ZW50TGlzdGVuZXIgPSBmdW5jdGlvbih0eXBlLCBjYWxsYmFjaywgY2FwdHVyZSkge1xuXHRcdFx0XHR2YXIgcm12ID0gTm9kZS5wcm90b3R5cGUucmVtb3ZlRXZlbnRMaXN0ZW5lcjtcblx0XHRcdFx0aWYgKHR5cGUgPT09ICdjbGljaycpIHtcblx0XHRcdFx0XHRybXYuY2FsbChsYXllciwgdHlwZSwgY2FsbGJhY2suaGlqYWNrZWQgfHwgY2FsbGJhY2ssIGNhcHR1cmUpO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHJtdi5jYWxsKGxheWVyLCB0eXBlLCBjYWxsYmFjaywgY2FwdHVyZSk7XG5cdFx0XHRcdH1cblx0XHRcdH07XG5cblx0XHRcdGxheWVyLmFkZEV2ZW50TGlzdGVuZXIgPSBmdW5jdGlvbih0eXBlLCBjYWxsYmFjaywgY2FwdHVyZSkge1xuXHRcdFx0XHR2YXIgYWR2ID0gTm9kZS5wcm90b3R5cGUuYWRkRXZlbnRMaXN0ZW5lcjtcblx0XHRcdFx0aWYgKHR5cGUgPT09ICdjbGljaycpIHtcblx0XHRcdFx0XHRhZHYuY2FsbChsYXllciwgdHlwZSwgY2FsbGJhY2suaGlqYWNrZWQgfHwgKGNhbGxiYWNrLmhpamFja2VkID0gZnVuY3Rpb24oZXZlbnQpIHtcblx0XHRcdFx0XHRcdGlmICghZXZlbnQucHJvcGFnYXRpb25TdG9wcGVkKSB7XG5cdFx0XHRcdFx0XHRcdGNhbGxiYWNrKGV2ZW50KTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9KSwgY2FwdHVyZSk7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0YWR2LmNhbGwobGF5ZXIsIHR5cGUsIGNhbGxiYWNrLCBjYXB0dXJlKTtcblx0XHRcdFx0fVxuXHRcdFx0fTtcblx0XHR9XG5cblx0XHQvLyBJZiBhIGhhbmRsZXIgaXMgYWxyZWFkeSBkZWNsYXJlZCBpbiB0aGUgZWxlbWVudCdzIG9uY2xpY2sgYXR0cmlidXRlLCBpdCB3aWxsIGJlIGZpcmVkIGJlZm9yZVxuXHRcdC8vIEZhc3RDbGljaydzIG9uQ2xpY2sgaGFuZGxlci4gRml4IHRoaXMgYnkgcHVsbGluZyBvdXQgdGhlIHVzZXItZGVmaW5lZCBoYW5kbGVyIGZ1bmN0aW9uIGFuZFxuXHRcdC8vIGFkZGluZyBpdCBhcyBsaXN0ZW5lci5cblx0XHRpZiAodHlwZW9mIGxheWVyLm9uY2xpY2sgPT09ICdmdW5jdGlvbicpIHtcblxuXHRcdFx0Ly8gQW5kcm9pZCBicm93c2VyIG9uIGF0IGxlYXN0IDMuMiByZXF1aXJlcyBhIG5ldyByZWZlcmVuY2UgdG8gdGhlIGZ1bmN0aW9uIGluIGxheWVyLm9uY2xpY2tcblx0XHRcdC8vIC0gdGhlIG9sZCBvbmUgd29uJ3Qgd29yayBpZiBwYXNzZWQgdG8gYWRkRXZlbnRMaXN0ZW5lciBkaXJlY3RseS5cblx0XHRcdG9sZE9uQ2xpY2sgPSBsYXllci5vbmNsaWNrO1xuXHRcdFx0bGF5ZXIuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbihldmVudCkge1xuXHRcdFx0XHRvbGRPbkNsaWNrKGV2ZW50KTtcblx0XHRcdH0sIGZhbHNlKTtcblx0XHRcdGxheWVyLm9uY2xpY2sgPSBudWxsO1xuXHRcdH1cblx0fVxuXG5cdC8qKlxuXHQqIFdpbmRvd3MgUGhvbmUgOC4xIGZha2VzIHVzZXIgYWdlbnQgc3RyaW5nIHRvIGxvb2sgbGlrZSBBbmRyb2lkIGFuZCBpUGhvbmUuXG5cdCpcblx0KiBAdHlwZSBib29sZWFuXG5cdCovXG5cdHZhciBkZXZpY2VJc1dpbmRvd3NQaG9uZSA9IG5hdmlnYXRvci51c2VyQWdlbnQuaW5kZXhPZihcIldpbmRvd3MgUGhvbmVcIikgPj0gMDtcblxuXHQvKipcblx0ICogQW5kcm9pZCByZXF1aXJlcyBleGNlcHRpb25zLlxuXHQgKlxuXHQgKiBAdHlwZSBib29sZWFuXG5cdCAqL1xuXHR2YXIgZGV2aWNlSXNBbmRyb2lkID0gbmF2aWdhdG9yLnVzZXJBZ2VudC5pbmRleE9mKCdBbmRyb2lkJykgPiAwICYmICFkZXZpY2VJc1dpbmRvd3NQaG9uZTtcblxuXG5cdC8qKlxuXHQgKiBpT1MgcmVxdWlyZXMgZXhjZXB0aW9ucy5cblx0ICpcblx0ICogQHR5cGUgYm9vbGVhblxuXHQgKi9cblx0dmFyIGRldmljZUlzSU9TID0gL2lQKGFkfGhvbmV8b2QpLy50ZXN0KG5hdmlnYXRvci51c2VyQWdlbnQpICYmICFkZXZpY2VJc1dpbmRvd3NQaG9uZTtcblxuXG5cdC8qKlxuXHQgKiBpT1MgNCByZXF1aXJlcyBhbiBleGNlcHRpb24gZm9yIHNlbGVjdCBlbGVtZW50cy5cblx0ICpcblx0ICogQHR5cGUgYm9vbGVhblxuXHQgKi9cblx0dmFyIGRldmljZUlzSU9TNCA9IGRldmljZUlzSU9TICYmICgvT1MgNF9cXGQoX1xcZCk/LykudGVzdChuYXZpZ2F0b3IudXNlckFnZW50KTtcblxuXG5cdC8qKlxuXHQgKiBpT1MgNi4wLTcuKiByZXF1aXJlcyB0aGUgdGFyZ2V0IGVsZW1lbnQgdG8gYmUgbWFudWFsbHkgZGVyaXZlZFxuXHQgKlxuXHQgKiBAdHlwZSBib29sZWFuXG5cdCAqL1xuXHR2YXIgZGV2aWNlSXNJT1NXaXRoQmFkVGFyZ2V0ID0gZGV2aWNlSXNJT1MgJiYgKC9PUyBbNi03XV9cXGQvKS50ZXN0KG5hdmlnYXRvci51c2VyQWdlbnQpO1xuXG5cdC8qKlxuXHQgKiBCbGFja0JlcnJ5IHJlcXVpcmVzIGV4Y2VwdGlvbnMuXG5cdCAqXG5cdCAqIEB0eXBlIGJvb2xlYW5cblx0ICovXG5cdHZhciBkZXZpY2VJc0JsYWNrQmVycnkxMCA9IG5hdmlnYXRvci51c2VyQWdlbnQuaW5kZXhPZignQkIxMCcpID4gMDtcblxuXHQvKipcblx0ICogRGV0ZXJtaW5lIHdoZXRoZXIgYSBnaXZlbiBlbGVtZW50IHJlcXVpcmVzIGEgbmF0aXZlIGNsaWNrLlxuXHQgKlxuXHQgKiBAcGFyYW0ge0V2ZW50VGFyZ2V0fEVsZW1lbnR9IHRhcmdldCBUYXJnZXQgRE9NIGVsZW1lbnRcblx0ICogQHJldHVybnMge2Jvb2xlYW59IFJldHVybnMgdHJ1ZSBpZiB0aGUgZWxlbWVudCBuZWVkcyBhIG5hdGl2ZSBjbGlja1xuXHQgKi9cblx0RmFzdENsaWNrLnByb3RvdHlwZS5uZWVkc0NsaWNrID0gZnVuY3Rpb24odGFyZ2V0KSB7XG5cdFx0c3dpdGNoICh0YXJnZXQubm9kZU5hbWUudG9Mb3dlckNhc2UoKSkge1xuXG5cdFx0Ly8gRG9uJ3Qgc2VuZCBhIHN5bnRoZXRpYyBjbGljayB0byBkaXNhYmxlZCBpbnB1dHMgKGlzc3VlICM2Milcblx0XHRjYXNlICdidXR0b24nOlxuXHRcdGNhc2UgJ3NlbGVjdCc6XG5cdFx0Y2FzZSAndGV4dGFyZWEnOlxuXHRcdFx0aWYgKHRhcmdldC5kaXNhYmxlZCkge1xuXHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRcdH1cblxuXHRcdFx0YnJlYWs7XG5cdFx0Y2FzZSAnaW5wdXQnOlxuXG5cdFx0XHQvLyBGaWxlIGlucHV0cyBuZWVkIHJlYWwgY2xpY2tzIG9uIGlPUyA2IGR1ZSB0byBhIGJyb3dzZXIgYnVnIChpc3N1ZSAjNjgpXG5cdFx0XHRpZiAoKGRldmljZUlzSU9TICYmIHRhcmdldC50eXBlID09PSAnZmlsZScpIHx8IHRhcmdldC5kaXNhYmxlZCkge1xuXHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRcdH1cblxuXHRcdFx0YnJlYWs7XG5cdFx0Y2FzZSAnbGFiZWwnOlxuXHRcdGNhc2UgJ2lmcmFtZSc6IC8vIGlPUzggaG9tZXNjcmVlbiBhcHBzIGNhbiBwcmV2ZW50IGV2ZW50cyBidWJibGluZyBpbnRvIGZyYW1lc1xuXHRcdGNhc2UgJ3ZpZGVvJzpcblx0XHRcdHJldHVybiB0cnVlO1xuXHRcdH1cblxuXHRcdHJldHVybiAoL1xcYm5lZWRzY2xpY2tcXGIvKS50ZXN0KHRhcmdldC5jbGFzc05hbWUpO1xuXHR9O1xuXG5cblx0LyoqXG5cdCAqIERldGVybWluZSB3aGV0aGVyIGEgZ2l2ZW4gZWxlbWVudCByZXF1aXJlcyBhIGNhbGwgdG8gZm9jdXMgdG8gc2ltdWxhdGUgY2xpY2sgaW50byBlbGVtZW50LlxuXHQgKlxuXHQgKiBAcGFyYW0ge0V2ZW50VGFyZ2V0fEVsZW1lbnR9IHRhcmdldCBUYXJnZXQgRE9NIGVsZW1lbnRcblx0ICogQHJldHVybnMge2Jvb2xlYW59IFJldHVybnMgdHJ1ZSBpZiB0aGUgZWxlbWVudCByZXF1aXJlcyBhIGNhbGwgdG8gZm9jdXMgdG8gc2ltdWxhdGUgbmF0aXZlIGNsaWNrLlxuXHQgKi9cblx0RmFzdENsaWNrLnByb3RvdHlwZS5uZWVkc0ZvY3VzID0gZnVuY3Rpb24odGFyZ2V0KSB7XG5cdFx0c3dpdGNoICh0YXJnZXQubm9kZU5hbWUudG9Mb3dlckNhc2UoKSkge1xuXHRcdGNhc2UgJ3RleHRhcmVhJzpcblx0XHRcdHJldHVybiB0cnVlO1xuXHRcdGNhc2UgJ3NlbGVjdCc6XG5cdFx0XHRyZXR1cm4gIWRldmljZUlzQW5kcm9pZDtcblx0XHRjYXNlICdpbnB1dCc6XG5cdFx0XHRzd2l0Y2ggKHRhcmdldC50eXBlKSB7XG5cdFx0XHRjYXNlICdidXR0b24nOlxuXHRcdFx0Y2FzZSAnY2hlY2tib3gnOlxuXHRcdFx0Y2FzZSAnZmlsZSc6XG5cdFx0XHRjYXNlICdpbWFnZSc6XG5cdFx0XHRjYXNlICdyYWRpbyc6XG5cdFx0XHRjYXNlICdzdWJtaXQnOlxuXHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHR9XG5cblx0XHRcdC8vIE5vIHBvaW50IGluIGF0dGVtcHRpbmcgdG8gZm9jdXMgZGlzYWJsZWQgaW5wdXRzXG5cdFx0XHRyZXR1cm4gIXRhcmdldC5kaXNhYmxlZCAmJiAhdGFyZ2V0LnJlYWRPbmx5O1xuXHRcdGRlZmF1bHQ6XG5cdFx0XHRyZXR1cm4gKC9cXGJuZWVkc2ZvY3VzXFxiLykudGVzdCh0YXJnZXQuY2xhc3NOYW1lKTtcblx0XHR9XG5cdH07XG5cblxuXHQvKipcblx0ICogU2VuZCBhIGNsaWNrIGV2ZW50IHRvIHRoZSBzcGVjaWZpZWQgZWxlbWVudC5cblx0ICpcblx0ICogQHBhcmFtIHtFdmVudFRhcmdldHxFbGVtZW50fSB0YXJnZXRFbGVtZW50XG5cdCAqIEBwYXJhbSB7RXZlbnR9IGV2ZW50XG5cdCAqL1xuXHRGYXN0Q2xpY2sucHJvdG90eXBlLnNlbmRDbGljayA9IGZ1bmN0aW9uKHRhcmdldEVsZW1lbnQsIGV2ZW50KSB7XG5cdFx0dmFyIGNsaWNrRXZlbnQsIHRvdWNoO1xuXG5cdFx0Ly8gT24gc29tZSBBbmRyb2lkIGRldmljZXMgYWN0aXZlRWxlbWVudCBuZWVkcyB0byBiZSBibHVycmVkIG90aGVyd2lzZSB0aGUgc3ludGhldGljIGNsaWNrIHdpbGwgaGF2ZSBubyBlZmZlY3QgKCMyNClcblx0XHRpZiAoZG9jdW1lbnQuYWN0aXZlRWxlbWVudCAmJiBkb2N1bWVudC5hY3RpdmVFbGVtZW50ICE9PSB0YXJnZXRFbGVtZW50KSB7XG5cdFx0XHRkb2N1bWVudC5hY3RpdmVFbGVtZW50LmJsdXIoKTtcblx0XHR9XG5cblx0XHR0b3VjaCA9IGV2ZW50LmNoYW5nZWRUb3VjaGVzWzBdO1xuXG5cdFx0Ly8gU3ludGhlc2lzZSBhIGNsaWNrIGV2ZW50LCB3aXRoIGFuIGV4dHJhIGF0dHJpYnV0ZSBzbyBpdCBjYW4gYmUgdHJhY2tlZFxuXHRcdGNsaWNrRXZlbnQgPSBkb2N1bWVudC5jcmVhdGVFdmVudCgnTW91c2VFdmVudHMnKTtcblx0XHRjbGlja0V2ZW50LmluaXRNb3VzZUV2ZW50KHRoaXMuZGV0ZXJtaW5lRXZlbnRUeXBlKHRhcmdldEVsZW1lbnQpLCB0cnVlLCB0cnVlLCB3aW5kb3csIDEsIHRvdWNoLnNjcmVlblgsIHRvdWNoLnNjcmVlblksIHRvdWNoLmNsaWVudFgsIHRvdWNoLmNsaWVudFksIGZhbHNlLCBmYWxzZSwgZmFsc2UsIGZhbHNlLCAwLCBudWxsKTtcblx0XHRjbGlja0V2ZW50LmZvcndhcmRlZFRvdWNoRXZlbnQgPSB0cnVlO1xuXHRcdHRhcmdldEVsZW1lbnQuZGlzcGF0Y2hFdmVudChjbGlja0V2ZW50KTtcblx0fTtcblxuXHRGYXN0Q2xpY2sucHJvdG90eXBlLmRldGVybWluZUV2ZW50VHlwZSA9IGZ1bmN0aW9uKHRhcmdldEVsZW1lbnQpIHtcblxuXHRcdC8vSXNzdWUgIzE1OTogQW5kcm9pZCBDaHJvbWUgU2VsZWN0IEJveCBkb2VzIG5vdCBvcGVuIHdpdGggYSBzeW50aGV0aWMgY2xpY2sgZXZlbnRcblx0XHRpZiAoZGV2aWNlSXNBbmRyb2lkICYmIHRhcmdldEVsZW1lbnQudGFnTmFtZS50b0xvd2VyQ2FzZSgpID09PSAnc2VsZWN0Jykge1xuXHRcdFx0cmV0dXJuICdtb3VzZWRvd24nO1xuXHRcdH1cblxuXHRcdHJldHVybiAnY2xpY2snO1xuXHR9O1xuXG5cblx0LyoqXG5cdCAqIEBwYXJhbSB7RXZlbnRUYXJnZXR8RWxlbWVudH0gdGFyZ2V0RWxlbWVudFxuXHQgKi9cblx0RmFzdENsaWNrLnByb3RvdHlwZS5mb2N1cyA9IGZ1bmN0aW9uKHRhcmdldEVsZW1lbnQpIHtcblx0XHR2YXIgbGVuZ3RoO1xuXG5cdFx0Ly8gSXNzdWUgIzE2MDogb24gaU9TIDcsIHNvbWUgaW5wdXQgZWxlbWVudHMgKGUuZy4gZGF0ZSBkYXRldGltZSBtb250aCkgdGhyb3cgYSB2YWd1ZSBUeXBlRXJyb3Igb24gc2V0U2VsZWN0aW9uUmFuZ2UuIFRoZXNlIGVsZW1lbnRzIGRvbid0IGhhdmUgYW4gaW50ZWdlciB2YWx1ZSBmb3IgdGhlIHNlbGVjdGlvblN0YXJ0IGFuZCBzZWxlY3Rpb25FbmQgcHJvcGVydGllcywgYnV0IHVuZm9ydHVuYXRlbHkgdGhhdCBjYW4ndCBiZSB1c2VkIGZvciBkZXRlY3Rpb24gYmVjYXVzZSBhY2Nlc3NpbmcgdGhlIHByb3BlcnRpZXMgYWxzbyB0aHJvd3MgYSBUeXBlRXJyb3IuIEp1c3QgY2hlY2sgdGhlIHR5cGUgaW5zdGVhZC4gRmlsZWQgYXMgQXBwbGUgYnVnICMxNTEyMjcyNC5cblx0XHRpZiAoZGV2aWNlSXNJT1MgJiYgdGFyZ2V0RWxlbWVudC5zZXRTZWxlY3Rpb25SYW5nZSAmJiB0YXJnZXRFbGVtZW50LnR5cGUuaW5kZXhPZignZGF0ZScpICE9PSAwICYmIHRhcmdldEVsZW1lbnQudHlwZSAhPT0gJ3RpbWUnICYmIHRhcmdldEVsZW1lbnQudHlwZSAhPT0gJ21vbnRoJykge1xuXHRcdFx0bGVuZ3RoID0gdGFyZ2V0RWxlbWVudC52YWx1ZS5sZW5ndGg7XG5cdFx0XHR0YXJnZXRFbGVtZW50LnNldFNlbGVjdGlvblJhbmdlKGxlbmd0aCwgbGVuZ3RoKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0dGFyZ2V0RWxlbWVudC5mb2N1cygpO1xuXHRcdH1cblx0fTtcblxuXG5cdC8qKlxuXHQgKiBDaGVjayB3aGV0aGVyIHRoZSBnaXZlbiB0YXJnZXQgZWxlbWVudCBpcyBhIGNoaWxkIG9mIGEgc2Nyb2xsYWJsZSBsYXllciBhbmQgaWYgc28sIHNldCBhIGZsYWcgb24gaXQuXG5cdCAqXG5cdCAqIEBwYXJhbSB7RXZlbnRUYXJnZXR8RWxlbWVudH0gdGFyZ2V0RWxlbWVudFxuXHQgKi9cblx0RmFzdENsaWNrLnByb3RvdHlwZS51cGRhdGVTY3JvbGxQYXJlbnQgPSBmdW5jdGlvbih0YXJnZXRFbGVtZW50KSB7XG5cdFx0dmFyIHNjcm9sbFBhcmVudCwgcGFyZW50RWxlbWVudDtcblxuXHRcdHNjcm9sbFBhcmVudCA9IHRhcmdldEVsZW1lbnQuZmFzdENsaWNrU2Nyb2xsUGFyZW50O1xuXG5cdFx0Ly8gQXR0ZW1wdCB0byBkaXNjb3ZlciB3aGV0aGVyIHRoZSB0YXJnZXQgZWxlbWVudCBpcyBjb250YWluZWQgd2l0aGluIGEgc2Nyb2xsYWJsZSBsYXllci4gUmUtY2hlY2sgaWYgdGhlXG5cdFx0Ly8gdGFyZ2V0IGVsZW1lbnQgd2FzIG1vdmVkIHRvIGFub3RoZXIgcGFyZW50LlxuXHRcdGlmICghc2Nyb2xsUGFyZW50IHx8ICFzY3JvbGxQYXJlbnQuY29udGFpbnModGFyZ2V0RWxlbWVudCkpIHtcblx0XHRcdHBhcmVudEVsZW1lbnQgPSB0YXJnZXRFbGVtZW50O1xuXHRcdFx0ZG8ge1xuXHRcdFx0XHRpZiAocGFyZW50RWxlbWVudC5zY3JvbGxIZWlnaHQgPiBwYXJlbnRFbGVtZW50Lm9mZnNldEhlaWdodCkge1xuXHRcdFx0XHRcdHNjcm9sbFBhcmVudCA9IHBhcmVudEVsZW1lbnQ7XG5cdFx0XHRcdFx0dGFyZ2V0RWxlbWVudC5mYXN0Q2xpY2tTY3JvbGxQYXJlbnQgPSBwYXJlbnRFbGVtZW50O1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0cGFyZW50RWxlbWVudCA9IHBhcmVudEVsZW1lbnQucGFyZW50RWxlbWVudDtcblx0XHRcdH0gd2hpbGUgKHBhcmVudEVsZW1lbnQpO1xuXHRcdH1cblxuXHRcdC8vIEFsd2F5cyB1cGRhdGUgdGhlIHNjcm9sbCB0b3AgdHJhY2tlciBpZiBwb3NzaWJsZS5cblx0XHRpZiAoc2Nyb2xsUGFyZW50KSB7XG5cdFx0XHRzY3JvbGxQYXJlbnQuZmFzdENsaWNrTGFzdFNjcm9sbFRvcCA9IHNjcm9sbFBhcmVudC5zY3JvbGxUb3A7XG5cdFx0fVxuXHR9O1xuXG5cblx0LyoqXG5cdCAqIEBwYXJhbSB7RXZlbnRUYXJnZXR9IHRhcmdldEVsZW1lbnRcblx0ICogQHJldHVybnMge0VsZW1lbnR8RXZlbnRUYXJnZXR9XG5cdCAqL1xuXHRGYXN0Q2xpY2sucHJvdG90eXBlLmdldFRhcmdldEVsZW1lbnRGcm9tRXZlbnRUYXJnZXQgPSBmdW5jdGlvbihldmVudFRhcmdldCkge1xuXG5cdFx0Ly8gT24gc29tZSBvbGRlciBicm93c2VycyAobm90YWJseSBTYWZhcmkgb24gaU9TIDQuMSAtIHNlZSBpc3N1ZSAjNTYpIHRoZSBldmVudCB0YXJnZXQgbWF5IGJlIGEgdGV4dCBub2RlLlxuXHRcdGlmIChldmVudFRhcmdldC5ub2RlVHlwZSA9PT0gTm9kZS5URVhUX05PREUpIHtcblx0XHRcdHJldHVybiBldmVudFRhcmdldC5wYXJlbnROb2RlO1xuXHRcdH1cblxuXHRcdHJldHVybiBldmVudFRhcmdldDtcblx0fTtcblxuXG5cdC8qKlxuXHQgKiBPbiB0b3VjaCBzdGFydCwgcmVjb3JkIHRoZSBwb3NpdGlvbiBhbmQgc2Nyb2xsIG9mZnNldC5cblx0ICpcblx0ICogQHBhcmFtIHtFdmVudH0gZXZlbnRcblx0ICogQHJldHVybnMge2Jvb2xlYW59XG5cdCAqL1xuXHRGYXN0Q2xpY2sucHJvdG90eXBlLm9uVG91Y2hTdGFydCA9IGZ1bmN0aW9uKGV2ZW50KSB7XG5cdFx0dmFyIHRhcmdldEVsZW1lbnQsIHRvdWNoLCBzZWxlY3Rpb247XG5cblx0XHQvLyBJZ25vcmUgbXVsdGlwbGUgdG91Y2hlcywgb3RoZXJ3aXNlIHBpbmNoLXRvLXpvb20gaXMgcHJldmVudGVkIGlmIGJvdGggZmluZ2VycyBhcmUgb24gdGhlIEZhc3RDbGljayBlbGVtZW50IChpc3N1ZSAjMTExKS5cblx0XHRpZiAoZXZlbnQudGFyZ2V0VG91Y2hlcy5sZW5ndGggPiAxKSB7XG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHR9XG5cblx0XHR0YXJnZXRFbGVtZW50ID0gdGhpcy5nZXRUYXJnZXRFbGVtZW50RnJvbUV2ZW50VGFyZ2V0KGV2ZW50LnRhcmdldCk7XG5cdFx0dG91Y2ggPSBldmVudC50YXJnZXRUb3VjaGVzWzBdO1xuXG5cdFx0aWYgKGRldmljZUlzSU9TKSB7XG5cblx0XHRcdC8vIE9ubHkgdHJ1c3RlZCBldmVudHMgd2lsbCBkZXNlbGVjdCB0ZXh0IG9uIGlPUyAoaXNzdWUgIzQ5KVxuXHRcdFx0c2VsZWN0aW9uID0gd2luZG93LmdldFNlbGVjdGlvbigpO1xuXHRcdFx0aWYgKHNlbGVjdGlvbi5yYW5nZUNvdW50ICYmICFzZWxlY3Rpb24uaXNDb2xsYXBzZWQpIHtcblx0XHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0XHR9XG5cblx0XHRcdGlmICghZGV2aWNlSXNJT1M0KSB7XG5cblx0XHRcdFx0Ly8gV2VpcmQgdGhpbmdzIGhhcHBlbiBvbiBpT1Mgd2hlbiBhbiBhbGVydCBvciBjb25maXJtIGRpYWxvZyBpcyBvcGVuZWQgZnJvbSBhIGNsaWNrIGV2ZW50IGNhbGxiYWNrIChpc3N1ZSAjMjMpOlxuXHRcdFx0XHQvLyB3aGVuIHRoZSB1c2VyIG5leHQgdGFwcyBhbnl3aGVyZSBlbHNlIG9uIHRoZSBwYWdlLCBuZXcgdG91Y2hzdGFydCBhbmQgdG91Y2hlbmQgZXZlbnRzIGFyZSBkaXNwYXRjaGVkXG5cdFx0XHRcdC8vIHdpdGggdGhlIHNhbWUgaWRlbnRpZmllciBhcyB0aGUgdG91Y2ggZXZlbnQgdGhhdCBwcmV2aW91c2x5IHRyaWdnZXJlZCB0aGUgY2xpY2sgdGhhdCB0cmlnZ2VyZWQgdGhlIGFsZXJ0LlxuXHRcdFx0XHQvLyBTYWRseSwgdGhlcmUgaXMgYW4gaXNzdWUgb24gaU9TIDQgdGhhdCBjYXVzZXMgc29tZSBub3JtYWwgdG91Y2ggZXZlbnRzIHRvIGhhdmUgdGhlIHNhbWUgaWRlbnRpZmllciBhcyBhblxuXHRcdFx0XHQvLyBpbW1lZGlhdGVseSBwcmVjZWVkaW5nIHRvdWNoIGV2ZW50IChpc3N1ZSAjNTIpLCBzbyB0aGlzIGZpeCBpcyB1bmF2YWlsYWJsZSBvbiB0aGF0IHBsYXRmb3JtLlxuXHRcdFx0XHQvLyBJc3N1ZSAxMjA6IHRvdWNoLmlkZW50aWZpZXIgaXMgMCB3aGVuIENocm9tZSBkZXYgdG9vbHMgJ0VtdWxhdGUgdG91Y2ggZXZlbnRzJyBpcyBzZXQgd2l0aCBhbiBpT1MgZGV2aWNlIFVBIHN0cmluZyxcblx0XHRcdFx0Ly8gd2hpY2ggY2F1c2VzIGFsbCB0b3VjaCBldmVudHMgdG8gYmUgaWdub3JlZC4gQXMgdGhpcyBibG9jayBvbmx5IGFwcGxpZXMgdG8gaU9TLCBhbmQgaU9TIGlkZW50aWZpZXJzIGFyZSBhbHdheXMgbG9uZyxcblx0XHRcdFx0Ly8gcmFuZG9tIGludGVnZXJzLCBpdCdzIHNhZmUgdG8gdG8gY29udGludWUgaWYgdGhlIGlkZW50aWZpZXIgaXMgMCBoZXJlLlxuXHRcdFx0XHRpZiAodG91Y2guaWRlbnRpZmllciAmJiB0b3VjaC5pZGVudGlmaWVyID09PSB0aGlzLmxhc3RUb3VjaElkZW50aWZpZXIpIHtcblx0XHRcdFx0XHRldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdHRoaXMubGFzdFRvdWNoSWRlbnRpZmllciA9IHRvdWNoLmlkZW50aWZpZXI7XG5cblx0XHRcdFx0Ly8gSWYgdGhlIHRhcmdldCBlbGVtZW50IGlzIGEgY2hpbGQgb2YgYSBzY3JvbGxhYmxlIGxheWVyICh1c2luZyAtd2Via2l0LW92ZXJmbG93LXNjcm9sbGluZzogdG91Y2gpIGFuZDpcblx0XHRcdFx0Ly8gMSkgdGhlIHVzZXIgZG9lcyBhIGZsaW5nIHNjcm9sbCBvbiB0aGUgc2Nyb2xsYWJsZSBsYXllclxuXHRcdFx0XHQvLyAyKSB0aGUgdXNlciBzdG9wcyB0aGUgZmxpbmcgc2Nyb2xsIHdpdGggYW5vdGhlciB0YXBcblx0XHRcdFx0Ly8gdGhlbiB0aGUgZXZlbnQudGFyZ2V0IG9mIHRoZSBsYXN0ICd0b3VjaGVuZCcgZXZlbnQgd2lsbCBiZSB0aGUgZWxlbWVudCB0aGF0IHdhcyB1bmRlciB0aGUgdXNlcidzIGZpbmdlclxuXHRcdFx0XHQvLyB3aGVuIHRoZSBmbGluZyBzY3JvbGwgd2FzIHN0YXJ0ZWQsIGNhdXNpbmcgRmFzdENsaWNrIHRvIHNlbmQgYSBjbGljayBldmVudCB0byB0aGF0IGxheWVyIC0gdW5sZXNzIGEgY2hlY2tcblx0XHRcdFx0Ly8gaXMgbWFkZSB0byBlbnN1cmUgdGhhdCBhIHBhcmVudCBsYXllciB3YXMgbm90IHNjcm9sbGVkIGJlZm9yZSBzZW5kaW5nIGEgc3ludGhldGljIGNsaWNrIChpc3N1ZSAjNDIpLlxuXHRcdFx0XHR0aGlzLnVwZGF0ZVNjcm9sbFBhcmVudCh0YXJnZXRFbGVtZW50KTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHR0aGlzLnRyYWNraW5nQ2xpY2sgPSB0cnVlO1xuXHRcdHRoaXMudHJhY2tpbmdDbGlja1N0YXJ0ID0gZXZlbnQudGltZVN0YW1wO1xuXHRcdHRoaXMudGFyZ2V0RWxlbWVudCA9IHRhcmdldEVsZW1lbnQ7XG5cblx0XHR0aGlzLnRvdWNoU3RhcnRYID0gdG91Y2gucGFnZVg7XG5cdFx0dGhpcy50b3VjaFN0YXJ0WSA9IHRvdWNoLnBhZ2VZO1xuXG5cdFx0Ly8gUHJldmVudCBwaGFudG9tIGNsaWNrcyBvbiBmYXN0IGRvdWJsZS10YXAgKGlzc3VlICMzNilcblx0XHRpZiAoKGV2ZW50LnRpbWVTdGFtcCAtIHRoaXMubGFzdENsaWNrVGltZSkgPCB0aGlzLnRhcERlbGF5KSB7XG5cdFx0XHRldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdH1cblxuXHRcdHJldHVybiB0cnVlO1xuXHR9O1xuXG5cblx0LyoqXG5cdCAqIEJhc2VkIG9uIGEgdG91Y2htb3ZlIGV2ZW50IG9iamVjdCwgY2hlY2sgd2hldGhlciB0aGUgdG91Y2ggaGFzIG1vdmVkIHBhc3QgYSBib3VuZGFyeSBzaW5jZSBpdCBzdGFydGVkLlxuXHQgKlxuXHQgKiBAcGFyYW0ge0V2ZW50fSBldmVudFxuXHQgKiBAcmV0dXJucyB7Ym9vbGVhbn1cblx0ICovXG5cdEZhc3RDbGljay5wcm90b3R5cGUudG91Y2hIYXNNb3ZlZCA9IGZ1bmN0aW9uKGV2ZW50KSB7XG5cdFx0dmFyIHRvdWNoID0gZXZlbnQuY2hhbmdlZFRvdWNoZXNbMF0sIGJvdW5kYXJ5ID0gdGhpcy50b3VjaEJvdW5kYXJ5O1xuXG5cdFx0aWYgKE1hdGguYWJzKHRvdWNoLnBhZ2VYIC0gdGhpcy50b3VjaFN0YXJ0WCkgPiBib3VuZGFyeSB8fCBNYXRoLmFicyh0b3VjaC5wYWdlWSAtIHRoaXMudG91Y2hTdGFydFkpID4gYm91bmRhcnkpIHtcblx0XHRcdHJldHVybiB0cnVlO1xuXHRcdH1cblxuXHRcdHJldHVybiBmYWxzZTtcblx0fTtcblxuXG5cdC8qKlxuXHQgKiBVcGRhdGUgdGhlIGxhc3QgcG9zaXRpb24uXG5cdCAqXG5cdCAqIEBwYXJhbSB7RXZlbnR9IGV2ZW50XG5cdCAqIEByZXR1cm5zIHtib29sZWFufVxuXHQgKi9cblx0RmFzdENsaWNrLnByb3RvdHlwZS5vblRvdWNoTW92ZSA9IGZ1bmN0aW9uKGV2ZW50KSB7XG5cdFx0aWYgKCF0aGlzLnRyYWNraW5nQ2xpY2spIHtcblx0XHRcdHJldHVybiB0cnVlO1xuXHRcdH1cblxuXHRcdC8vIElmIHRoZSB0b3VjaCBoYXMgbW92ZWQsIGNhbmNlbCB0aGUgY2xpY2sgdHJhY2tpbmdcblx0XHRpZiAodGhpcy50YXJnZXRFbGVtZW50ICE9PSB0aGlzLmdldFRhcmdldEVsZW1lbnRGcm9tRXZlbnRUYXJnZXQoZXZlbnQudGFyZ2V0KSB8fCB0aGlzLnRvdWNoSGFzTW92ZWQoZXZlbnQpKSB7XG5cdFx0XHR0aGlzLnRyYWNraW5nQ2xpY2sgPSBmYWxzZTtcblx0XHRcdHRoaXMudGFyZ2V0RWxlbWVudCA9IG51bGw7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIHRydWU7XG5cdH07XG5cblxuXHQvKipcblx0ICogQXR0ZW1wdCB0byBmaW5kIHRoZSBsYWJlbGxlZCBjb250cm9sIGZvciB0aGUgZ2l2ZW4gbGFiZWwgZWxlbWVudC5cblx0ICpcblx0ICogQHBhcmFtIHtFdmVudFRhcmdldHxIVE1MTGFiZWxFbGVtZW50fSBsYWJlbEVsZW1lbnRcblx0ICogQHJldHVybnMge0VsZW1lbnR8bnVsbH1cblx0ICovXG5cdEZhc3RDbGljay5wcm90b3R5cGUuZmluZENvbnRyb2wgPSBmdW5jdGlvbihsYWJlbEVsZW1lbnQpIHtcblxuXHRcdC8vIEZhc3QgcGF0aCBmb3IgbmV3ZXIgYnJvd3NlcnMgc3VwcG9ydGluZyB0aGUgSFRNTDUgY29udHJvbCBhdHRyaWJ1dGVcblx0XHRpZiAobGFiZWxFbGVtZW50LmNvbnRyb2wgIT09IHVuZGVmaW5lZCkge1xuXHRcdFx0cmV0dXJuIGxhYmVsRWxlbWVudC5jb250cm9sO1xuXHRcdH1cblxuXHRcdC8vIEFsbCBicm93c2VycyB1bmRlciB0ZXN0IHRoYXQgc3VwcG9ydCB0b3VjaCBldmVudHMgYWxzbyBzdXBwb3J0IHRoZSBIVE1MNSBodG1sRm9yIGF0dHJpYnV0ZVxuXHRcdGlmIChsYWJlbEVsZW1lbnQuaHRtbEZvcikge1xuXHRcdFx0cmV0dXJuIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGxhYmVsRWxlbWVudC5odG1sRm9yKTtcblx0XHR9XG5cblx0XHQvLyBJZiBubyBmb3IgYXR0cmlidXRlIGV4aXN0cywgYXR0ZW1wdCB0byByZXRyaWV2ZSB0aGUgZmlyc3QgbGFiZWxsYWJsZSBkZXNjZW5kYW50IGVsZW1lbnRcblx0XHQvLyB0aGUgbGlzdCBvZiB3aGljaCBpcyBkZWZpbmVkIGhlcmU6IGh0dHA6Ly93d3cudzMub3JnL1RSL2h0bWw1L2Zvcm1zLmh0bWwjY2F0ZWdvcnktbGFiZWxcblx0XHRyZXR1cm4gbGFiZWxFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ2J1dHRvbiwgaW5wdXQ6bm90KFt0eXBlPWhpZGRlbl0pLCBrZXlnZW4sIG1ldGVyLCBvdXRwdXQsIHByb2dyZXNzLCBzZWxlY3QsIHRleHRhcmVhJyk7XG5cdH07XG5cblxuXHQvKipcblx0ICogT24gdG91Y2ggZW5kLCBkZXRlcm1pbmUgd2hldGhlciB0byBzZW5kIGEgY2xpY2sgZXZlbnQgYXQgb25jZS5cblx0ICpcblx0ICogQHBhcmFtIHtFdmVudH0gZXZlbnRcblx0ICogQHJldHVybnMge2Jvb2xlYW59XG5cdCAqL1xuXHRGYXN0Q2xpY2sucHJvdG90eXBlLm9uVG91Y2hFbmQgPSBmdW5jdGlvbihldmVudCkge1xuXHRcdHZhciBmb3JFbGVtZW50LCB0cmFja2luZ0NsaWNrU3RhcnQsIHRhcmdldFRhZ05hbWUsIHNjcm9sbFBhcmVudCwgdG91Y2gsIHRhcmdldEVsZW1lbnQgPSB0aGlzLnRhcmdldEVsZW1lbnQ7XG5cblx0XHRpZiAoIXRoaXMudHJhY2tpbmdDbGljaykge1xuXHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0fVxuXG5cdFx0Ly8gUHJldmVudCBwaGFudG9tIGNsaWNrcyBvbiBmYXN0IGRvdWJsZS10YXAgKGlzc3VlICMzNilcblx0XHRpZiAoKGV2ZW50LnRpbWVTdGFtcCAtIHRoaXMubGFzdENsaWNrVGltZSkgPCB0aGlzLnRhcERlbGF5KSB7XG5cdFx0XHR0aGlzLmNhbmNlbE5leHRDbGljayA9IHRydWU7XG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHR9XG5cblx0XHRpZiAoKGV2ZW50LnRpbWVTdGFtcCAtIHRoaXMudHJhY2tpbmdDbGlja1N0YXJ0KSA+IHRoaXMudGFwVGltZW91dCkge1xuXHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0fVxuXG5cdFx0Ly8gUmVzZXQgdG8gcHJldmVudCB3cm9uZyBjbGljayBjYW5jZWwgb24gaW5wdXQgKGlzc3VlICMxNTYpLlxuXHRcdHRoaXMuY2FuY2VsTmV4dENsaWNrID0gZmFsc2U7XG5cblx0XHR0aGlzLmxhc3RDbGlja1RpbWUgPSBldmVudC50aW1lU3RhbXA7XG5cblx0XHR0cmFja2luZ0NsaWNrU3RhcnQgPSB0aGlzLnRyYWNraW5nQ2xpY2tTdGFydDtcblx0XHR0aGlzLnRyYWNraW5nQ2xpY2sgPSBmYWxzZTtcblx0XHR0aGlzLnRyYWNraW5nQ2xpY2tTdGFydCA9IDA7XG5cblx0XHQvLyBPbiBzb21lIGlPUyBkZXZpY2VzLCB0aGUgdGFyZ2V0RWxlbWVudCBzdXBwbGllZCB3aXRoIHRoZSBldmVudCBpcyBpbnZhbGlkIGlmIHRoZSBsYXllclxuXHRcdC8vIGlzIHBlcmZvcm1pbmcgYSB0cmFuc2l0aW9uIG9yIHNjcm9sbCwgYW5kIGhhcyB0byBiZSByZS1kZXRlY3RlZCBtYW51YWxseS4gTm90ZSB0aGF0XG5cdFx0Ly8gZm9yIHRoaXMgdG8gZnVuY3Rpb24gY29ycmVjdGx5LCBpdCBtdXN0IGJlIGNhbGxlZCAqYWZ0ZXIqIHRoZSBldmVudCB0YXJnZXQgaXMgY2hlY2tlZCFcblx0XHQvLyBTZWUgaXNzdWUgIzU3OyBhbHNvIGZpbGVkIGFzIHJkYXI6Ly8xMzA0ODU4OSAuXG5cdFx0aWYgKGRldmljZUlzSU9TV2l0aEJhZFRhcmdldCkge1xuXHRcdFx0dG91Y2ggPSBldmVudC5jaGFuZ2VkVG91Y2hlc1swXTtcblxuXHRcdFx0Ly8gSW4gY2VydGFpbiBjYXNlcyBhcmd1bWVudHMgb2YgZWxlbWVudEZyb21Qb2ludCBjYW4gYmUgbmVnYXRpdmUsIHNvIHByZXZlbnQgc2V0dGluZyB0YXJnZXRFbGVtZW50IHRvIG51bGxcblx0XHRcdHRhcmdldEVsZW1lbnQgPSBkb2N1bWVudC5lbGVtZW50RnJvbVBvaW50KHRvdWNoLnBhZ2VYIC0gd2luZG93LnBhZ2VYT2Zmc2V0LCB0b3VjaC5wYWdlWSAtIHdpbmRvdy5wYWdlWU9mZnNldCkgfHwgdGFyZ2V0RWxlbWVudDtcblx0XHRcdHRhcmdldEVsZW1lbnQuZmFzdENsaWNrU2Nyb2xsUGFyZW50ID0gdGhpcy50YXJnZXRFbGVtZW50LmZhc3RDbGlja1Njcm9sbFBhcmVudDtcblx0XHR9XG5cblx0XHR0YXJnZXRUYWdOYW1lID0gdGFyZ2V0RWxlbWVudC50YWdOYW1lLnRvTG93ZXJDYXNlKCk7XG5cdFx0aWYgKHRhcmdldFRhZ05hbWUgPT09ICdsYWJlbCcpIHtcblx0XHRcdGZvckVsZW1lbnQgPSB0aGlzLmZpbmRDb250cm9sKHRhcmdldEVsZW1lbnQpO1xuXHRcdFx0aWYgKGZvckVsZW1lbnQpIHtcblx0XHRcdFx0dGhpcy5mb2N1cyh0YXJnZXRFbGVtZW50KTtcblx0XHRcdFx0aWYgKGRldmljZUlzQW5kcm9pZCkge1xuXHRcdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdHRhcmdldEVsZW1lbnQgPSBmb3JFbGVtZW50O1xuXHRcdFx0fVxuXHRcdH0gZWxzZSBpZiAodGhpcy5uZWVkc0ZvY3VzKHRhcmdldEVsZW1lbnQpKSB7XG5cblx0XHRcdC8vIENhc2UgMTogSWYgdGhlIHRvdWNoIHN0YXJ0ZWQgYSB3aGlsZSBhZ28gKGJlc3QgZ3Vlc3MgaXMgMTAwbXMgYmFzZWQgb24gdGVzdHMgZm9yIGlzc3VlICMzNikgdGhlbiBmb2N1cyB3aWxsIGJlIHRyaWdnZXJlZCBhbnl3YXkuIFJldHVybiBlYXJseSBhbmQgdW5zZXQgdGhlIHRhcmdldCBlbGVtZW50IHJlZmVyZW5jZSBzbyB0aGF0IHRoZSBzdWJzZXF1ZW50IGNsaWNrIHdpbGwgYmUgYWxsb3dlZCB0aHJvdWdoLlxuXHRcdFx0Ly8gQ2FzZSAyOiBXaXRob3V0IHRoaXMgZXhjZXB0aW9uIGZvciBpbnB1dCBlbGVtZW50cyB0YXBwZWQgd2hlbiB0aGUgZG9jdW1lbnQgaXMgY29udGFpbmVkIGluIGFuIGlmcmFtZSwgdGhlbiBhbnkgaW5wdXR0ZWQgdGV4dCB3b24ndCBiZSB2aXNpYmxlIGV2ZW4gdGhvdWdoIHRoZSB2YWx1ZSBhdHRyaWJ1dGUgaXMgdXBkYXRlZCBhcyB0aGUgdXNlciB0eXBlcyAoaXNzdWUgIzM3KS5cblx0XHRcdGlmICgoZXZlbnQudGltZVN0YW1wIC0gdHJhY2tpbmdDbGlja1N0YXJ0KSA+IDEwMCB8fCAoZGV2aWNlSXNJT1MgJiYgd2luZG93LnRvcCAhPT0gd2luZG93ICYmIHRhcmdldFRhZ05hbWUgPT09ICdpbnB1dCcpKSB7XG5cdFx0XHRcdHRoaXMudGFyZ2V0RWxlbWVudCA9IG51bGw7XG5cdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdH1cblxuXHRcdFx0dGhpcy5mb2N1cyh0YXJnZXRFbGVtZW50KTtcblx0XHRcdHRoaXMuc2VuZENsaWNrKHRhcmdldEVsZW1lbnQsIGV2ZW50KTtcblxuXHRcdFx0Ly8gU2VsZWN0IGVsZW1lbnRzIG5lZWQgdGhlIGV2ZW50IHRvIGdvIHRocm91Z2ggb24gaU9TIDQsIG90aGVyd2lzZSB0aGUgc2VsZWN0b3IgbWVudSB3b24ndCBvcGVuLlxuXHRcdFx0Ly8gQWxzbyB0aGlzIGJyZWFrcyBvcGVuaW5nIHNlbGVjdHMgd2hlbiBWb2ljZU92ZXIgaXMgYWN0aXZlIG9uIGlPUzYsIGlPUzcgKGFuZCBwb3NzaWJseSBvdGhlcnMpXG5cdFx0XHRpZiAoIWRldmljZUlzSU9TIHx8IHRhcmdldFRhZ05hbWUgIT09ICdzZWxlY3QnKSB7XG5cdFx0XHRcdHRoaXMudGFyZ2V0RWxlbWVudCA9IG51bGw7XG5cdFx0XHRcdGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHR9XG5cblx0XHRcdHJldHVybiBmYWxzZTtcblx0XHR9XG5cblx0XHRpZiAoZGV2aWNlSXNJT1MgJiYgIWRldmljZUlzSU9TNCkge1xuXG5cdFx0XHQvLyBEb24ndCBzZW5kIGEgc3ludGhldGljIGNsaWNrIGV2ZW50IGlmIHRoZSB0YXJnZXQgZWxlbWVudCBpcyBjb250YWluZWQgd2l0aGluIGEgcGFyZW50IGxheWVyIHRoYXQgd2FzIHNjcm9sbGVkXG5cdFx0XHQvLyBhbmQgdGhpcyB0YXAgaXMgYmVpbmcgdXNlZCB0byBzdG9wIHRoZSBzY3JvbGxpbmcgKHVzdWFsbHkgaW5pdGlhdGVkIGJ5IGEgZmxpbmcgLSBpc3N1ZSAjNDIpLlxuXHRcdFx0c2Nyb2xsUGFyZW50ID0gdGFyZ2V0RWxlbWVudC5mYXN0Q2xpY2tTY3JvbGxQYXJlbnQ7XG5cdFx0XHRpZiAoc2Nyb2xsUGFyZW50ICYmIHNjcm9sbFBhcmVudC5mYXN0Q2xpY2tMYXN0U2Nyb2xsVG9wICE9PSBzY3JvbGxQYXJlbnQuc2Nyb2xsVG9wKSB7XG5cdFx0XHRcdHJldHVybiB0cnVlO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdC8vIFByZXZlbnQgdGhlIGFjdHVhbCBjbGljayBmcm9tIGdvaW5nIHRob3VnaCAtIHVubGVzcyB0aGUgdGFyZ2V0IG5vZGUgaXMgbWFya2VkIGFzIHJlcXVpcmluZ1xuXHRcdC8vIHJlYWwgY2xpY2tzIG9yIGlmIGl0IGlzIGluIHRoZSB3aGl0ZWxpc3QgaW4gd2hpY2ggY2FzZSBvbmx5IG5vbi1wcm9ncmFtbWF0aWMgY2xpY2tzIGFyZSBwZXJtaXR0ZWQuXG5cdFx0aWYgKCF0aGlzLm5lZWRzQ2xpY2sodGFyZ2V0RWxlbWVudCkpIHtcblx0XHRcdGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHR0aGlzLnNlbmRDbGljayh0YXJnZXRFbGVtZW50LCBldmVudCk7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIGZhbHNlO1xuXHR9O1xuXG5cblx0LyoqXG5cdCAqIE9uIHRvdWNoIGNhbmNlbCwgc3RvcCB0cmFja2luZyB0aGUgY2xpY2suXG5cdCAqXG5cdCAqIEByZXR1cm5zIHt2b2lkfVxuXHQgKi9cblx0RmFzdENsaWNrLnByb3RvdHlwZS5vblRvdWNoQ2FuY2VsID0gZnVuY3Rpb24oKSB7XG5cdFx0dGhpcy50cmFja2luZ0NsaWNrID0gZmFsc2U7XG5cdFx0dGhpcy50YXJnZXRFbGVtZW50ID0gbnVsbDtcblx0fTtcblxuXG5cdC8qKlxuXHQgKiBEZXRlcm1pbmUgbW91c2UgZXZlbnRzIHdoaWNoIHNob3VsZCBiZSBwZXJtaXR0ZWQuXG5cdCAqXG5cdCAqIEBwYXJhbSB7RXZlbnR9IGV2ZW50XG5cdCAqIEByZXR1cm5zIHtib29sZWFufVxuXHQgKi9cblx0RmFzdENsaWNrLnByb3RvdHlwZS5vbk1vdXNlID0gZnVuY3Rpb24oZXZlbnQpIHtcblxuXHRcdC8vIElmIGEgdGFyZ2V0IGVsZW1lbnQgd2FzIG5ldmVyIHNldCAoYmVjYXVzZSBhIHRvdWNoIGV2ZW50IHdhcyBuZXZlciBmaXJlZCkgYWxsb3cgdGhlIGV2ZW50XG5cdFx0aWYgKCF0aGlzLnRhcmdldEVsZW1lbnQpIHtcblx0XHRcdHJldHVybiB0cnVlO1xuXHRcdH1cblxuXHRcdGlmIChldmVudC5mb3J3YXJkZWRUb3VjaEV2ZW50KSB7XG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHR9XG5cblx0XHQvLyBQcm9ncmFtbWF0aWNhbGx5IGdlbmVyYXRlZCBldmVudHMgdGFyZ2V0aW5nIGEgc3BlY2lmaWMgZWxlbWVudCBzaG91bGQgYmUgcGVybWl0dGVkXG5cdFx0aWYgKCFldmVudC5jYW5jZWxhYmxlKSB7XG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHR9XG5cblx0XHQvLyBEZXJpdmUgYW5kIGNoZWNrIHRoZSB0YXJnZXQgZWxlbWVudCB0byBzZWUgd2hldGhlciB0aGUgbW91c2UgZXZlbnQgbmVlZHMgdG8gYmUgcGVybWl0dGVkO1xuXHRcdC8vIHVubGVzcyBleHBsaWNpdGx5IGVuYWJsZWQsIHByZXZlbnQgbm9uLXRvdWNoIGNsaWNrIGV2ZW50cyBmcm9tIHRyaWdnZXJpbmcgYWN0aW9ucyxcblx0XHQvLyB0byBwcmV2ZW50IGdob3N0L2RvdWJsZWNsaWNrcy5cblx0XHRpZiAoIXRoaXMubmVlZHNDbGljayh0aGlzLnRhcmdldEVsZW1lbnQpIHx8IHRoaXMuY2FuY2VsTmV4dENsaWNrKSB7XG5cblx0XHRcdC8vIFByZXZlbnQgYW55IHVzZXItYWRkZWQgbGlzdGVuZXJzIGRlY2xhcmVkIG9uIEZhc3RDbGljayBlbGVtZW50IGZyb20gYmVpbmcgZmlyZWQuXG5cdFx0XHRpZiAoZXZlbnQuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKSB7XG5cdFx0XHRcdGV2ZW50LnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpO1xuXHRcdFx0fSBlbHNlIHtcblxuXHRcdFx0XHQvLyBQYXJ0IG9mIHRoZSBoYWNrIGZvciBicm93c2VycyB0aGF0IGRvbid0IHN1cHBvcnQgRXZlbnQjc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uIChlLmcuIEFuZHJvaWQgMilcblx0XHRcdFx0ZXZlbnQucHJvcGFnYXRpb25TdG9wcGVkID0gdHJ1ZTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gQ2FuY2VsIHRoZSBldmVudFxuXHRcdFx0ZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG5cdFx0XHRldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXG5cdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0fVxuXG5cdFx0Ly8gSWYgdGhlIG1vdXNlIGV2ZW50IGlzIHBlcm1pdHRlZCwgcmV0dXJuIHRydWUgZm9yIHRoZSBhY3Rpb24gdG8gZ28gdGhyb3VnaC5cblx0XHRyZXR1cm4gdHJ1ZTtcblx0fTtcblxuXG5cdC8qKlxuXHQgKiBPbiBhY3R1YWwgY2xpY2tzLCBkZXRlcm1pbmUgd2hldGhlciB0aGlzIGlzIGEgdG91Y2gtZ2VuZXJhdGVkIGNsaWNrLCBhIGNsaWNrIGFjdGlvbiBvY2N1cnJpbmdcblx0ICogbmF0dXJhbGx5IGFmdGVyIGEgZGVsYXkgYWZ0ZXIgYSB0b3VjaCAod2hpY2ggbmVlZHMgdG8gYmUgY2FuY2VsbGVkIHRvIGF2b2lkIGR1cGxpY2F0aW9uKSwgb3Jcblx0ICogYW4gYWN0dWFsIGNsaWNrIHdoaWNoIHNob3VsZCBiZSBwZXJtaXR0ZWQuXG5cdCAqXG5cdCAqIEBwYXJhbSB7RXZlbnR9IGV2ZW50XG5cdCAqIEByZXR1cm5zIHtib29sZWFufVxuXHQgKi9cblx0RmFzdENsaWNrLnByb3RvdHlwZS5vbkNsaWNrID0gZnVuY3Rpb24oZXZlbnQpIHtcblx0XHR2YXIgcGVybWl0dGVkO1xuXG5cdFx0Ly8gSXQncyBwb3NzaWJsZSBmb3IgYW5vdGhlciBGYXN0Q2xpY2stbGlrZSBsaWJyYXJ5IGRlbGl2ZXJlZCB3aXRoIHRoaXJkLXBhcnR5IGNvZGUgdG8gZmlyZSBhIGNsaWNrIGV2ZW50IGJlZm9yZSBGYXN0Q2xpY2sgZG9lcyAoaXNzdWUgIzQ0KS4gSW4gdGhhdCBjYXNlLCBzZXQgdGhlIGNsaWNrLXRyYWNraW5nIGZsYWcgYmFjayB0byBmYWxzZSBhbmQgcmV0dXJuIGVhcmx5LiBUaGlzIHdpbGwgY2F1c2Ugb25Ub3VjaEVuZCB0byByZXR1cm4gZWFybHkuXG5cdFx0aWYgKHRoaXMudHJhY2tpbmdDbGljaykge1xuXHRcdFx0dGhpcy50YXJnZXRFbGVtZW50ID0gbnVsbDtcblx0XHRcdHRoaXMudHJhY2tpbmdDbGljayA9IGZhbHNlO1xuXHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0fVxuXG5cdFx0Ly8gVmVyeSBvZGQgYmVoYXZpb3VyIG9uIGlPUyAoaXNzdWUgIzE4KTogaWYgYSBzdWJtaXQgZWxlbWVudCBpcyBwcmVzZW50IGluc2lkZSBhIGZvcm0gYW5kIHRoZSB1c2VyIGhpdHMgZW50ZXIgaW4gdGhlIGlPUyBzaW11bGF0b3Igb3IgY2xpY2tzIHRoZSBHbyBidXR0b24gb24gdGhlIHBvcC11cCBPUyBrZXlib2FyZCB0aGUgYSBraW5kIG9mICdmYWtlJyBjbGljayBldmVudCB3aWxsIGJlIHRyaWdnZXJlZCB3aXRoIHRoZSBzdWJtaXQtdHlwZSBpbnB1dCBlbGVtZW50IGFzIHRoZSB0YXJnZXQuXG5cdFx0aWYgKGV2ZW50LnRhcmdldC50eXBlID09PSAnc3VibWl0JyAmJiBldmVudC5kZXRhaWwgPT09IDApIHtcblx0XHRcdHJldHVybiB0cnVlO1xuXHRcdH1cblxuXHRcdHBlcm1pdHRlZCA9IHRoaXMub25Nb3VzZShldmVudCk7XG5cblx0XHQvLyBPbmx5IHVuc2V0IHRhcmdldEVsZW1lbnQgaWYgdGhlIGNsaWNrIGlzIG5vdCBwZXJtaXR0ZWQuIFRoaXMgd2lsbCBlbnN1cmUgdGhhdCB0aGUgY2hlY2sgZm9yICF0YXJnZXRFbGVtZW50IGluIG9uTW91c2UgZmFpbHMgYW5kIHRoZSBicm93c2VyJ3MgY2xpY2sgZG9lc24ndCBnbyB0aHJvdWdoLlxuXHRcdGlmICghcGVybWl0dGVkKSB7XG5cdFx0XHR0aGlzLnRhcmdldEVsZW1lbnQgPSBudWxsO1xuXHRcdH1cblxuXHRcdC8vIElmIGNsaWNrcyBhcmUgcGVybWl0dGVkLCByZXR1cm4gdHJ1ZSBmb3IgdGhlIGFjdGlvbiB0byBnbyB0aHJvdWdoLlxuXHRcdHJldHVybiBwZXJtaXR0ZWQ7XG5cdH07XG5cblxuXHQvKipcblx0ICogUmVtb3ZlIGFsbCBGYXN0Q2xpY2sncyBldmVudCBsaXN0ZW5lcnMuXG5cdCAqXG5cdCAqIEByZXR1cm5zIHt2b2lkfVxuXHQgKi9cblx0RmFzdENsaWNrLnByb3RvdHlwZS5kZXN0cm95ID0gZnVuY3Rpb24oKSB7XG5cdFx0dmFyIGxheWVyID0gdGhpcy5sYXllcjtcblxuXHRcdGlmIChkZXZpY2VJc0FuZHJvaWQpIHtcblx0XHRcdGxheWVyLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdXNlb3ZlcicsIHRoaXMub25Nb3VzZSwgdHJ1ZSk7XG5cdFx0XHRsYXllci5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCB0aGlzLm9uTW91c2UsIHRydWUpO1xuXHRcdFx0bGF5ZXIucmVtb3ZlRXZlbnRMaXN0ZW5lcignbW91c2V1cCcsIHRoaXMub25Nb3VzZSwgdHJ1ZSk7XG5cdFx0fVxuXG5cdFx0bGF5ZXIucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLm9uQ2xpY2ssIHRydWUpO1xuXHRcdGxheWVyLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3RvdWNoc3RhcnQnLCB0aGlzLm9uVG91Y2hTdGFydCwgZmFsc2UpO1xuXHRcdGxheWVyLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3RvdWNobW92ZScsIHRoaXMub25Ub3VjaE1vdmUsIGZhbHNlKTtcblx0XHRsYXllci5yZW1vdmVFdmVudExpc3RlbmVyKCd0b3VjaGVuZCcsIHRoaXMub25Ub3VjaEVuZCwgZmFsc2UpO1xuXHRcdGxheWVyLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3RvdWNoY2FuY2VsJywgdGhpcy5vblRvdWNoQ2FuY2VsLCBmYWxzZSk7XG5cdH07XG5cblxuXHQvKipcblx0ICogQ2hlY2sgd2hldGhlciBGYXN0Q2xpY2sgaXMgbmVlZGVkLlxuXHQgKlxuXHQgKiBAcGFyYW0ge0VsZW1lbnR9IGxheWVyIFRoZSBsYXllciB0byBsaXN0ZW4gb25cblx0ICovXG5cdEZhc3RDbGljay5ub3ROZWVkZWQgPSBmdW5jdGlvbihsYXllcikge1xuXHRcdHZhciBtZXRhVmlld3BvcnQ7XG5cdFx0dmFyIGNocm9tZVZlcnNpb247XG5cdFx0dmFyIGJsYWNrYmVycnlWZXJzaW9uO1xuXHRcdHZhciBmaXJlZm94VmVyc2lvbjtcblxuXHRcdC8vIERldmljZXMgdGhhdCBkb24ndCBzdXBwb3J0IHRvdWNoIGRvbid0IG5lZWQgRmFzdENsaWNrXG5cdFx0aWYgKHR5cGVvZiB3aW5kb3cub250b3VjaHN0YXJ0ID09PSAndW5kZWZpbmVkJykge1xuXHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0fVxuXG5cdFx0Ly8gQ2hyb21lIHZlcnNpb24gLSB6ZXJvIGZvciBvdGhlciBicm93c2Vyc1xuXHRcdGNocm9tZVZlcnNpb24gPSArKC9DaHJvbWVcXC8oWzAtOV0rKS8uZXhlYyhuYXZpZ2F0b3IudXNlckFnZW50KSB8fCBbLDBdKVsxXTtcblxuXHRcdGlmIChjaHJvbWVWZXJzaW9uKSB7XG5cblx0XHRcdGlmIChkZXZpY2VJc0FuZHJvaWQpIHtcblx0XHRcdFx0bWV0YVZpZXdwb3J0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignbWV0YVtuYW1lPXZpZXdwb3J0XScpO1xuXG5cdFx0XHRcdGlmIChtZXRhVmlld3BvcnQpIHtcblx0XHRcdFx0XHQvLyBDaHJvbWUgb24gQW5kcm9pZCB3aXRoIHVzZXItc2NhbGFibGU9XCJub1wiIGRvZXNuJ3QgbmVlZCBGYXN0Q2xpY2sgKGlzc3VlICM4OSlcblx0XHRcdFx0XHRpZiAobWV0YVZpZXdwb3J0LmNvbnRlbnQuaW5kZXhPZigndXNlci1zY2FsYWJsZT1ubycpICE9PSAtMSkge1xuXHRcdFx0XHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdC8vIENocm9tZSAzMiBhbmQgYWJvdmUgd2l0aCB3aWR0aD1kZXZpY2Utd2lkdGggb3IgbGVzcyBkb24ndCBuZWVkIEZhc3RDbGlja1xuXHRcdFx0XHRcdGlmIChjaHJvbWVWZXJzaW9uID4gMzEgJiYgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbFdpZHRoIDw9IHdpbmRvdy5vdXRlcldpZHRoKSB7XG5cdFx0XHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblxuXHRcdFx0Ly8gQ2hyb21lIGRlc2t0b3AgZG9lc24ndCBuZWVkIEZhc3RDbGljayAoaXNzdWUgIzE1KVxuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0aWYgKGRldmljZUlzQmxhY2tCZXJyeTEwKSB7XG5cdFx0XHRibGFja2JlcnJ5VmVyc2lvbiA9IG5hdmlnYXRvci51c2VyQWdlbnQubWF0Y2goL1ZlcnNpb25cXC8oWzAtOV0qKVxcLihbMC05XSopLyk7XG5cblx0XHRcdC8vIEJsYWNrQmVycnkgMTAuMysgZG9lcyBub3QgcmVxdWlyZSBGYXN0Y2xpY2sgbGlicmFyeS5cblx0XHRcdC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9mdGxhYnMvZmFzdGNsaWNrL2lzc3Vlcy8yNTFcblx0XHRcdGlmIChibGFja2JlcnJ5VmVyc2lvblsxXSA+PSAxMCAmJiBibGFja2JlcnJ5VmVyc2lvblsyXSA+PSAzKSB7XG5cdFx0XHRcdG1ldGFWaWV3cG9ydCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ21ldGFbbmFtZT12aWV3cG9ydF0nKTtcblxuXHRcdFx0XHRpZiAobWV0YVZpZXdwb3J0KSB7XG5cdFx0XHRcdFx0Ly8gdXNlci1zY2FsYWJsZT1ubyBlbGltaW5hdGVzIGNsaWNrIGRlbGF5LlxuXHRcdFx0XHRcdGlmIChtZXRhVmlld3BvcnQuY29udGVudC5pbmRleE9mKCd1c2VyLXNjYWxhYmxlPW5vJykgIT09IC0xKSB7XG5cdFx0XHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0Ly8gd2lkdGg9ZGV2aWNlLXdpZHRoIChvciBsZXNzIHRoYW4gZGV2aWNlLXdpZHRoKSBlbGltaW5hdGVzIGNsaWNrIGRlbGF5LlxuXHRcdFx0XHRcdGlmIChkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsV2lkdGggPD0gd2luZG93Lm91dGVyV2lkdGgpIHtcblx0XHRcdFx0XHRcdHJldHVybiB0cnVlO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblxuXHRcdC8vIElFMTAgd2l0aCAtbXMtdG91Y2gtYWN0aW9uOiBub25lIG9yIG1hbmlwdWxhdGlvbiwgd2hpY2ggZGlzYWJsZXMgZG91YmxlLXRhcC10by16b29tIChpc3N1ZSAjOTcpXG5cdFx0aWYgKGxheWVyLnN0eWxlLm1zVG91Y2hBY3Rpb24gPT09ICdub25lJyB8fCBsYXllci5zdHlsZS50b3VjaEFjdGlvbiA9PT0gJ21hbmlwdWxhdGlvbicpIHtcblx0XHRcdHJldHVybiB0cnVlO1xuXHRcdH1cblxuXHRcdC8vIEZpcmVmb3ggdmVyc2lvbiAtIHplcm8gZm9yIG90aGVyIGJyb3dzZXJzXG5cdFx0ZmlyZWZveFZlcnNpb24gPSArKC9GaXJlZm94XFwvKFswLTldKykvLmV4ZWMobmF2aWdhdG9yLnVzZXJBZ2VudCkgfHwgWywwXSlbMV07XG5cblx0XHRpZiAoZmlyZWZveFZlcnNpb24gPj0gMjcpIHtcblx0XHRcdC8vIEZpcmVmb3ggMjcrIGRvZXMgbm90IGhhdmUgdGFwIGRlbGF5IGlmIHRoZSBjb250ZW50IGlzIG5vdCB6b29tYWJsZSAtIGh0dHBzOi8vYnVnemlsbGEubW96aWxsYS5vcmcvc2hvd19idWcuY2dpP2lkPTkyMjg5NlxuXG5cdFx0XHRtZXRhVmlld3BvcnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdtZXRhW25hbWU9dmlld3BvcnRdJyk7XG5cdFx0XHRpZiAobWV0YVZpZXdwb3J0ICYmIChtZXRhVmlld3BvcnQuY29udGVudC5pbmRleE9mKCd1c2VyLXNjYWxhYmxlPW5vJykgIT09IC0xIHx8IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zY3JvbGxXaWR0aCA8PSB3aW5kb3cub3V0ZXJXaWR0aCkpIHtcblx0XHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0Ly8gSUUxMTogcHJlZml4ZWQgLW1zLXRvdWNoLWFjdGlvbiBpcyBubyBsb25nZXIgc3VwcG9ydGVkIGFuZCBpdCdzIHJlY29tZW5kZWQgdG8gdXNlIG5vbi1wcmVmaXhlZCB2ZXJzaW9uXG5cdFx0Ly8gaHR0cDovL21zZG4ubWljcm9zb2Z0LmNvbS9lbi11cy9saWJyYXJ5L3dpbmRvd3MvYXBwcy9IaDc2NzMxMy5hc3B4XG5cdFx0aWYgKGxheWVyLnN0eWxlLnRvdWNoQWN0aW9uID09PSAnbm9uZScgfHwgbGF5ZXIuc3R5bGUudG91Y2hBY3Rpb24gPT09ICdtYW5pcHVsYXRpb24nKSB7XG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHR9XG5cblx0XHRyZXR1cm4gZmFsc2U7XG5cdH07XG5cblxuXHQvKipcblx0ICogRmFjdG9yeSBtZXRob2QgZm9yIGNyZWF0aW5nIGEgRmFzdENsaWNrIG9iamVjdFxuXHQgKlxuXHQgKiBAcGFyYW0ge0VsZW1lbnR9IGxheWVyIFRoZSBsYXllciB0byBsaXN0ZW4gb25cblx0ICogQHBhcmFtIHtPYmplY3R9IFtvcHRpb25zPXt9XSBUaGUgb3B0aW9ucyB0byBvdmVycmlkZSB0aGUgZGVmYXVsdHNcblx0ICovXG5cdEZhc3RDbGljay5hdHRhY2ggPSBmdW5jdGlvbihsYXllciwgb3B0aW9ucykge1xuXHRcdHJldHVybiBuZXcgRmFzdENsaWNrKGxheWVyLCBvcHRpb25zKTtcblx0fTtcblxuXG5cdGlmICh0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIHR5cGVvZiBkZWZpbmUuYW1kID09PSAnb2JqZWN0JyAmJiBkZWZpbmUuYW1kKSB7XG5cblx0XHQvLyBBTUQuIFJlZ2lzdGVyIGFzIGFuIGFub255bW91cyBtb2R1bGUuXG5cdFx0ZGVmaW5lKGZ1bmN0aW9uKCkge1xuXHRcdFx0cmV0dXJuIEZhc3RDbGljaztcblx0XHR9KTtcblx0fSBlbHNlIGlmICh0eXBlb2YgbW9kdWxlICE9PSAndW5kZWZpbmVkJyAmJiBtb2R1bGUuZXhwb3J0cykge1xuXHRcdG1vZHVsZS5leHBvcnRzID0gRmFzdENsaWNrLmF0dGFjaDtcblx0XHRtb2R1bGUuZXhwb3J0cy5GYXN0Q2xpY2sgPSBGYXN0Q2xpY2s7XG5cdH0gZWxzZSB7XG5cdFx0d2luZG93LkZhc3RDbGljayA9IEZhc3RDbGljaztcblx0fVxufSgpKTtcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vfi9mYXN0Y2xpY2svbGliL2Zhc3RjbGljay5qc1xuLy8gbW9kdWxlIGlkID0gM1xuLy8gbW9kdWxlIGNodW5rcyA9IDAiXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9");

/***/ }),
/* 4 */
/***/ (function(module, exports, __webpack_require__) {

eval("var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;// ==========================================================================\n// Plyr\n// plyr.js v2.0.11\n// https://github.com/selz/plyr\n// License: The MIT License (MIT)\n// ==========================================================================\n// Credits: http://paypal.github.io/accessible-html5-video-player/\n// ==========================================================================\n\n;(function(root, factory) {\n    'use strict';\n    /*global define,module*/\n\n    if (typeof module === 'object' && typeof module.exports === 'object') {\n        // Node, CommonJS-like\n        module.exports = factory(root, document);\n    } else if (true) {\n        // AMD\n        !(__WEBPACK_AMD_DEFINE_ARRAY__ = [], __WEBPACK_AMD_DEFINE_RESULT__ = function () { return factory(root, document); }.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n    } else {\n        // Browser globals (root is window)\n        root.plyr = factory(root, document);\n    }\n}(typeof window !== 'undefined' ? window : this, function(window, document) {\n    'use strict';\n\n    // Globals\n    var fullscreen,\n    scroll = { x: 0, y: 0 },\n\n    // Default config\n    defaults = {\n        enabled:                true,\n        debug:                  false,\n        autoplay:               false,\n        loop:                   false,\n        seekTime:               10,\n        volume:                 10,\n        volumeMin:              0,\n        volumeMax:              10,\n        volumeStep:             1,\n        duration:               null,\n        displayDuration:        true,\n        loadSprite:             true,\n        iconPrefix:             'plyr',\n        iconUrl:                'https://cdn.plyr.io/2.0.11/plyr.svg',\n        clickToPlay:            true,\n        hideControls:           true,\n        showPosterOnEnd:        false,\n        disableContextMenu:     true,\n        keyboardShorcuts:       {\n            focused:            true,\n            global:             false\n        },\n        tooltips: {\n            controls:           false,\n            seek:               true\n        },\n        selectors: {\n            html5:              'video, audio',\n            embed:              '[data-type]',\n            editable:           'input, textarea, select, [contenteditable]',\n            container:          '.plyr',\n            controls: {\n                container:      null,\n                wrapper:        '.plyr__controls'\n            },\n            labels:             '[data-plyr]',\n            buttons: {\n                seek:           '[data-plyr=\"seek\"]',\n                play:           '[data-plyr=\"play\"]',\n                pause:          '[data-plyr=\"pause\"]',\n                restart:        '[data-plyr=\"restart\"]',\n                rewind:         '[data-plyr=\"rewind\"]',\n                forward:        '[data-plyr=\"fast-forward\"]',\n                mute:           '[data-plyr=\"mute\"]',\n                captions:       '[data-plyr=\"captions\"]',\n                fullscreen:     '[data-plyr=\"fullscreen\"]'\n            },\n            volume: {\n                input:          '[data-plyr=\"volume\"]',\n                display:        '.plyr__volume--display'\n            },\n            progress: {\n                container:      '.plyr__progress',\n                buffer:         '.plyr__progress--buffer',\n                played:         '.plyr__progress--played'\n            },\n            captions:           '.plyr__captions',\n            currentTime:        '.plyr__time--current',\n            duration:           '.plyr__time--duration'\n        },\n        classes: {\n            setup:              'plyr--setup',\n            ready:              'plyr--ready',\n            videoWrapper:       'plyr__video-wrapper',\n            embedWrapper:       'plyr__video-embed',\n            type:               'plyr--{0}',\n            stopped:            'plyr--stopped',\n            playing:            'plyr--playing',\n            muted:              'plyr--muted',\n            loading:            'plyr--loading',\n            hover:              'plyr--hover',\n            tooltip:            'plyr__tooltip',\n            hidden:             'plyr__sr-only',\n            hideControls:       'plyr--hide-controls',\n            isIos:              'plyr--is-ios',\n            isTouch:            'plyr--is-touch',\n            captions: {\n                enabled:        'plyr--captions-enabled',\n                active:         'plyr--captions-active'\n            },\n            fullscreen: {\n                enabled:        'plyr--fullscreen-enabled',\n                active:         'plyr--fullscreen-active'\n            },\n            tabFocus:           'tab-focus'\n        },\n        captions: {\n            defaultActive:      false\n        },\n        fullscreen: {\n            enabled:            true,\n            fallback:           true,\n            allowAudio:         false\n        },\n        storage: {\n            enabled:            true,\n            key:                'plyr'\n        },\n        controls:               ['play-large', 'play', 'progress', 'current-time', 'mute', 'volume', 'captions', 'fullscreen'],\n        i18n: {\n            restart:            'Restart',\n            rewind:             'Rewind {seektime} secs',\n            play:               'Play',\n            pause:              'Pause',\n            forward:            'Forward {seektime} secs',\n            played:             'played',\n            buffered:           'buffered',\n            currentTime:        'Current time',\n            duration:           'Duration',\n            volume:             'Volume',\n            toggleMute:         'Toggle Mute',\n            toggleCaptions:     'Toggle Captions',\n            toggleFullscreen:   'Toggle Fullscreen',\n            frameTitle:         'Player for {title}'\n        },\n        types: {\n            embed:              ['youtube', 'vimeo', 'soundcloud'],\n            html5:              ['video', 'audio']\n        },\n        // URLs\n        urls: {\n            vimeo: {\n                api:            'https://player.vimeo.com/api/player.js',\n            },\n            youtube: {\n                api:            'https://www.youtube.com/iframe_api'\n            },\n            soundcloud: {\n                api:            'https://w.soundcloud.com/player/api.js'\n            }\n        },\n        // Custom control listeners\n        listeners: {\n            seek:               null,\n            play:               null,\n            pause:              null,\n            restart:            null,\n            rewind:             null,\n            forward:            null,\n            mute:               null,\n            volume:             null,\n            captions:           null,\n            fullscreen:         null\n        },\n        // Events to watch on HTML5 media elements\n        events:                 ['ready', 'ended', 'progress', 'stalled', 'playing', 'waiting', 'canplay', 'canplaythrough', 'loadstart', 'loadeddata', 'loadedmetadata', 'timeupdate', 'volumechange', 'play', 'pause', 'error', 'seeking', 'seeked', 'emptied'],\n        // Logging\n        logPrefix:              '[Plyr]'\n    };\n\n    // Credits: http://paypal.github.io/accessible-html5-video-player/\n    // Unfortunately, due to mixed support, UA sniffing is required\n    function _browserSniff() {\n        var ua = navigator.userAgent,\n            name = navigator.appName,\n            fullVersion = '' + parseFloat(navigator.appVersion),\n            majorVersion = parseInt(navigator.appVersion, 10),\n            nameOffset,\n            verOffset,\n            ix,\n            isIE = false,\n            isFirefox = false,\n            isChrome = false,\n            isSafari = false;\n\n        if ((navigator.appVersion.indexOf('Windows NT') !== -1) && (navigator.appVersion.indexOf('rv:11') !== -1)) {\n            // MSIE 11\n            isIE = true;\n            name = 'IE';\n            fullVersion = '11';\n        } else if ((verOffset = ua.indexOf('MSIE')) !== -1) {\n            // MSIE\n            isIE = true;\n            name = 'IE';\n            fullVersion = ua.substring(verOffset + 5);\n        } else if ((verOffset = ua.indexOf('Chrome')) !== -1) {\n            // Chrome\n            isChrome = true;\n            name = 'Chrome';\n            fullVersion = ua.substring(verOffset + 7);\n        } else if ((verOffset = ua.indexOf('Safari')) !== -1) {\n            // Safari\n            isSafari = true;\n            name = 'Safari';\n            fullVersion = ua.substring(verOffset + 7);\n            if ((verOffset = ua.indexOf('Version')) !== -1) {\n                fullVersion = ua.substring(verOffset + 8);\n            }\n        } else if ((verOffset = ua.indexOf('Firefox')) !== -1) {\n            // Firefox\n            isFirefox = true;\n            name = 'Firefox';\n            fullVersion = ua.substring(verOffset + 8);\n        } else if ((nameOffset = ua.lastIndexOf(' ') + 1) < (verOffset = ua.lastIndexOf('/'))) {\n            // In most other browsers, 'name/version' is at the end of userAgent\n            name = ua.substring(nameOffset,verOffset);\n            fullVersion = ua.substring(verOffset + 1);\n\n            if (name.toLowerCase() === name.toUpperCase()) {\n                name = navigator.appName;\n            }\n        }\n\n        // Trim the fullVersion string at semicolon/space if present\n        if ((ix = fullVersion.indexOf(';')) !== -1) {\n            fullVersion = fullVersion.substring(0, ix);\n        }\n        if ((ix = fullVersion.indexOf(' ')) !== -1) {\n            fullVersion = fullVersion.substring(0, ix);\n        }\n\n        // Get major version\n        majorVersion = parseInt('' + fullVersion, 10);\n        if (isNaN(majorVersion)) {\n            fullVersion = '' + parseFloat(navigator.appVersion);\n            majorVersion = parseInt(navigator.appVersion, 10);\n        }\n\n        // Return data\n        return {\n            name:       name,\n            version:    majorVersion,\n            isIE:       isIE,\n            isFirefox:  isFirefox,\n            isChrome:   isChrome,\n            isSafari:   isSafari,\n            isIos:      /(iPad|iPhone|iPod)/g.test(navigator.platform),\n            isIphone:   /(iPhone|iPod)/g.test(navigator.userAgent),\n            isTouch:    'ontouchstart' in document.documentElement\n        };\n    }\n\n    // Check for mime type support against a player instance\n    // Credits: http://diveintohtml5.info/everything.html\n    // Related: http://www.leanbackplyr.com/test/h5mt.html\n    function _supportMime(plyr, mimeType) {\n        var media = plyr.media;\n\n        if (plyr.type === 'video') {\n            // Check type\n            switch (mimeType) {\n                case 'video/webm':   return !!(media.canPlayType && media.canPlayType('video/webm; codecs=\"vp8, vorbis\"').replace(/no/, ''));\n                case 'video/mp4':    return !!(media.canPlayType && media.canPlayType('video/mp4; codecs=\"avc1.42E01E, mp4a.40.2\"').replace(/no/, ''));\n                case 'video/ogg':    return !!(media.canPlayType && media.canPlayType('video/ogg; codecs=\"theora\"').replace(/no/, ''));\n            }\n        } else if (plyr.type === 'audio') {\n            // Check type\n            switch (mimeType) {\n                case 'audio/mpeg':   return !!(media.canPlayType && media.canPlayType('audio/mpeg;').replace(/no/, ''));\n                case 'audio/ogg':    return !!(media.canPlayType && media.canPlayType('audio/ogg; codecs=\"vorbis\"').replace(/no/, ''));\n                case 'audio/wav':    return !!(media.canPlayType && media.canPlayType('audio/wav; codecs=\"1\"').replace(/no/, ''));\n            }\n        }\n\n        // If we got this far, we're stuffed\n        return false;\n    }\n\n    // Inject a script\n    function _injectScript(source) {\n        if (document.querySelectorAll('script[src=\"' + source + '\"]').length) {\n            return;\n        }\n\n        var tag = document.createElement('script');\n        tag.src = source;\n        var firstScriptTag = document.getElementsByTagName('script')[0];\n        firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);\n    }\n\n    // Element exists in an array\n    function _inArray(haystack, needle) {\n        return Array.prototype.indexOf && (haystack.indexOf(needle) !== -1);\n    }\n\n    // Replace all\n    function _replaceAll(string, find, replace) {\n        return string.replace(new RegExp(find.replace(/([.*+?\\^=!:${}()|\\[\\]\\/\\\\])/g, '\\\\$1'), 'g'), replace);\n    }\n\n    // Wrap an element\n    function _wrap(elements, wrapper) {\n        // Convert `elements` to an array, if necessary.\n        if (!elements.length) {\n            elements = [elements];\n        }\n\n        // Loops backwards to prevent having to clone the wrapper on the\n        // first element (see `child` below).\n        for (var i = elements.length - 1; i >= 0; i--) {\n            var child   = (i > 0) ? wrapper.cloneNode(true) : wrapper;\n            var element = elements[i];\n\n            // Cache the current parent and sibling.\n            var parent  = element.parentNode;\n            var sibling = element.nextSibling;\n\n            // Wrap the element (is automatically removed from its current\n            // parent).\n            child.appendChild(element);\n\n            // If the element had a sibling, insert the wrapper before\n            // the sibling to maintain the HTML structure; otherwise, just\n            // append it to the parent.\n            if (sibling) {\n                parent.insertBefore(child, sibling);\n            } else {\n                parent.appendChild(child);\n            }\n\n            return child;\n        }\n    }\n\n    // Unwrap an element\n    // http://plainjs.com/javascript/manipulation/unwrap-a-dom-element-35/\n    /*function _unwrap(wrapper) {\n        // Get the element's parent node\n        var parent = wrapper.parentNode;\n\n        // Move all children out of the element\n        while (wrapper.firstChild) {\n            parent.insertBefore(wrapper.firstChild, wrapper);\n        }\n\n        // Remove the empty element\n        parent.removeChild(wrapper);\n    }*/\n\n    // Remove an element\n    function _remove(element) {\n        if (!element) {\n            return;\n        }\n        element.parentNode.removeChild(element);\n    }\n\n    // Prepend child\n    function _prependChild(parent, element) {\n        parent.insertBefore(element, parent.firstChild);\n    }\n\n    // Set attributes\n    function _setAttributes(element, attributes) {\n        for (var key in attributes) {\n            element.setAttribute(key, (_is.boolean(attributes[key]) && attributes[key]) ? '' : attributes[key]);\n        }\n    }\n\n    // Insert a HTML element\n    function _insertElement(type, parent, attributes) {\n        // Create a new <element>\n        var element = document.createElement(type);\n\n        // Set all passed attributes\n        _setAttributes(element, attributes);\n\n        // Inject the new element\n        _prependChild(parent, element);\n    }\n\n    // Get a classname from selector\n    function _getClassname(selector) {\n        return selector.replace('.', '');\n    }\n\n    // Toggle class on an element\n    function _toggleClass(element, className, state) {\n        if (element) {\n            if (element.classList) {\n                element.classList[state ? 'add' : 'remove'](className);\n            } else {\n                var name = (' ' + element.className + ' ').replace(/\\s+/g, ' ').replace(' ' + className + ' ', '');\n                element.className = name + (state ? ' ' + className : '');\n            }\n        }\n    }\n\n    // Has class name\n    function _hasClass(element, className) {\n        if (element) {\n            if (element.classList) {\n                return element.classList.contains(className);\n            } else {\n                return new RegExp('(\\\\s|^)' + className + '(\\\\s|$)').test(element.className);\n            }\n        }\n        return false;\n    }\n\n    // Element matches selector\n    function _matches(element, selector) {\n        var p = Element.prototype;\n\n        var f = p.matches || p.webkitMatchesSelector || p.mozMatchesSelector || p.msMatchesSelector || function(s) {\n            return [].indexOf.call(document.querySelectorAll(s), this) !== -1;\n        };\n\n        return f.call(element, selector);\n    }\n\n    // Bind along with custom handler\n    function _proxyListener(element, eventName, userListener, defaultListener, useCapture) {\n        _on(element, eventName, function(event) {\n            if (userListener) {\n                userListener.apply(element, [event]);\n            }\n            defaultListener.apply(element, [event]);\n        }, useCapture);\n    }\n\n    // Toggle event listener\n    function _toggleListener(element, events, callback, toggle, useCapture) {\n        var eventList = events.split(' ');\n\n        // Whether the listener is a capturing listener or not\n        // Default to false\n        if (!_is.boolean(useCapture)) {\n            useCapture = false;\n        }\n\n        // If a nodelist is passed, call itself on each node\n        if (element instanceof NodeList) {\n            for (var x = 0; x < element.length; x++) {\n                if (element[x] instanceof Node) {\n                    _toggleListener(element[x], arguments[1], arguments[2], arguments[3]);\n                }\n            }\n            return;\n        }\n\n        // If a single node is passed, bind the event listener\n        for (var i = 0; i < eventList.length; i++) {\n            element[toggle ? 'addEventListener' : 'removeEventListener'](eventList[i], callback, useCapture);\n        }\n    }\n\n    // Bind event\n    function _on(element, events, callback, useCapture) {\n        if (element) {\n            _toggleListener(element, events, callback, true, useCapture);\n        }\n    }\n\n    // Unbind event\n    /*function _off(element, events, callback, useCapture) {\n        if (element) {\n            _toggleListener(element, events, callback, false, useCapture);\n        }\n    }*/\n\n    // Trigger event\n    function _event(element, type, bubbles, properties) {\n        // Bail if no element\n        if (!element || !type) {\n            return;\n        }\n\n        // Default bubbles to false\n        if (!_is.boolean(bubbles)) {\n            bubbles = false;\n        }\n\n        // Create and dispatch the event\n        var event = new CustomEvent(type, {\n            bubbles:    bubbles,\n            detail:     properties\n        });\n\n        // Dispatch the event\n        element.dispatchEvent(event);\n    }\n\n    // Toggle aria-pressed state on a toggle button\n    // http://www.ssbbartgroup.com/blog/how-not-to-misuse-aria-states-properties-and-roles\n    function _toggleState(target, state) {\n        // Bail if no target\n        if (!target) {\n            return;\n        }\n\n        // Get state\n        state = (_is.boolean(state) ? state : !target.getAttribute('aria-pressed'));\n\n        // Set the attribute on target\n        target.setAttribute('aria-pressed', state);\n\n        return state;\n    }\n\n    // Get percentage\n    function _getPercentage(current, max) {\n        if (current === 0 || max === 0 || isNaN(current) || isNaN(max)) {\n            return 0;\n        }\n        return ((current / max) * 100).toFixed(2);\n    }\n\n    // Deep extend/merge destination object with N more objects\n    // http://andrewdupont.net/2009/08/28/deep-extending-objects-in-javascript/\n    // Removed call to arguments.callee (used explicit function name instead)\n    function _extend() {\n        // Get arguments\n        var objects = arguments;\n\n        // Bail if nothing to merge\n        if (!objects.length) {\n            return;\n        }\n\n        // Return first if specified but nothing to merge\n        if (objects.length === 1) {\n            return objects[0];\n        }\n\n        // First object is the destination\n        var destination = Array.prototype.shift.call(objects),\n            length      = objects.length;\n\n        // Loop through all objects to merge\n        for (var i = 0; i < length; i++) {\n            var source = objects[i];\n\n            for (var property in source) {\n                if (source[property] && source[property].constructor && source[property].constructor === Object) {\n                    destination[property] = destination[property] || {};\n                    _extend(destination[property], source[property]);\n                } else {\n                    destination[property] = source[property];\n                }\n            }\n        }\n\n        return destination;\n    }\n\n    // Check variable types\n    var _is = {\n        object: function(input) {\n            return input !== null && typeof(input) === 'object';\n        },\n        array: function(input) {\n            return input !== null && (typeof(input) === 'object' && input.constructor === Array);\n        },\n        number: function(input) {\n            return input !== null && (typeof(input) === 'number' && !isNaN(input - 0) || (typeof input === 'object' && input.constructor === Number));\n        },\n        string: function(input) {\n            return input !== null && (typeof input === 'string' || (typeof input === 'object' && input.constructor === String));\n        },\n        boolean: function(input) {\n            return input !== null && typeof input === 'boolean';\n        },\n        nodeList: function(input) {\n            return input !== null && input instanceof NodeList;\n        },\n        htmlElement: function(input) {\n            return input !== null && input instanceof HTMLElement;\n        },\n        function: function(input) {\n            return input !== null && typeof input === 'function';\n        },\n        undefined: function(input) {\n            return input !== null && typeof input === 'undefined';\n        }\n    };\n\n    // Parse YouTube ID from url\n    function _parseYouTubeId(url) {\n        var regex = /^.*(youtu.be\\/|v\\/|u\\/\\w\\/|embed\\/|watch\\?v=|\\&v=)([^#\\&\\?]*).*/;\n        return (url.match(regex)) ? RegExp.$2 : url;\n    }\n\n    // Parse Vimeo ID from url\n    function _parseVimeoId(url) {\n        var regex = /^.*(vimeo.com\\/|video\\/)(\\d+).*/;\n        return (url.match(regex)) ? RegExp.$2 : url;\n    }\n\n    // Fullscreen API\n    function _fullscreen() {\n        var fullscreen = {\n                supportsFullScreen: false,\n                isFullScreen: function() { return false; },\n                requestFullScreen: function() {},\n                cancelFullScreen: function() {},\n                fullScreenEventName: '',\n                element: null,\n                prefix: ''\n            },\n            browserPrefixes = 'webkit o moz ms khtml'.split(' ');\n\n        // Check for native support\n        if (!_is.undefined(document.cancelFullScreen)) {\n            fullscreen.supportsFullScreen = true;\n        } else {\n            // Check for fullscreen support by vendor prefix\n            for (var i = 0, il = browserPrefixes.length; i < il; i++ ) {\n                fullscreen.prefix = browserPrefixes[i];\n\n                if (!_is.undefined(document[fullscreen.prefix + 'CancelFullScreen'])) {\n                    fullscreen.supportsFullScreen = true;\n                    break;\n                } else if (!_is.undefined(document.msExitFullscreen) && document.msFullscreenEnabled) {\n                    // Special case for MS (when isn't it?)\n                    fullscreen.prefix = 'ms';\n                    fullscreen.supportsFullScreen = true;\n                    break;\n                }\n            }\n        }\n\n        // Update methods to do something useful\n        if (fullscreen.supportsFullScreen) {\n            // Yet again Microsoft awesomeness,\n            // Sometimes the prefix is 'ms', sometimes 'MS' to keep you on your toes\n            fullscreen.fullScreenEventName = (fullscreen.prefix === 'ms' ? 'MSFullscreenChange' : fullscreen.prefix + 'fullscreenchange');\n\n            fullscreen.isFullScreen = function(element) {\n                if (_is.undefined(element)) {\n                    element = document.body;\n                }\n                switch (this.prefix) {\n                    case '':\n                        return document.fullscreenElement === element;\n                    case 'moz':\n                        return document.mozFullScreenElement === element;\n                    default:\n                        return document[this.prefix + 'FullscreenElement'] === element;\n                }\n            };\n            fullscreen.requestFullScreen = function(element) {\n                if (_is.undefined(element)) {\n                    element = document.body;\n                }\n                return (this.prefix === '') ? element.requestFullScreen() : element[this.prefix + (this.prefix === 'ms' ? 'RequestFullscreen' : 'RequestFullScreen')]();\n            };\n            fullscreen.cancelFullScreen = function() {\n                return (this.prefix === '') ? document.cancelFullScreen() : document[this.prefix + (this.prefix === 'ms' ? 'ExitFullscreen' : 'CancelFullScreen')]();\n            };\n            fullscreen.element = function() {\n                return (this.prefix === '') ? document.fullscreenElement : document[this.prefix + 'FullscreenElement'];\n            };\n        }\n\n        return fullscreen;\n    }\n\n    // Local storage\n    var _storage = {\n        supported: (function() {\n            if (!('localStorage' in window)) {\n                return false;\n            }\n\n            // Try to use it (it might be disabled, e.g. user is in private/porn mode)\n            // see: https://github.com/Selz/plyr/issues/131\n            try {\n                // Add test item\n                window.localStorage.setItem('___test', 'OK');\n\n                // Get the test item\n                var result = window.localStorage.getItem('___test');\n\n                // Clean up\n                window.localStorage.removeItem('___test');\n\n                // Check if value matches\n                return (result === 'OK');\n            }\n            catch (e) {\n                return false;\n            }\n\n            return false;\n        })()\n    };\n\n    // Player instance\n    function Plyr(media, config) {\n        var plyr = this,\n        timers = {},\n        api;\n\n        // Set media\n        plyr.media = media;\n        var original = media.cloneNode(true);\n\n        // Trigger events, with plyr instance passed\n        function _triggerEvent(element, type, bubbles, properties) {\n            _event(element, type, bubbles, _extend({}, properties, {\n                plyr: api\n            }));\n        }\n\n        // Debugging\n        function _console(type, args) {\n            if (config.debug && window.console) {\n                args = Array.prototype.slice.call(args);\n\n                if (_is.string(config.logPrefix) && config.logPrefix.length) {\n                    args.unshift(config.logPrefix);\n                }\n\n                console[type].apply(console, args);\n            }\n        }\n        var _log = function() { _console('log', arguments) },\n            _warn = function() { _console('warn', arguments) };\n\n        // Log config options\n        _log('Config', config);\n\n        // Get icon URL\n        function _getIconUrl() {\n            return {\n                url:        config.iconUrl,\n                absolute:   (config.iconUrl.indexOf(\"http\") === 0) || plyr.browser.isIE\n            };\n        }\n\n        // Build the default HTML\n        function _buildControls() {\n            // Create html array\n            var html        = [],\n                iconUrl     = _getIconUrl(),\n                iconPath    = (!iconUrl.absolute ? iconUrl.url : '') + '#' + config.iconPrefix;\n\n            // Larger overlaid play button\n            if (_inArray(config.controls, 'play-large')) {\n                html.push(\n                    '<button type=\"button\" data-plyr=\"play\" class=\"plyr__play-large\">',\n                        '<svg><use xlink:href=\"' + iconPath + '-play\" /></svg>',\n                        '<span class=\"plyr__sr-only\">' + config.i18n.play + '</span>',\n                    '</button>'\n                );\n            }\n\n            html.push('<div class=\"plyr__controls\">');\n\n            // Restart button\n            if (_inArray(config.controls, 'restart')) {\n                html.push(\n                    '<button type=\"button\" data-plyr=\"restart\">',\n                        '<svg><use xlink:href=\"' + iconPath + '-restart\" /></svg>',\n                        '<span class=\"plyr__sr-only\">' + config.i18n.restart + '</span>',\n                    '</button>'\n                );\n            }\n\n            // Rewind button\n            if (_inArray(config.controls, 'rewind')) {\n                html.push(\n                    '<button type=\"button\" data-plyr=\"rewind\">',\n                        '<svg><use xlink:href=\"' + iconPath + '-rewind\" /></svg>',\n                        '<span class=\"plyr__sr-only\">' + config.i18n.rewind + '</span>',\n                    '</button>'\n                );\n            }\n\n            // Play Pause button\n            // TODO: This should be a toggle button really?\n            if (_inArray(config.controls, 'play')) {\n                html.push(\n                    '<button type=\"button\" data-plyr=\"play\">',\n                        '<svg><use xlink:href=\"' + iconPath + '-play\" /></svg>',\n                        '<span class=\"plyr__sr-only\">' + config.i18n.play + '</span>',\n                    '</button>',\n                    '<button type=\"button\" data-plyr=\"pause\">',\n                        '<svg><use xlink:href=\"' + iconPath + '-pause\" /></svg>',\n                        '<span class=\"plyr__sr-only\">' + config.i18n.pause + '</span>',\n                    '</button>'\n                );\n            }\n\n            // Fast forward button\n            if (_inArray(config.controls, 'fast-forward')) {\n                html.push(\n                    '<button type=\"button\" data-plyr=\"fast-forward\">',\n                        '<svg><use xlink:href=\"' + iconPath + '-fast-forward\" /></svg>',\n                        '<span class=\"plyr__sr-only\">' + config.i18n.forward + '</span>',\n                    '</button>'\n                );\n            }\n\n            // Progress\n            if (_inArray(config.controls, 'progress')) {\n                // Create progress\n                html.push('<span class=\"plyr__progress\">',\n                    '<label for=\"seek{id}\" class=\"plyr__sr-only\">Seek</label>',\n                    '<input id=\"seek{id}\" class=\"plyr__progress--seek\" type=\"range\" min=\"0\" max=\"100\" step=\"0.1\" value=\"0\" data-plyr=\"seek\">',\n                    '<progress class=\"plyr__progress--played\" max=\"100\" value=\"0\" role=\"presentation\"></progress>',\n                    '<progress class=\"plyr__progress--buffer\" max=\"100\" value=\"0\">',\n                        '<span>0</span>% ' + config.i18n.buffered,\n                    '</progress>');\n\n                // Seek tooltip\n                if (config.tooltips.seek) {\n                    html.push('<span class=\"plyr__tooltip\">00:00</span>');\n                }\n\n                // Close\n                html.push('</span>');\n            }\n\n            // Media current time display\n            if (_inArray(config.controls, 'current-time')) {\n                html.push(\n                    '<span class=\"plyr__time\">',\n                        '<span class=\"plyr__sr-only\">' + config.i18n.currentTime + '</span>',\n                        '<span class=\"plyr__time--current\">00:00</span>',\n                    '</span>'\n                );\n            }\n\n            // Media duration display\n            if (_inArray(config.controls, 'duration')) {\n                html.push(\n                    '<span class=\"plyr__time\">',\n                        '<span class=\"plyr__sr-only\">' + config.i18n.duration + '</span>',\n                        '<span class=\"plyr__time--duration\">00:00</span>',\n                    '</span>'\n                );\n            }\n\n            // Toggle mute button\n            if (_inArray(config.controls, 'mute')) {\n                html.push(\n                    '<button type=\"button\" data-plyr=\"mute\">',\n                        '<svg class=\"icon--muted\"><use xlink:href=\"' + iconPath + '-muted\" /></svg>',\n                        '<svg><use xlink:href=\"' + iconPath + '-volume\" /></svg>',\n                        '<span class=\"plyr__sr-only\">' + config.i18n.toggleMute + '</span>',\n                    '</button>'\n                );\n            }\n\n            // Volume range control\n            if (_inArray(config.controls, 'volume')) {\n                html.push(\n                    '<span class=\"plyr__volume\">',\n                        '<label for=\"volume{id}\" class=\"plyr__sr-only\">' + config.i18n.volume + '</label>',\n                        '<input id=\"volume{id}\" class=\"plyr__volume--input\" type=\"range\" min=\"' + config.volumeMin + '\" max=\"' + config.volumeMax + '\" value=\"' + config.volume + '\" data-plyr=\"volume\">',\n                        '<progress class=\"plyr__volume--display\" max=\"' + config.volumeMax + '\" value=\"' + config.volumeMin + '\" role=\"presentation\"></progress>',\n                    '</span>'\n                );\n            }\n\n            // Toggle captions button\n            if (_inArray(config.controls, 'captions')) {\n                html.push(\n                    '<button type=\"button\" data-plyr=\"captions\">',\n                        '<svg class=\"icon--captions-on\"><use xlink:href=\"' + iconPath + '-captions-on\" /></svg>',\n                        '<svg><use xlink:href=\"' + iconPath+ '-captions-off\" /></svg>',\n                        '<span class=\"plyr__sr-only\">' + config.i18n.toggleCaptions + '</span>',\n                    '</button>'\n                );\n            }\n\n            // Toggle fullscreen button\n            if (_inArray(config.controls, 'fullscreen')) {\n                html.push(\n                    '<button type=\"button\" data-plyr=\"fullscreen\">',\n                        '<svg class=\"icon--exit-fullscreen\"><use xlink:href=\"' + iconPath + '-exit-fullscreen\" /></svg>',\n                        '<svg><use xlink:href=\"' + iconPath + '-enter-fullscreen\" /></svg>',\n                        '<span class=\"plyr__sr-only\">' + config.i18n.toggleFullscreen + '</span>',\n                    '</button>'\n                );\n            }\n\n            // Close everything\n            html.push('</div>');\n\n            return html.join('');\n        }\n\n        // Setup fullscreen\n        function _setupFullscreen() {\n            if (!plyr.supported.full) {\n                return;\n            }\n\n            if ((plyr.type !== 'audio' || config.fullscreen.allowAudio) && config.fullscreen.enabled) {\n                // Check for native support\n                var nativeSupport = fullscreen.supportsFullScreen;\n\n                if (nativeSupport || (config.fullscreen.fallback && !_inFrame())) {\n                    _log((nativeSupport ? 'Native' : 'Fallback') + ' fullscreen enabled');\n\n                    // Add styling hook\n                    _toggleClass(plyr.container, config.classes.fullscreen.enabled, true);\n                } else {\n                    _log('Fullscreen not supported and fallback disabled');\n                }\n\n                // Toggle state\n                if (plyr.buttons && plyr.buttons.fullscreen) {\n                    _toggleState(plyr.buttons.fullscreen, false);\n                }\n\n                // Setup focus trap\n                _focusTrap();\n            }\n        }\n\n        // Setup captions\n        function _setupCaptions() {\n            // Bail if not HTML5 video\n            if (plyr.type !== 'video') {\n                return;\n            }\n\n            // Inject the container\n            if (!_getElement(config.selectors.captions)) {\n                plyr.videoContainer.insertAdjacentHTML('afterbegin', '<div class=\"' + _getClassname(config.selectors.captions) + '\"></div>');\n            }\n\n            // Determine if HTML5 textTracks is supported\n            plyr.usingTextTracks = false;\n            if (plyr.media.textTracks) {\n                plyr.usingTextTracks = true;\n            }\n\n            // Get URL of caption file if exists\n            var captionSrc = '',\n                kind,\n                children = plyr.media.childNodes;\n\n            for (var i = 0; i < children.length; i++) {\n                if (children[i].nodeName.toLowerCase() === 'track') {\n                    kind = children[i].kind;\n                    if (kind === 'captions' || kind === 'subtitles') {\n                        captionSrc = children[i].getAttribute('src');\n                    }\n                }\n            }\n\n            // Record if caption file exists or not\n            plyr.captionExists = true;\n            if (captionSrc === '') {\n                plyr.captionExists = false;\n                _log('No caption track found');\n            } else {\n                _log('Caption track found; URI: ' + captionSrc);\n            }\n\n            // If no caption file exists, hide container for caption text\n            if (!plyr.captionExists) {\n                _toggleClass(plyr.container, config.classes.captions.enabled);\n            } else {\n                // Turn off native caption rendering to avoid double captions\n                // This doesn't seem to work in Safari 7+, so the <track> elements are removed from the dom below\n                var tracks = plyr.media.textTracks;\n                for (var x = 0; x < tracks.length; x++) {\n                    tracks[x].mode = 'hidden';\n                }\n\n                // Enable UI\n                _showCaptions(plyr);\n\n                // Disable unsupported browsers than report false positive\n                // Firefox bug: https://bugzilla.mozilla.org/show_bug.cgi?id=1033144\n                if ((plyr.browser.isIE && plyr.browser.version >= 10) ||\n                    (plyr.browser.isFirefox && plyr.browser.version >= 31)) {\n\n                    // Debugging\n                    _log('Detected browser with known TextTrack issues - using manual fallback');\n\n                    // Set to false so skips to 'manual' captioning\n                    plyr.usingTextTracks = false;\n                }\n\n                // Rendering caption tracks\n                // Native support required - http://caniuse.com/webvtt\n                if (plyr.usingTextTracks) {\n                    _log('TextTracks supported');\n\n                    for (var y = 0; y < tracks.length; y++) {\n                        var track = tracks[y];\n\n                        if (track.kind === 'captions' || track.kind === 'subtitles') {\n                            _on(track, 'cuechange', function() {\n                                // Display a cue, if there is one\n                                if (this.activeCues[0] && 'text' in this.activeCues[0]) {\n                                    _setCaption(this.activeCues[0].getCueAsHTML());\n                                } else {\n                                    _setCaption();\n                                }\n                            });\n                        }\n                    }\n                } else {\n                    // Caption tracks not natively supported\n                    _log('TextTracks not supported so rendering captions manually');\n\n                    // Render captions from array at appropriate time\n                    plyr.currentCaption = '';\n                    plyr.captions = [];\n\n                    if (captionSrc !== '') {\n                        // Create XMLHttpRequest Object\n                        var xhr = new XMLHttpRequest();\n\n                        xhr.onreadystatechange = function() {\n                            if (xhr.readyState === 4) {\n                                if (xhr.status === 200) {\n                                    var captions = [],\n                                        caption,\n                                        req = xhr.responseText;\n\n                                    //According to webvtt spec, line terminator consists of one of the following\n                                    // CRLF (U+000D U+000A), LF (U+000A) or CR (U+000D)\n                                    var lineSeparator = '\\r\\n';\n                                    if(req.indexOf(lineSeparator+lineSeparator) === -1) {\n                                        if(req.indexOf('\\r\\r') !== -1){\n                                            lineSeparator = '\\r';\n                                        } else {\n                                            lineSeparator = '\\n';\n                                        }\n                                    }\n\n                                    captions = req.split(lineSeparator+lineSeparator);\n\n                                    for (var r = 0; r < captions.length; r++) {\n                                        caption = captions[r];\n                                        plyr.captions[r] = [];\n\n                                        // Get the parts of the captions\n                                        var parts = caption.split(lineSeparator),\n                                            index = 0;\n\n                                        // Incase caption numbers are added\n                                        if (parts[index].indexOf(\":\") === -1) {\n                                            index = 1;\n                                        }\n\n                                        plyr.captions[r] = [parts[index], parts[index + 1]];\n                                    }\n\n                                    // Remove first element ('VTT')\n                                    plyr.captions.shift();\n\n                                    _log('Successfully loaded the caption file via AJAX');\n                                } else {\n                                    _warn(config.logPrefix + 'There was a problem loading the caption file via AJAX');\n                                }\n                            }\n                        };\n\n                        xhr.open('get', captionSrc, true);\n\n                        xhr.send();\n                    }\n                }\n            }\n        }\n\n        // Set the current caption\n        function _setCaption(caption) {\n            /* jshint unused:false */\n            var container = _getElement(config.selectors.captions),\n                content = document.createElement('span');\n\n            // Empty the container\n            container.innerHTML = '';\n\n            // Default to empty\n            if (_is.undefined(caption)) {\n                caption = '';\n            }\n\n            // Set the span content\n            if (_is.string(caption)) {\n                content.innerHTML = caption.trim();\n            } else {\n                content.appendChild(caption);\n            }\n\n            // Set new caption text\n            container.appendChild(content);\n\n            // Force redraw (for Safari)\n            var redraw = container.offsetHeight;\n        }\n\n        // Captions functions\n        // Seek the manual caption time and update UI\n        function _seekManualCaptions(time) {\n            // Utilities for caption time codes\n            function _timecodeCommon(tc, pos) {\n                var tcpair = [];\n                tcpair = tc.split(' --> ');\n                for(var i = 0; i < tcpair.length; i++) {\n                    // WebVTT allows for extra meta data after the timestamp line\n                    // So get rid of this if it exists\n                    tcpair[i] = tcpair[i].replace(/(\\d+:\\d+:\\d+\\.\\d+).*/, \"$1\");\n                }\n                return _subTcSecs(tcpair[pos]);\n            }\n            function _timecodeMin(tc) {\n                return _timecodeCommon(tc, 0);\n            }\n            function _timecodeMax(tc) {\n                return _timecodeCommon(tc, 1);\n            }\n            function _subTcSecs(tc) {\n                if (tc === null || tc === undefined) {\n                    return 0;\n                } else {\n                    var tc1 = [],\n                        tc2 = [],\n                        seconds;\n                    tc1 = tc.split(',');\n                    tc2 = tc1[0].split(':');\n                    seconds = Math.floor(tc2[0]*60*60) + Math.floor(tc2[1]*60) + Math.floor(tc2[2]);\n                    return seconds;\n                }\n            }\n\n            // If it's not video, or we're using textTracks, bail.\n            if (plyr.usingTextTracks || plyr.type !== 'video' || !plyr.supported.full) {\n                return;\n            }\n\n            // Reset subcount\n            plyr.subcount = 0;\n\n            // Check time is a number, if not use currentTime\n            // IE has a bug where currentTime doesn't go to 0\n            // https://twitter.com/Sam_Potts/status/573715746506731521\n            time = _is.number(time) ? time : plyr.media.currentTime;\n\n            // If there's no subs available, bail\n            if (!plyr.captions[plyr.subcount]) {\n                return;\n            }\n\n            while (_timecodeMax(plyr.captions[plyr.subcount][0]) < time.toFixed(1)) {\n                plyr.subcount++;\n                if (plyr.subcount > plyr.captions.length - 1) {\n                    plyr.subcount = plyr.captions.length - 1;\n                    break;\n                }\n            }\n\n            // Check if the next caption is in the current time range\n            if (plyr.media.currentTime.toFixed(1) >= _timecodeMin(plyr.captions[plyr.subcount][0]) &&\n                plyr.media.currentTime.toFixed(1) <= _timecodeMax(plyr.captions[plyr.subcount][0])) {\n                    plyr.currentCaption = plyr.captions[plyr.subcount][1];\n\n                // Render the caption\n                _setCaption(plyr.currentCaption);\n            } else {\n                _setCaption();\n            }\n        }\n\n        // Display captions container and button (for initialization)\n        function _showCaptions() {\n            // If there's no caption toggle, bail\n            if (!plyr.buttons.captions) {\n                return;\n            }\n\n            _toggleClass(plyr.container, config.classes.captions.enabled, true);\n\n            // Try to load the value from storage\n            var active = plyr.storage.captionsEnabled;\n\n            // Otherwise fall back to the default config\n            if (!_is.boolean(active)) {\n                active = config.captions.defaultActive;\n            }\n\n            if (active) {\n                _toggleClass(plyr.container, config.classes.captions.active, true);\n                _toggleState(plyr.buttons.captions, true);\n            }\n        }\n\n        // Find all elements\n        function _getElements(selector) {\n            return plyr.container.querySelectorAll(selector);\n        }\n\n        // Find a single element\n        function _getElement(selector) {\n            return _getElements(selector)[0];\n        }\n\n        // Determine if we're in an iframe\n        function _inFrame() {\n            try {\n                return window.self !== window.top;\n            }\n            catch (e) {\n                return true;\n            }\n        }\n\n        // Trap focus inside container\n        function _focusTrap() {\n            var tabbables   = _getElements('input:not([disabled]), button:not([disabled])'),\n                first       = tabbables[0],\n                last        = tabbables[tabbables.length - 1];\n\n            function _checkFocus(event) {\n                // If it is TAB\n                if (event.which === 9 && plyr.isFullscreen) {\n                    if (event.target === last && !event.shiftKey) {\n                        // Move focus to first element that can be tabbed if Shift isn't used\n                        event.preventDefault();\n                        first.focus();\n                    } else if (event.target === first && event.shiftKey) {\n                        // Move focus to last element that can be tabbed if Shift is used\n                        event.preventDefault();\n                        last.focus();\n                    }\n                }\n            }\n\n            // Bind the handler\n            _on(plyr.container, 'keydown', _checkFocus);\n        }\n\n        // Add elements to HTML5 media (source, tracks, etc)\n        function _insertChildElements(type, attributes) {\n            if (_is.string(attributes)) {\n               _insertElement(type, plyr.media, { src: attributes });\n            } else if (attributes.constructor === Array) {\n                for (var i = attributes.length - 1; i >= 0; i--) {\n                    _insertElement(type, plyr.media, attributes[i]);\n                }\n            }\n        }\n\n        // Insert controls\n        function _injectControls() {\n            // Sprite\n            if (config.loadSprite) {\n                var iconUrl = _getIconUrl();\n\n                // Only load external sprite using AJAX\n                if (iconUrl.absolute) {\n                    _log('AJAX loading absolute SVG sprite' + (plyr.browser.isIE ? ' (due to IE)' : ''));\n                    loadSprite(iconUrl.url, \"sprite-plyr\");\n                } else {\n                    _log('Sprite will be used as external resource directly');\n                }\n            }\n\n            // Make a copy of the html\n            var html = config.html;\n\n            // Insert custom video controls\n            _log('Injecting custom controls');\n\n            // If no controls are specified, create default\n            if (!html) {\n                html = _buildControls();\n            }\n\n            // Replace seek time instances\n            html = _replaceAll(html, '{seektime}', config.seekTime);\n\n            // Replace all id references with random numbers\n            html = _replaceAll(html, '{id}', Math.floor(Math.random() * (10000)));\n\n            // Controls container\n            var target;\n\n            // Inject to custom location\n            if (_is.string(config.selectors.controls.container)) {\n                target = document.querySelector(config.selectors.controls.container);\n            }\n\n            // Inject into the container by default\n            if (!_is.htmlElement(target)) {\n                target = plyr.container\n            }\n\n            // Inject controls HTML\n            target.insertAdjacentHTML('beforeend', html);\n\n            // Setup tooltips\n            if (config.tooltips.controls) {\n                var labels = _getElements([config.selectors.controls.wrapper, ' ', config.selectors.labels, ' .', config.classes.hidden].join(''));\n\n                for (var i = labels.length - 1; i >= 0; i--) {\n                    var label = labels[i];\n\n                    _toggleClass(label, config.classes.hidden, false);\n                    _toggleClass(label, config.classes.tooltip, true);\n                }\n            }\n        }\n\n        // Find the UI controls and store references\n        function _findElements() {\n            try {\n                plyr.controls                 = _getElement(config.selectors.controls.wrapper);\n\n                // Buttons\n                plyr.buttons = {};\n                plyr.buttons.seek             = _getElement(config.selectors.buttons.seek);\n                plyr.buttons.play             = _getElements(config.selectors.buttons.play);\n                plyr.buttons.pause            = _getElement(config.selectors.buttons.pause);\n                plyr.buttons.restart          = _getElement(config.selectors.buttons.restart);\n                plyr.buttons.rewind           = _getElement(config.selectors.buttons.rewind);\n                plyr.buttons.forward          = _getElement(config.selectors.buttons.forward);\n                plyr.buttons.fullscreen       = _getElement(config.selectors.buttons.fullscreen);\n\n                // Inputs\n                plyr.buttons.mute             = _getElement(config.selectors.buttons.mute);\n                plyr.buttons.captions         = _getElement(config.selectors.buttons.captions);\n\n                // Progress\n                plyr.progress = {};\n                plyr.progress.container       = _getElement(config.selectors.progress.container);\n\n                // Progress - Buffering\n                plyr.progress.buffer          = {};\n                plyr.progress.buffer.bar      = _getElement(config.selectors.progress.buffer);\n                plyr.progress.buffer.text     = plyr.progress.buffer.bar && plyr.progress.buffer.bar.getElementsByTagName('span')[0];\n\n                // Progress - Played\n                plyr.progress.played          = _getElement(config.selectors.progress.played);\n\n                // Seek tooltip\n                plyr.progress.tooltip         = plyr.progress.container && plyr.progress.container.querySelector('.' + config.classes.tooltip);\n\n                // Volume\n                plyr.volume                   = {};\n                plyr.volume.input             = _getElement(config.selectors.volume.input);\n                plyr.volume.display           = _getElement(config.selectors.volume.display);\n\n                // Timing\n                plyr.duration                 = _getElement(config.selectors.duration);\n                plyr.currentTime              = _getElement(config.selectors.currentTime);\n                plyr.seekTime                 = _getElements(config.selectors.seekTime);\n\n                return true;\n            }\n            catch(e) {\n                _warn('It looks like there is a problem with your controls HTML');\n\n                // Restore native video controls\n                _toggleNativeControls(true);\n\n                return false;\n            }\n        }\n\n        // Toggle style hook\n        function _toggleStyleHook() {\n            _toggleClass(plyr.container, config.selectors.container.replace('.', ''), plyr.supported.full);\n        }\n\n        // Toggle native controls\n        function _toggleNativeControls(toggle) {\n            if (toggle && _inArray(config.types.html5, plyr.type)) {\n                plyr.media.setAttribute('controls', '');\n            } else {\n                plyr.media.removeAttribute('controls');\n            }\n        }\n\n        // Setup aria attribute for play and iframe title\n        function _setTitle(iframe) {\n            // Find the current text\n            var label = config.i18n.play;\n\n            // If there's a media title set, use that for the label\n            if (_is.string(config.title) && config.title.length) {\n                label += ', ' + config.title;\n\n                // Set container label\n                plyr.container.setAttribute('aria-label', config.title);\n            }\n\n            // If there's a play button, set label\n            if (plyr.supported.full && plyr.buttons.play) {\n                for (var i = plyr.buttons.play.length - 1; i >= 0; i--) {\n                    plyr.buttons.play[i].setAttribute('aria-label', label);\n                }\n            }\n\n            // Set iframe title\n            // https://github.com/Selz/plyr/issues/124\n            if (_is.htmlElement(iframe)) {\n                iframe.setAttribute('title', config.i18n.frameTitle.replace('{title}', config.title));\n            }\n        }\n\n        // Setup localStorage\n        function _setupStorage() {\n            var value = null;\n            plyr.storage = {};\n\n            // Bail if we don't have localStorage support or it's disabled\n            if (!_storage.supported || !config.storage.enabled) {\n                return;\n            }\n\n            // Clean up old volume\n            // https://github.com/Selz/plyr/issues/171\n            window.localStorage.removeItem('plyr-volume');\n\n            // load value from the current key\n            value = window.localStorage.getItem(config.storage.key);\n\n            if (!value) {\n                // Key wasn't set (or had been cleared), move along\n                return;\n            } else if (/^\\d+(\\.\\d+)?$/.test(value)) {\n                // If value is a number, it's probably volume from an older\n                // version of plyr. See: https://github.com/Selz/plyr/pull/313\n                // Update the key to be JSON\n                _updateStorage({volume: parseFloat(value)});\n            } else {\n                // Assume it's JSON from this or a later version of plyr\n                plyr.storage = JSON.parse(value);\n            }\n        }\n\n        // Save a value back to local storage\n        function _updateStorage(value) {\n            // Bail if we don't have localStorage support or it's disabled\n            if (!_storage.supported || !config.storage.enabled) {\n                return;\n            }\n\n            // Update the working copy of the values\n            _extend(plyr.storage, value);\n\n            // Update storage\n            window.localStorage.setItem(config.storage.key, JSON.stringify(plyr.storage));\n        }\n\n        // Setup media\n        function _setupMedia() {\n            // If there's no media, bail\n            if (!plyr.media) {\n                _warn('No media element found!');\n                return;\n            }\n\n            if (plyr.supported.full) {\n                // Add type class\n                _toggleClass(plyr.container, config.classes.type.replace('{0}', plyr.type), true);\n\n                // Add video class for embeds\n                // This will require changes if audio embeds are added\n                if (_inArray(config.types.embed, plyr.type)) {\n                    _toggleClass(plyr.container, config.classes.type.replace('{0}', 'video'), true);\n                }\n\n                // If there's no autoplay attribute, assume the video is stopped and add state class\n                _toggleClass(plyr.container, config.classes.stopped, config.autoplay);\n\n                // Add iOS class\n                _toggleClass(plyr.ontainer, config.classes.isIos, plyr.browser.isIos);\n\n                // Add touch class\n                _toggleClass(plyr.container, config.classes.isTouch, plyr.browser.isTouch);\n\n                // Inject the player wrapper\n                if (plyr.type === 'video') {\n                    // Create the wrapper div\n                    var wrapper = document.createElement('div');\n                    wrapper.setAttribute('class', config.classes.videoWrapper);\n\n                    // Wrap the video in a container\n                    _wrap(plyr.media, wrapper);\n\n                    // Cache the container\n                    plyr.videoContainer = wrapper;\n                }\n            }\n\n            // Embeds\n            if (_inArray(config.types.embed, plyr.type)) {\n                _setupEmbed();\n            }\n        }\n\n        // Setup YouTube/Vimeo\n        function _setupEmbed() {\n            var container = document.createElement('div'),\n                mediaId,\n                id = plyr.type + '-' + Math.floor(Math.random() * (10000));\n\n            // Parse IDs from URLs if supplied\n            switch (plyr.type) {\n                case 'youtube':\n                    mediaId = _parseYouTubeId(plyr.embedId);\n                    break;\n\n                case 'vimeo':\n                    mediaId = _parseVimeoId(plyr.embedId);\n                    break;\n\n                default:\n                    mediaId = plyr.embedId;\n            }\n\n            // Remove old containers\n            var containers = _getElements('[id^=\"' + plyr.type + '-\"]');\n            for (var i = containers.length - 1; i >= 0; i--) {\n                _remove(containers[i]);\n            }\n\n            // Add embed class for responsive\n            _toggleClass(plyr.media, config.classes.videoWrapper, true);\n            _toggleClass(plyr.media, config.classes.embedWrapper, true);\n\n            if (plyr.type === 'youtube') {\n                // Create the YouTube container\n                plyr.media.appendChild(container);\n\n                // Set ID\n                container.setAttribute('id', id);\n\n                // Setup API\n                if (_is.object(window.YT)) {\n                    _youTubeReady(mediaId, container);\n                } else {\n                    // Load the API\n                    _injectScript(config.urls.youtube.api);\n\n                    // Setup callback for the API\n                    window.onYouTubeReadyCallbacks = window.onYouTubeReadyCallbacks || [];\n\n                    // Add to queue\n                    window.onYouTubeReadyCallbacks.push(function() { _youTubeReady(mediaId, container); });\n\n                    // Set callback to process queue\n                    window.onYouTubeIframeAPIReady = function () {\n                        window.onYouTubeReadyCallbacks.forEach(function(callback) { callback(); });\n                    };\n                }\n            } else if (plyr.type === 'vimeo') {\n                // Vimeo needs an extra div to hide controls on desktop (which has full support)\n                if (plyr.supported.full) {\n                    plyr.media.appendChild(container);\n                } else {\n                    container = plyr.media;\n                }\n\n                // Set ID\n                container.setAttribute('id', id);\n\n                // Load the API if not already\n                if (!_is.object(window.Vimeo)) {\n                    _injectScript(config.urls.vimeo.api);\n\n                    // Wait for fragaloop load\n                    var vimeoTimer = window.setInterval(function() {\n                        if (_is.object(window.Vimeo)) {\n                            window.clearInterval(vimeoTimer);\n                            _vimeoReady(mediaId, container);\n                        }\n                    }, 50);\n                } else {\n                    _vimeoReady(mediaId, container);\n                }\n            } else if (plyr.type === 'soundcloud') {\n                // TODO: Currently unsupported and undocumented\n                // Inject the iframe\n                var soundCloud = document.createElement('iframe');\n\n                // Watch for iframe load\n                soundCloud.loaded = false;\n                _on(soundCloud, 'load', function() { soundCloud.loaded = true; });\n\n                _setAttributes(soundCloud, {\n                    'src':  'https://w.soundcloud.com/player/?url=https://api.soundcloud.com/tracks/' + mediaId,\n                    'id':   id\n                });\n\n                container.appendChild(soundCloud);\n                plyr.media.appendChild(container);\n\n                // Load the API if not already\n                if (!window.SC) {\n                    _injectScript(config.urls.soundcloud.api);\n                }\n\n                // Wait for SC load\n                var soundCloudTimer = window.setInterval(function() {\n                    if (window.SC && soundCloud.loaded) {\n                        window.clearInterval(soundCloudTimer);\n                        _soundcloudReady.call(soundCloud);\n                    }\n                }, 50);\n            }\n        }\n\n        // When embeds are ready\n        function _embedReady() {\n            // Setup the UI and call ready if full support\n            if (plyr.supported.full) {\n                _setupInterface();\n                _ready();\n            }\n\n            // Set title\n            _setTitle(_getElement('iframe'));\n        }\n\n        // Handle YouTube API ready\n        function _youTubeReady(videoId, container) {\n            // Setup instance\n            // https://developers.google.com/youtube/iframe_api_reference\n            plyr.embed = new window.YT.Player(container.id, {\n                videoId: videoId,\n                playerVars: {\n                    autoplay:       (config.autoplay ? 1 : 0),\n                    controls:       (plyr.supported.full ? 0 : 1),\n                    rel:            0,\n                    showinfo:       0,\n                    iv_load_policy: 3,\n                    cc_load_policy: (config.captions.defaultActive ? 1 : 0),\n                    cc_lang_pref:   'en',\n                    wmode:          'transparent',\n                    modestbranding: 1,\n                    disablekb:      1,\n                    origin:         '*' // https://code.google.com/p/gdata-issues/issues/detail?id=5788#c45\n                },\n                events: {\n                    'onError': function(event) {\n                        _triggerEvent(plyr.container, 'error', true, {\n                            code:   event.data,\n                            embed:  event.target\n                        });\n                    },\n                    'onReady': function(event) {\n                        // Get the instance\n                        var instance = event.target;\n\n                        // Create a faux HTML5 API using the YouTube API\n                        plyr.media.play = function() {\n                            instance.playVideo();\n                            plyr.media.paused = false;\n                        };\n                        plyr.media.pause = function() {\n                            instance.pauseVideo();\n                            plyr.media.paused = true;\n                        };\n                        plyr.media.stop = function() {\n                            instance.stopVideo();\n                            plyr.media.paused = true;\n                        };\n                        plyr.media.duration = instance.getDuration();\n                        plyr.media.paused = true;\n                        plyr.media.currentTime = 0;\n                        plyr.media.muted = instance.isMuted();\n\n                        // Set title\n                        config.title = instance.getVideoData().title;\n\n                        // Set the tabindex\n                        if (plyr.supported.full) {\n                            plyr.media.querySelector('iframe').setAttribute('tabindex', '-1');\n                        }\n\n                        // Update UI\n                        _embedReady();\n\n                        // Trigger timeupdate\n                        _triggerEvent(plyr.media, 'timeupdate');\n\n                        // Trigger timeupdate\n                        _triggerEvent(plyr.media, 'durationchange');\n\n                        // Reset timer\n                        window.clearInterval(timers.buffering);\n\n                        // Setup buffering\n                        timers.buffering = window.setInterval(function() {\n                            // Get loaded % from YouTube\n                            plyr.media.buffered = instance.getVideoLoadedFraction();\n\n                            // Trigger progress only when we actually buffer something\n                            if (plyr.media.lastBuffered === null || plyr.media.lastBuffered < plyr.media.buffered) {\n                                _triggerEvent(plyr.media, 'progress');\n                            }\n\n                            // Set last buffer point\n                            plyr.media.lastBuffered = plyr.media.buffered;\n\n                            // Bail if we're at 100%\n                            if (plyr.media.buffered === 1) {\n                                window.clearInterval(timers.buffering);\n\n                                // Trigger event\n                                _triggerEvent(plyr.media, 'canplaythrough');\n                            }\n                        }, 200);\n                    },\n                    'onStateChange': function(event) {\n                        // Get the instance\n                        var instance = event.target;\n\n                        // Reset timer\n                        window.clearInterval(timers.playing);\n\n                        // Handle events\n                        // -1   Unstarted\n                        // 0    Ended\n                        // 1    Playing\n                        // 2    Paused\n                        // 3    Buffering\n                        // 5    Video cued\n                        switch (event.data) {\n                            case 0:\n                                plyr.media.paused = true;\n                                _triggerEvent(plyr.media, 'ended');\n                                break;\n\n                            case 1:\n                                plyr.media.paused = false;\n\n                                // If we were seeking, fire seeked event\n                                if (plyr.media.seeking) {\n                                    _triggerEvent(plyr.media, 'seeked');\n                                }\n\n                                plyr.media.seeking = false;\n                                _triggerEvent(plyr.media, 'play');\n                                _triggerEvent(plyr.media, 'playing');\n\n                                // Poll to get playback progress\n                                timers.playing = window.setInterval(function() {\n                                    // Set the current time\n                                    plyr.media.currentTime = instance.getCurrentTime();\n\n                                    // Trigger timeupdate\n                                    _triggerEvent(plyr.media, 'timeupdate');\n                                }, 100);\n\n                                // Check duration again due to YouTube bug\n                                // https://github.com/Selz/plyr/issues/374\n                                // https://code.google.com/p/gdata-issues/issues/detail?id=8690\n                                if (plyr.media.duration !== instance.getDuration()) {\n                                    plyr.media.duration = instance.getDuration();\n                                    _triggerEvent(plyr.media, 'durationchange');\n                                }\n\n                                break;\n\n                            case 2:\n                                plyr.media.paused = true;\n                                _triggerEvent(plyr.media, 'pause');\n                                break;\n                        }\n\n                        _triggerEvent(plyr.container, 'statechange', false, {\n                            code: event.data\n                        });\n                    }\n                }\n            });\n        }\n\n        // Vimeo ready\n        function _vimeoReady(mediaId, container) {\n            // Setup instance\n            // https://github.com/vimeo/player.js\n            plyr.embed = new window.Vimeo.Player(container, {\n                id:         parseInt(mediaId),\n                loop:       config.loop,\n                autoplay:   config.autoplay,\n                byline:     false,\n                portrait:   false,\n                title:      false\n            });\n\n            // Create a faux HTML5 API using the Vimeo API\n            plyr.media.play = function() {\n                plyr.embed.play();\n                plyr.media.paused = false;\n            };\n            plyr.media.pause = function() {\n                plyr.embed.pause();\n                plyr.media.paused = true;\n            };\n            plyr.media.stop = function() {\n                plyr.embed.stop();\n                plyr.media.paused = true;\n            };\n\n            plyr.media.paused = true;\n            plyr.media.currentTime = 0;\n\n            // Update UI\n            _embedReady();\n\n            plyr.embed.getCurrentTime().then(function(value) {\n                plyr.media.currentTime = value;\n\n                // Trigger timeupdate\n                _triggerEvent(plyr.media, 'timeupdate');\n            });\n\n            plyr.embed.getDuration().then(function(value) {\n                plyr.media.duration = value;\n\n                // Trigger timeupdate\n                _triggerEvent(plyr.media, 'durationchange');\n            });\n\n            // TODO: Captions\n            /*if (config.captions.defaultActive) {\n                plyr.embed.enableTextTrack('en');\n            }*/\n\n            plyr.embed.on('loaded', function() {\n                // Fix keyboard focus issues\n                // https://github.com/Selz/plyr/issues/317\n                if (_is.htmlElement(plyr.embed.element) && plyr.supported.full) {\n                    plyr.embed.element.setAttribute('tabindex', '-1');\n                }\n            });\n\n            plyr.embed.on('play', function() {\n                plyr.media.paused = false;\n                _triggerEvent(plyr.media, 'play');\n                _triggerEvent(plyr.media, 'playing');\n            });\n\n            plyr.embed.on('pause', function() {\n                plyr.media.paused = true;\n                _triggerEvent(plyr.media, 'pause');\n            });\n\n            plyr.embed.on('timeupdate', function(data) {\n                plyr.media.seeking = false;\n                plyr.media.currentTime = data.seconds;\n                _triggerEvent(plyr.media, 'timeupdate');\n            });\n\n            plyr.embed.on('progress', function(data) {\n                plyr.media.buffered = data.percent;\n                _triggerEvent(plyr.media, 'progress');\n\n                if (parseInt(data.percent) === 1) {\n                    // Trigger event\n                    _triggerEvent(plyr.media, 'canplaythrough');\n                }\n            });\n\n            plyr.embed.on('seeked', function() {\n                plyr.media.seeking = false;\n                _triggerEvent(plyr.media, 'seeked');\n                _triggerEvent(plyr.media, 'play');\n            });\n\n            plyr.embed.on('ended', function() {\n                plyr.media.paused = true;\n                _triggerEvent(plyr.media, 'ended');\n            });\n        }\n\n        // Soundcloud ready\n        function _soundcloudReady() {\n            /* jshint validthis: true */\n            plyr.embed = window.SC.Widget(this);\n\n            // Setup on ready\n            plyr.embed.bind(window.SC.Widget.Events.READY, function() {\n                // Create a faux HTML5 API using the Soundcloud API\n                plyr.media.play = function() {\n                    plyr.embed.play();\n                    plyr.media.paused = false;\n                };\n                plyr.media.pause = function() {\n                    plyr.embed.pause();\n                    plyr.media.paused = true;\n                };\n                plyr.media.stop = function() {\n                    plyr.embed.seekTo(0);\n                    plyr.embed.pause();\n                    plyr.media.paused = true;\n                };\n\n                plyr.media.paused = true;\n                plyr.media.currentTime = 0;\n\n                plyr.embed.getDuration(function(value) {\n                    plyr.media.duration = value/1000;\n\n                    // Update UI\n                    _embedReady();\n                });\n\n                plyr.embed.getPosition(function(value) {\n                    plyr.media.currentTime = value;\n\n                    // Trigger timeupdate\n                    _triggerEvent(plyr.media, 'timeupdate');\n                });\n\n                plyr.embed.bind(window.SC.Widget.Events.PLAY, function() {\n                    plyr.media.paused = false;\n                    _triggerEvent(plyr.media, 'play');\n                    _triggerEvent(plyr.media, 'playing');\n                });\n\n                plyr.embed.bind(window.SC.Widget.Events.PAUSE, function() {\n                    plyr.media.paused = true;\n                    _triggerEvent(plyr.media, 'pause');\n                });\n\n                plyr.embed.bind(window.SC.Widget.Events.PLAY_PROGRESS, function(data) {\n                    plyr.media.seeking = false;\n                    plyr.media.currentTime = data.currentPosition/1000;\n                    _triggerEvent(plyr.media, 'timeupdate');\n                });\n\n                plyr.embed.bind(window.SC.Widget.Events.LOAD_PROGRESS, function(data) {\n                    plyr.media.buffered = data.loadProgress;\n                    _triggerEvent(plyr.media, 'progress');\n\n                    if (parseInt(data.loadProgress) === 1) {\n                        // Trigger event\n                        _triggerEvent(plyr.media, 'canplaythrough');\n                    }\n                });\n\n                plyr.embed.bind(window.SC.Widget.Events.FINISH, function() {\n                    plyr.media.paused = true;\n                    _triggerEvent(plyr.media, 'ended');\n                });\n            });\n        }\n\n        // Play media\n        function _play() {\n            if ('play' in plyr.media) {\n                plyr.media.play();\n            }\n        }\n\n        // Pause media\n        function _pause() {\n            if ('pause' in plyr.media) {\n                plyr.media.pause();\n            }\n        }\n\n        // Toggle playback\n        function _togglePlay(toggle) {\n            // True toggle\n            if (!_is.boolean(toggle)) {\n                toggle = plyr.media.paused;\n            }\n\n            if (toggle) {\n                _play();\n            } else {\n                _pause();\n            }\n\n            return toggle;\n        }\n\n        // Rewind\n        function _rewind(seekTime) {\n            // Use default if needed\n            if (!_is.number(seekTime)) {\n                seekTime = config.seekTime;\n            }\n            _seek(plyr.media.currentTime - seekTime);\n        }\n\n        // Fast forward\n        function _forward(seekTime) {\n            // Use default if needed\n            if (!_is.number(seekTime)) {\n                seekTime = config.seekTime;\n            }\n            _seek(plyr.media.currentTime + seekTime);\n        }\n\n        // Seek to time\n        // The input parameter can be an event or a number\n        function _seek(input) {\n            var targetTime  = 0,\n                paused      = plyr.media.paused,\n                duration    = _getDuration();\n\n            if (_is.number(input)) {\n                targetTime = input;\n            } else if (_is.object(input) && _inArray(['input', 'change'], input.type)) {\n                // It's the seek slider\n                // Seek to the selected time\n                targetTime = ((input.target.value / input.target.max) * duration);\n            }\n\n            // Normalise targetTime\n            if (targetTime < 0) {\n                targetTime = 0;\n            } else if (targetTime > duration) {\n                targetTime = duration;\n            }\n\n            // Update seek range and progress\n            _updateSeekDisplay(targetTime);\n\n            // Set the current time\n            // Try/catch incase the media isn't set and we're calling seek() from source() and IE moans\n            try {\n                plyr.media.currentTime = targetTime.toFixed(4);\n            }\n            catch(e) {}\n\n            // Embeds\n            if (_inArray(config.types.embed, plyr.type)) {\n                switch(plyr.type) {\n                    case 'youtube':\n                        plyr.embed.seekTo(targetTime);\n                        break;\n\n                    case 'vimeo':\n                        // Round to nearest second for vimeo\n                        plyr.embed.setCurrentTime(targetTime.toFixed(0));\n                        break;\n\n                    case 'soundcloud':\n                        plyr.embed.seekTo(targetTime * 1000);\n                        break;\n                }\n\n                if (paused) {\n                    _pause();\n                }\n\n                // Trigger timeupdate\n                _triggerEvent(plyr.media, 'timeupdate');\n\n                // Set seeking flag\n                plyr.media.seeking = true;\n\n                // Trigger seeking\n                _triggerEvent(plyr.media, 'seeking');\n            }\n\n            // Logging\n            _log('Seeking to ' + plyr.media.currentTime + ' seconds');\n\n            // Special handling for 'manual' captions\n            _seekManualCaptions(targetTime);\n        }\n\n        // Get the duration (or custom if set)\n        function _getDuration() {\n            // It should be a number, but parse it just incase\n            var duration = parseInt(config.duration),\n\n            // True duration\n            mediaDuration = 0;\n\n            // Only if duration available\n            if (plyr.media.duration !== null && !isNaN(plyr.media.duration)) {\n                mediaDuration = plyr.media.duration;\n            }\n\n            // If custom duration is funky, use regular duration\n            return (isNaN(duration) ? mediaDuration : duration);\n        }\n\n        // Check playing state\n        function _checkPlaying() {\n            _toggleClass(plyr.container, config.classes.playing, !plyr.media.paused);\n\n            _toggleClass(plyr.container, config.classes.stopped, plyr.media.paused);\n\n            _toggleControls(plyr.media.paused);\n        }\n\n        // Save scroll position\n        function _saveScrollPosition() {\n            scroll = {\n                x: window.pageXOffset || 0,\n                y: window.pageYOffset || 0\n            };\n        }\n\n        // Restore scroll position\n        function _restoreScrollPosition() {\n            window.scrollTo(scroll.x, scroll.y);\n        }\n\n        // Toggle fullscreen\n        function _toggleFullscreen(event) {\n            // Check for native support\n            var nativeSupport = fullscreen.supportsFullScreen;\n\n            if (nativeSupport) {\n                // If it's a fullscreen change event, update the UI\n                if (event && event.type === fullscreen.fullScreenEventName) {\n                    plyr.isFullscreen = fullscreen.isFullScreen(plyr.container);\n                } else {\n                    // Else it's a user request to enter or exit\n                    if (!fullscreen.isFullScreen(plyr.container)) {\n                        // Save scroll position\n                        _saveScrollPosition();\n\n                        // Request full screen\n                        fullscreen.requestFullScreen(plyr.container);\n                    } else {\n                        // Bail from fullscreen\n                        fullscreen.cancelFullScreen();\n                    }\n\n                    // Check if we're actually full screen (it could fail)\n                    plyr.isFullscreen = fullscreen.isFullScreen(plyr.container);\n\n                    return;\n                }\n            } else {\n                // Otherwise, it's a simple toggle\n                plyr.isFullscreen = !plyr.isFullscreen;\n\n                // Bind/unbind escape key\n                document.body.style.overflow = plyr.isFullscreen ? 'hidden' : '';\n            }\n\n            // Set class hook\n            _toggleClass(plyr.container, config.classes.fullscreen.active, plyr.isFullscreen);\n\n            // Trap focus\n            _focusTrap(plyr.isFullscreen);\n\n            // Set button state\n            if (plyr.buttons && plyr.buttons.fullscreen) {\n                _toggleState(plyr.buttons.fullscreen, plyr.isFullscreen);\n            }\n\n            // Trigger an event\n            _triggerEvent(plyr.container, plyr.isFullscreen ? 'enterfullscreen' : 'exitfullscreen', true);\n\n            // Restore scroll position\n            if (!plyr.isFullscreen && nativeSupport) {\n                _restoreScrollPosition();\n            }\n        }\n\n        // Mute\n        function _toggleMute(muted) {\n            // If the method is called without parameter, toggle based on current value\n            if (!_is.boolean(muted)) {\n                muted = !plyr.media.muted;\n            }\n\n            // Set button state\n            _toggleState(plyr.buttons.mute, muted);\n\n            // Set mute on the player\n            plyr.media.muted = muted;\n\n            // If volume is 0 after unmuting, set to default\n            if (plyr.media.volume === 0) {\n                _setVolume(config.volume);\n            }\n\n            // Embeds\n            if (_inArray(config.types.embed, plyr.type)) {\n                // YouTube\n                switch(plyr.type) {\n                    case 'youtube':\n                        plyr.embed[plyr.media.muted ? 'mute' : 'unMute']();\n                        break;\n\n                    case 'vimeo':\n                    case 'soundcloud':\n                        plyr.embed.setVolume(plyr.media.muted ? 0 : parseFloat(config.volume / config.volumeMax));\n                        break;\n                }\n\n                // Trigger volumechange for embeds\n                _triggerEvent(plyr.media, 'volumechange');\n            }\n        }\n\n        // Set volume\n        function _setVolume(volume) {\n            var max = config.volumeMax,\n                min = config.volumeMin;\n\n            // Load volume from storage if no value specified\n            if (_is.undefined(volume)) {\n                volume = plyr.storage.volume;\n            }\n\n            // Use config if all else fails\n            if (volume === null || isNaN(volume)) {\n                volume = config.volume;\n            }\n\n            // Maximum is volumeMax\n            if (volume > max) {\n                volume = max;\n            }\n            // Minimum is volumeMin\n            if (volume < min) {\n                volume = min;\n            }\n\n            // Set the player volume\n            plyr.media.volume = parseFloat(volume / max);\n\n            // Set the display\n            if (plyr.volume.display) {\n                plyr.volume.display.value = volume;\n            }\n\n            // Embeds\n            if (_inArray(config.types.embed, plyr.type)) {\n                switch(plyr.type) {\n                    case 'youtube':\n                        plyr.embed.setVolume(plyr.media.volume * 100);\n                        break;\n\n                    case 'vimeo':\n                    case 'soundcloud':\n                        plyr.embed.setVolume(plyr.media.volume);\n                        break;\n                }\n\n                // Trigger volumechange for embeds\n                _triggerEvent(plyr.media, 'volumechange');\n            }\n\n            // Toggle muted state\n            if (volume === 0) {\n                plyr.media.muted = true;\n            } else if (plyr.media.muted && volume > 0) {\n                _toggleMute();\n            }\n        }\n\n        // Increase volume\n        function _increaseVolume(step) {\n            var volume = plyr.media.muted ? 0 : (plyr.media.volume * config.volumeMax);\n\n            if (!_is.number(step)) {\n                step = config.volumeStep;\n            }\n\n            _setVolume(volume + step);\n        }\n\n        // Decrease volume\n        function _decreaseVolume(step) {\n            var volume = plyr.media.muted ? 0 : (plyr.media.volume * config.volumeMax);\n\n            if (!_is.number(step)) {\n                step = config.volumeStep;\n            }\n\n            _setVolume(volume - step);\n        }\n\n        // Update volume UI and storage\n        function _updateVolume() {\n            // Get the current volume\n            var volume = plyr.media.muted ? 0 : (plyr.media.volume * config.volumeMax);\n\n            // Update the <input type=\"range\"> if present\n            if (plyr.supported.full) {\n                if (plyr.volume.input) {\n                    plyr.volume.input.value = volume;\n                }\n                if (plyr.volume.display) {\n                    plyr.volume.display.value = volume;\n                }\n            }\n\n            // Update the volume in storage\n            _updateStorage({volume: volume});\n\n            // Toggle class if muted\n            _toggleClass(plyr.container, config.classes.muted, (volume === 0));\n\n            // Update checkbox for mute state\n            if (plyr.supported.full && plyr.buttons.mute) {\n                _toggleState(plyr.buttons.mute, (volume === 0));\n            }\n        }\n\n        // Toggle captions\n        function _toggleCaptions(show) {\n            // If there's no full support, or there's no caption toggle\n            if (!plyr.supported.full || !plyr.buttons.captions) {\n                return;\n            }\n\n            // If the method is called without parameter, toggle based on current value\n            if (!_is.boolean(show)) {\n                show = (plyr.container.className.indexOf(config.classes.captions.active) === -1);\n            }\n\n            // Set global\n            plyr.captionsEnabled = show;\n\n            // Toggle state\n            _toggleState(plyr.buttons.captions, plyr.captionsEnabled);\n\n            // Add class hook\n            _toggleClass(plyr.container, config.classes.captions.active, plyr.captionsEnabled);\n\n            // Trigger an event\n            _triggerEvent(plyr.container, plyr.captionsEnabled ? 'captionsenabled' : 'captionsdisabled', true);\n\n            // Save captions state to localStorage\n            _updateStorage({captionsEnabled: plyr.captionsEnabled});\n        }\n\n        // Check if media is loading\n        function _checkLoading(event) {\n            var loading = (event.type === 'waiting');\n\n            // Clear timer\n            clearTimeout(timers.loading);\n\n            // Timer to prevent flicker when seeking\n            timers.loading = setTimeout(function() {\n                // Toggle container class hook\n                _toggleClass(plyr.container, config.classes.loading, loading);\n\n                // Show controls if loading, hide if done\n                _toggleControls(loading);\n            }, (loading ? 250 : 0));\n        }\n\n        // Update <progress> elements\n        function _updateProgress(event) {\n            if (!plyr.supported.full) {\n                return;\n            }\n\n            var progress    = plyr.progress.played,\n                value       = 0,\n                duration    = _getDuration();\n\n            if (event) {\n                switch (event.type) {\n                    // Video playing\n                    case 'timeupdate':\n                    case 'seeking':\n                        if (plyr.controls.pressed) {\n                            return;\n                        }\n\n                        value = _getPercentage(plyr.media.currentTime, duration);\n\n                        // Set seek range value only if it's a 'natural' time event\n                        if (event.type === 'timeupdate' && plyr.buttons.seek) {\n                            plyr.buttons.seek.value = value;\n                        }\n\n                        break;\n\n                    // Check buffer status\n                    case 'playing':\n                    case 'progress':\n                        progress    = plyr.progress.buffer;\n                        value       = (function() {\n                            var buffered = plyr.media.buffered;\n\n                            if (buffered && buffered.length) {\n                                // HTML5\n                                return _getPercentage(buffered.end(0), duration);\n                            } else if (_is.number(buffered)) {\n                                // YouTube returns between 0 and 1\n                                return (buffered * 100);\n                            }\n\n                            return 0;\n                        })();\n\n                        break;\n                }\n            }\n\n            // Set values\n            _setProgress(progress, value);\n        }\n\n        // Set <progress> value\n        function _setProgress(progress, value) {\n            if (!plyr.supported.full) {\n                return;\n            }\n\n            // Default to 0\n            if (_is.undefined(value)) {\n                value = 0;\n            }\n            // Default to buffer or bail\n            if (_is.undefined(progress)) {\n                if (plyr.progress && plyr.progress.buffer) {\n                    progress = plyr.progress.buffer;\n                } else {\n                    return;\n                }\n            }\n\n            // One progress element passed\n            if (_is.htmlElement(progress)) {\n                progress.value = value;\n            } else if (progress) {\n                // Object of progress + text element\n                if (progress.bar) {\n                    progress.bar.value = value;\n                }\n                if (progress.text) {\n                    progress.text.innerHTML = value;\n                }\n            }\n        }\n\n        // Update the displayed time\n        function _updateTimeDisplay(time, element) {\n            // Bail if there's no duration display\n            if (!element) {\n                return;\n            }\n\n            // Fallback to 0\n            if (isNaN(time)) {\n                time = 0;\n            }\n\n            plyr.secs = parseInt(time % 60);\n            plyr.mins = parseInt((time / 60) % 60);\n            plyr.hours = parseInt(((time / 60) / 60) % 60);\n\n            // Do we need to display hours?\n            var displayHours = (parseInt(((_getDuration() / 60) / 60) % 60) > 0);\n\n            // Ensure it's two digits. For example, 03 rather than 3.\n            plyr.secs = ('0' + plyr.secs).slice(-2);\n            plyr.mins = ('0' + plyr.mins).slice(-2);\n\n            // Render\n            element.innerHTML = (displayHours ? plyr.hours + ':' : '') + plyr.mins + ':' + plyr.secs;\n        }\n\n        // Show the duration on metadataloaded\n        function _displayDuration() {\n            if (!plyr.supported.full) {\n                return;\n            }\n\n            // Determine duration\n            var duration = _getDuration() || 0;\n\n            // If there's only one time display, display duration there\n            if (!plyr.duration && config.displayDuration && plyr.media.paused) {\n                _updateTimeDisplay(duration, plyr.currentTime);\n            }\n\n            // If there's a duration element, update content\n            if (plyr.duration) {\n                _updateTimeDisplay(duration, plyr.duration);\n            }\n\n            // Update the tooltip (if visible)\n            _updateSeekTooltip();\n        }\n\n        // Handle time change event\n        function _timeUpdate(event) {\n            // Duration\n            _updateTimeDisplay(plyr.media.currentTime, plyr.currentTime);\n\n            // Ignore updates while seeking\n            if (event && event.type === 'timeupdate' && plyr.media.seeking) {\n                return;\n            }\n\n            // Playing progress\n            _updateProgress(event);\n        }\n\n        // Update seek range and progress\n        function _updateSeekDisplay(time) {\n            // Default to 0\n            if (!_is.number(time)) {\n                time = 0;\n            }\n\n            var duration    = _getDuration(),\n                value       = _getPercentage(time, duration);\n\n            // Update progress\n            if (plyr.progress && plyr.progress.played) {\n                plyr.progress.played.value = value;\n            }\n\n            // Update seek range input\n            if (plyr.buttons && plyr.buttons.seek) {\n                plyr.buttons.seek.value = value;\n            }\n        }\n\n        // Update hover tooltip for seeking\n        function _updateSeekTooltip(event) {\n            var duration = _getDuration();\n\n            // Bail if setting not true\n            if (!config.tooltips.seek || !plyr.progress.container || duration === 0) {\n                return;\n            }\n\n            // Calculate percentage\n            var clientRect  = plyr.progress.container.getBoundingClientRect(),\n                percent     = 0,\n                visible     = config.classes.tooltip + '--visible';\n\n            // Determine percentage, if already visible\n            if (!event) {\n                if (_hasClass(plyr.progress.tooltip, visible)) {\n                    percent = plyr.progress.tooltip.style.left.replace('%', '');\n                } else {\n                    return;\n                }\n            } else {\n                percent = ((100 / clientRect.width) * (event.pageX - clientRect.left));\n            }\n\n            // Set bounds\n            if (percent < 0) {\n                percent = 0;\n            } else if (percent > 100) {\n                percent = 100;\n            }\n\n            // Display the time a click would seek to\n            _updateTimeDisplay(((duration / 100) * percent), plyr.progress.tooltip);\n\n            // Set position\n            plyr.progress.tooltip.style.left = percent + \"%\";\n\n            // Show/hide the tooltip\n            // If the event is a moues in/out and percentage is inside bounds\n            if (event && _inArray(['mouseenter', 'mouseleave'], event.type)) {\n                _toggleClass(plyr.progress.tooltip, visible, (event.type === 'mouseenter'));\n            }\n        }\n\n        // Show the player controls in fullscreen mode\n        function _toggleControls(toggle) {\n            // Don't hide if config says not to, it's audio, or not ready or loading\n            if (!config.hideControls || plyr.type === 'audio') {\n                return;\n            }\n\n            var delay = 0,\n                isEnterFullscreen = false,\n                show = toggle,\n                loading = _hasClass(plyr.container, config.classes.loading);\n\n            // Default to false if no boolean\n            if (!_is.boolean(toggle)) {\n                if (toggle && toggle.type) {\n                    // Is the enter fullscreen event\n                    isEnterFullscreen = (toggle.type === 'enterfullscreen');\n\n                    // Whether to show controls\n                    show = _inArray(['mousemove', 'touchstart', 'mouseenter', 'focus'], toggle.type);\n\n                    // Delay hiding on move events\n                    if (_inArray(['mousemove', 'touchmove'], toggle.type)) {\n                        delay = 2000;\n                    }\n\n                    // Delay a little more for keyboard users\n                    if (toggle.type === 'focus') {\n                        delay = 3000;\n                    }\n                } else {\n                    show = _hasClass(plyr.container, config.classes.hideControls);\n                }\n            }\n\n            // Clear timer every movement\n            window.clearTimeout(timers.hover);\n\n            // If the mouse is not over the controls, set a timeout to hide them\n            if (show || plyr.media.paused || loading) {\n                _toggleClass(plyr.container, config.classes.hideControls, false);\n\n                // Always show controls when paused or if touch\n                if (plyr.media.paused || loading) {\n                    return;\n                }\n\n                // Delay for hiding on touch\n                if (plyr.browser.isTouch) {\n                    delay = 3000;\n                }\n            }\n\n            // If toggle is false or if we're playing (regardless of toggle),\n            // then set the timer to hide the controls\n            if (!show || !plyr.media.paused) {\n                timers.hover = window.setTimeout(function() {\n                    // If the mouse is over the controls (and not entering fullscreen), bail\n                    if ((plyr.controls.pressed || plyr.controls.hover) && !isEnterFullscreen) {\n                        return;\n                    }\n\n                    _toggleClass(plyr.container, config.classes.hideControls, true);\n                }, delay);\n            }\n        }\n\n        // Add common function to retrieve media source\n        function _source(source) {\n            // If not null or undefined, parse it\n            if (!_is.undefined(source)) {\n                _updateSource(source);\n                return;\n            }\n\n            // Return the current source\n            var url;\n            switch(plyr.type) {\n                case 'youtube':\n                    url = plyr.embed.getVideoUrl();\n                    break;\n\n                case 'vimeo':\n                    plyr.embed.getVideoUrl.then(function (value) {\n                        url = value;\n                    });\n                    break;\n\n                case 'soundcloud':\n                    plyr.embed.getCurrentSound(function(object) {\n                        url = object.permalink_url;\n                    });\n                    break;\n\n                default:\n                    url = plyr.media.currentSrc;\n                    break;\n            }\n\n            return url || '';\n        }\n\n        // Update source\n        // Sources are not checked for support so be careful\n        function _updateSource(source) {\n            if (!_is.object(source) || !('sources' in source) || !source.sources.length) {\n                _warn('Invalid source format');\n                return;\n            }\n\n            // Remove ready class hook\n            _toggleClass(plyr.container, config.classes.ready, false);\n\n            // Pause playback\n            _pause();\n\n            // Update seek range and progress\n            _updateSeekDisplay();\n\n            // Reset buffer progress\n            _setProgress();\n\n            // Cancel current network requests\n            _cancelRequests();\n\n            // Setup new source\n            function setup() {\n                // Remove embed object\n                plyr.embed = null;\n\n                // Remove the old media\n                _remove(plyr.media);\n\n                // Remove video container\n                if (plyr.type === 'video' && plyr.videoContainer) {\n                    _remove(plyr.videoContainer);\n                }\n\n                // Reset class name\n                if (plyr.container) {\n                    plyr.container.removeAttribute('class');\n                }\n\n                // Set the type\n                if ('type' in source) {\n                    plyr.type = source.type;\n\n                    // Get child type for video (it might be an embed)\n                    if (plyr.type === 'video') {\n                        var firstSource = source.sources[0];\n\n                        if ('type' in firstSource && _inArray(config.types.embed, firstSource.type)) {\n                            plyr.type = firstSource.type;\n                        }\n                    }\n                }\n\n                // Check for support\n                plyr.supported = supported(plyr.type);\n\n                // Create new markup\n                switch(plyr.type) {\n                    case 'video':\n                        plyr.media = document.createElement('video');\n                        break;\n\n                    case 'audio':\n                        plyr.media = document.createElement('audio');\n                        break;\n\n                    case 'youtube':\n                    case 'vimeo':\n                    case 'soundcloud':\n                        plyr.media = document.createElement('div');\n                        plyr.embedId = source.sources[0].src;\n                        break;\n                }\n\n                // Inject the new element\n                _prependChild(plyr.container, plyr.media);\n\n                // Autoplay the new source?\n                if (_is.boolean(source.autoplay)) {\n                    config.autoplay = source.autoplay;\n                }\n\n                // Set attributes for audio and video\n                if (_inArray(config.types.html5, plyr.type)) {\n                    if (config.crossorigin) {\n                        plyr.media.setAttribute('crossorigin', '');\n                    }\n                    if (config.autoplay) {\n                        plyr.media.setAttribute('autoplay', '');\n                    }\n                    if ('poster' in source) {\n                        plyr.media.setAttribute('poster', source.poster);\n                    }\n                    if (config.loop) {\n                        plyr.media.setAttribute('loop', '');\n                    }\n                }\n\n                // Restore class hooks\n                _toggleClass(plyr.container, config.classes.fullscreen.active, plyr.isFullscreen);\n                _toggleClass(plyr.container, config.classes.captions.active, plyr.captionsEnabled);\n                _toggleStyleHook();\n\n                // Set new sources for html5\n                if (_inArray(config.types.html5, plyr.type)) {\n                    _insertChildElements('source', source.sources);\n                }\n\n                // Set up from scratch\n                _setupMedia();\n\n                // HTML5 stuff\n                if (_inArray(config.types.html5, plyr.type)) {\n                    // Setup captions\n                    if ('tracks' in source) {\n                        _insertChildElements('track', source.tracks);\n                    }\n\n                    // Load HTML5 sources\n                    plyr.media.load();\n                }\n\n                // If HTML5 or embed but not fully supported, setupInterface and call ready now\n                if (_inArray(config.types.html5, plyr.type) || (_inArray(config.types.embed, plyr.type) && !plyr.supported.full)) {\n                    // Setup interface\n                    _setupInterface();\n\n                    // Call ready\n                    _ready();\n                }\n\n                // Set aria title and iframe title\n                config.title = source.title;\n                _setTitle();\n            }\n\n            // Destroy instance adn wait for callback\n            // Vimeo throws a wobbly if you don't wait\n            _destroy(setup, false);\n        }\n\n        // Update poster\n        function _updatePoster(source) {\n            if (plyr.type === 'video') {\n                plyr.media.setAttribute('poster', source);\n            }\n        }\n\n        // Listen for control events\n        function _controlListeners() {\n            // IE doesn't support input event, so we fallback to change\n            var inputEvent = (plyr.browser.isIE ? 'change' : 'input');\n\n            // Click play/pause helper\n            function togglePlay() {\n                var play = _togglePlay();\n\n                // Determine which buttons\n                var trigger = plyr.buttons[play ? 'play' : 'pause'],\n                    target = plyr.buttons[play ? 'pause' : 'play'];\n\n                // Get the last play button to account for the large play button\n                if (target && target.length > 1) {\n                    target = target[target.length - 1];\n                } else {\n                    target = target[0];\n                }\n\n                // Setup focus and tab focus\n                if (target) {\n                    var hadTabFocus = _hasClass(trigger, config.classes.tabFocus);\n\n                    setTimeout(function() {\n                        target.focus();\n\n                        if (hadTabFocus) {\n                            _toggleClass(trigger, config.classes.tabFocus, false);\n                            _toggleClass(target, config.classes.tabFocus, true);\n                        }\n                    }, 100);\n                }\n            }\n\n            // Get the focused element\n            function getFocusElement() {\n                var focused = document.activeElement;\n\n                if (!focused || focused === document.body) {\n                    focused = null;\n                } else {\n                    focused = document.querySelector(':focus');\n                }\n\n                return focused;\n            }\n\n            // Get the key code for an event\n            function getKeyCode(event) {\n                return event.keyCode ? event.keyCode : event.which;\n            }\n\n            // Detect tab focus\n            function checkTabFocus(focused) {\n                for (var button in plyr.buttons) {\n                    var element = plyr.buttons[button];\n\n                    if (_is.nodeList(element)) {\n                        for (var i = 0; i < element.length; i++) {\n                            _toggleClass(element[i], config.classes.tabFocus, (element[i] === focused));\n                        }\n                    } else {\n                        _toggleClass(element, config.classes.tabFocus, (element === focused));\n                    }\n                }\n            }\n\n            // Keyboard shortcuts\n            if (config.keyboardShorcuts.focused) {\n                var last = null;\n\n                // Handle global presses\n                if (config.keyboardShorcuts.global) {\n                    _on(window, 'keydown keyup', function(event) {\n                        var code = getKeyCode(event),\n                        focused = getFocusElement(),\n                        allowed = [48,49,50,51,52,53,54,56,57,75,77,70,67],\n                        count   = get().length;\n\n                        // Only handle global key press if there's only one player\n                        // and the key is in the allowed keys\n                        // and if the focused element is not editable (e.g. text input)\n                        // and any that accept key input http://webaim.org/techniques/keyboard/\n                        if (count === 1 && _inArray(allowed, code) && (!_is.htmlElement(focused) || !_matches(focused, config.selectors.editable))) {\n                            handleKey(event);\n                        }\n                    });\n                }\n\n                // Handle presses on focused\n                _on(plyr.container, 'keydown keyup', handleKey);\n            }\n\n            function handleKey(event) {\n                var code = getKeyCode(event),\n                    pressed = event.type === 'keydown',\n                    held = pressed && code === last;\n\n                // If the event is bubbled from the media element\n                // Firefox doesn't get the keycode for whatever reason\n                if (!_is.number(code)) {\n                    return;\n                }\n\n                // Seek by the number keys\n                function seekByKey() {\n                    // Get current duration\n                    var duration = plyr.media.duration;\n\n                    // Bail if we have no duration set\n                    if (!_is.number(duration)) {\n                        return;\n                    }\n\n                    // Divide the max duration into 10th's and times by the number value\n                    _seek((duration / 10) * (code - 48));\n                }\n\n                // Handle the key on keydown\n                // Reset on keyup\n                if (pressed) {\n                    // Which keycodes should we prevent default\n                    var preventDefault = [48,49,50,51,52,53,54,56,57,32,75,38,40,77,39,37,70,67];\n\n                    // If the code is found prevent default (e.g. prevent scrolling for arrows)\n                    if (_inArray(preventDefault, code)) {\n                        event.preventDefault();\n                        event.stopPropagation();\n                    }\n\n                    switch(code) {\n                        // 0-9\n                        case 48:\n                        case 49:\n                        case 50:\n                        case 51:\n                        case 52:\n                        case 53:\n                        case 54:\n                        case 55:\n                        case 56:\n                        case 57: if (!held) { seekByKey(); } break;\n                        // Space and K key\n                        case 32:\n                        case 75: if (!held) { _togglePlay(); } break;\n                        // Arrow up\n                        case 38: _increaseVolume(); break;\n                        // Arrow down\n                        case 40: _decreaseVolume(); break;\n                        // M key\n                        case 77: if (!held) { _toggleMute() } break;\n                        // Arrow forward\n                        case 39: _forward(); break;\n                        // Arrow back\n                        case 37: _rewind(); break;\n                        // F key\n                        case 70: _toggleFullscreen(); break;\n                        // C key\n                        case 67: if (!held) { _toggleCaptions(); } break;\n                    }\n\n                    // Escape is handle natively when in full screen\n                    // So we only need to worry about non native\n                    if (!fullscreen.supportsFullScreen && plyr.isFullscreen && code === 27) {\n                        _toggleFullscreen();\n                    }\n\n                    // Store last code for next cycle\n                    last = code;\n                } else {\n                    last = null;\n                }\n            }\n\n            // Focus/tab management\n            _on(window, 'keyup', function(event) {\n                var code = getKeyCode(event),\n                    focused = getFocusElement();\n\n                if (code === 9) {\n                    checkTabFocus(focused);\n                }\n            });\n            _on(document.body, 'click', function() {\n                _toggleClass(_getElement('.' + config.classes.tabFocus), config.classes.tabFocus, false);\n            });\n            for (var button in plyr.buttons) {\n                var element = plyr.buttons[button];\n\n                _on(element, 'blur', function() {\n                    _toggleClass(element, 'tab-focus', false);\n                });\n            }\n\n            // Play\n            _proxyListener(plyr.buttons.play, 'click', config.listeners.play, togglePlay);\n\n            // Pause\n            _proxyListener(plyr.buttons.pause, 'click', config.listeners.pause, togglePlay);\n\n            // Restart\n            _proxyListener(plyr.buttons.restart, 'click', config.listeners.restart, _seek);\n\n            // Rewind\n            _proxyListener(plyr.buttons.rewind, 'click', config.listeners.rewind, _rewind);\n\n            // Fast forward\n            _proxyListener(plyr.buttons.forward, 'click', config.listeners.forward, _forward);\n\n            // Seek\n            _proxyListener(plyr.buttons.seek, inputEvent, config.listeners.seek, _seek);\n\n            // Set volume\n            _proxyListener(plyr.volume.input, inputEvent, config.listeners.volume, function() {\n                _setVolume(plyr.volume.input.value);\n            });\n\n            // Mute\n            _proxyListener(plyr.buttons.mute, 'click', config.listeners.mute, _toggleMute);\n\n            // Fullscreen\n            _proxyListener(plyr.buttons.fullscreen, 'click', config.listeners.fullscreen, _toggleFullscreen);\n\n            // Handle user exiting fullscreen by escaping etc\n            if (fullscreen.supportsFullScreen) {\n                _on(document, fullscreen.fullScreenEventName, _toggleFullscreen);\n            }\n\n            // Captions\n            _on(plyr.buttons.captions, 'click', _toggleCaptions);\n\n            // Seek tooltip\n            _on(plyr.progress.container, 'mouseenter mouseleave mousemove', _updateSeekTooltip);\n\n            // Toggle controls visibility based on mouse movement\n            if (config.hideControls) {\n                // Toggle controls on mouse events and entering fullscreen\n                _on(plyr.container, 'mouseenter mouseleave mousemove touchstart touchend touchcancel touchmove enterfullscreen', _toggleControls);\n\n                // Watch for cursor over controls so they don't hide when trying to interact\n                _on(plyr.controls, 'mouseenter mouseleave', function(event) {\n                    plyr.controls.hover = event.type === 'mouseenter';\n                });\n\n                 // Watch for cursor over controls so they don't hide when trying to interact\n                _on(plyr.controls, 'mousedown mouseup touchstart touchend touchcancel', function(event) {\n                    plyr.controls.pressed = _inArray(['mousedown', 'touchstart'], event.type);\n                });\n\n                // Focus in/out on controls\n                _on(plyr.controls, 'focus blur', _toggleControls, true);\n            }\n\n            // Adjust volume on scroll\n            _on(plyr.volume.input, 'wheel', function(event) {\n                event.preventDefault();\n\n                // Detect \"natural\" scroll - suppored on OS X Safari only\n                // Other browsers on OS X will be inverted until support improves\n                var inverted = event.webkitDirectionInvertedFromDevice,\n                    step = (config.volumeStep / 5);\n\n                // Scroll down (or up on natural) to decrease\n                if (event.deltaY < 0 || event.deltaX > 0) {\n                    if (inverted) {\n                        _decreaseVolume(step);\n                    } else {\n                        _increaseVolume(step);\n                    }\n                }\n\n                // Scroll up (or down on natural) to increase\n                if (event.deltaY > 0 || event.deltaX < 0) {\n                    if (inverted) {\n                        _increaseVolume(step);\n                    } else {\n                        _decreaseVolume(step);\n                    }\n                }\n            });\n        }\n\n        // Listen for media events\n        function _mediaListeners() {\n            // Time change on media\n            _on(plyr.media, 'timeupdate seeking', _timeUpdate);\n\n            // Update manual captions\n            _on(plyr.media, 'timeupdate', _seekManualCaptions);\n\n            // Display duration\n            _on(plyr.media, 'durationchange loadedmetadata', _displayDuration);\n\n            // Handle the media finishing\n            _on(plyr.media, 'ended', function() {\n                // Show poster on end\n                if (plyr.type === 'video' && config.showPosterOnEnd) {\n                    // Clear\n                    if (plyr.type === 'video') {\n                        _setCaption();\n                    }\n\n                    // Restart\n                    _seek();\n\n                    // Re-load media\n                    plyr.media.load();\n                }\n            });\n\n            // Check for buffer progress\n            _on(plyr.media, 'progress playing', _updateProgress);\n\n            // Handle native mute\n            _on(plyr.media, 'volumechange', _updateVolume);\n\n            // Handle native play/pause\n            _on(plyr.media, 'play pause ended', _checkPlaying);\n\n            // Loading\n            _on(plyr.media, 'waiting canplay seeked', _checkLoading);\n\n            // Click video\n            if (config.clickToPlay && plyr.type !== 'audio') {\n                // Re-fetch the wrapper\n                var wrapper = _getElement('.' + config.classes.videoWrapper);\n\n                // Bail if there's no wrapper (this should never happen)\n                if (!wrapper) {\n                    return;\n                }\n\n                // Set cursor\n                wrapper.style.cursor = \"pointer\";\n\n                // On click play, pause ore restart\n                _on(wrapper, 'click', function() {\n                    // Touch devices will just show controls (if we're hiding controls)\n                    if (config.hideControls && plyr.browser.isTouch && !plyr.media.paused) {\n                        return;\n                    }\n\n                    if (plyr.media.paused) {\n                        _play();\n                    } else if (plyr.media.ended) {\n                        _seek();\n                        _play();\n                    } else {\n                        _pause();\n                    }\n                });\n            }\n\n            // Disable right click\n            if (config.disableContextMenu) {\n                _on(plyr.media, 'contextmenu', function(event) { event.preventDefault(); });\n            }\n\n            // Proxy events to container\n            // Bubble up key events for Edge\n            _on(plyr.media, config.events.concat(['keyup', 'keydown']).join(' '), function(event) {\n                _triggerEvent(plyr.container, event.type, true);\n            });\n        }\n\n        // Cancel current network requests\n        // See https://github.com/Selz/plyr/issues/174\n        function _cancelRequests() {\n            if (!_inArray(config.types.html5, plyr.type)) {\n                return;\n            }\n\n            // Remove child sources\n            var sources = plyr.media.querySelectorAll('source');\n            for (var i = 0; i < sources.length; i++) {\n                _remove(sources[i]);\n            }\n\n            // Set blank video src attribute\n            // This is to prevent a MEDIA_ERR_SRC_NOT_SUPPORTED error\n            // Info: http://stackoverflow.com/questions/32231579/how-to-properly-dispose-of-an-html5-video-and-close-socket-or-connection\n            plyr.media.setAttribute('src', 'https://cdn.selz.com/plyr/blank.mp4');\n\n            // Load the new empty source\n            // This will cancel existing requests\n            // See https://github.com/Selz/plyr/issues/174\n            plyr.media.load();\n\n            // Debugging\n            _log('Cancelled network requests');\n        }\n\n        // Destroy an instance\n        // Event listeners are removed when elements are removed\n        // http://stackoverflow.com/questions/12528049/if-a-dom-element-is-removed-are-its-listeners-also-removed-from-memory\n        function _destroy(callback, restore) {\n            // Bail if the element is not initialized\n            if (!plyr.init) {\n                return null;\n            }\n\n            // Type specific stuff\n            switch (plyr.type) {\n                case 'youtube':\n                    // Clear timers\n                    window.clearInterval(timers.buffering);\n                    window.clearInterval(timers.playing);\n\n                    // Destroy YouTube API\n                    plyr.embed.destroy();\n\n                    // Clean up\n                    cleanUp();\n\n                    break;\n\n                case 'vimeo':\n                    // Destroy Vimeo API\n                    // then clean up (wait, to prevent postmessage errors)\n                    plyr.embed.unload().then(cleanUp);\n\n                    // Vimeo does not always return\n                    timers.cleanUp = window.setTimeout(cleanUp, 200);\n\n                    break;\n\n                case 'video':\n                case 'audio':\n                    // Restore native video controls\n                    _toggleNativeControls(true);\n\n                    // Clean up\n                    cleanUp();\n\n                    break;\n            }\n\n            function cleanUp() {\n                clearTimeout(timers.cleanUp);\n\n                // Default to restore original element\n                if (!_is.boolean(restore)) {\n                    restore = true;\n                }\n\n                // Callback\n                if (_is.function(callback)) {\n                    callback.call(original);\n                }\n\n                // Bail if we don't need to restore the original element\n                if (!restore) {\n                    return;\n                }\n\n                // Remove init flag\n                plyr.init = false;\n\n                // Replace the container with the original element provided\n                plyr.container.parentNode.replaceChild(original, plyr.container);\n\n                // Allow overflow (set on fullscreen)\n                document.body.style.overflow = '';\n\n                // Event\n                _triggerEvent(original, 'destroyed', true);\n            }\n        }\n\n        // Setup a player\n        function _init() {\n            // Bail if the element is initialized\n            if (plyr.init) {\n                return null;\n            }\n\n            // Setup the fullscreen api\n            fullscreen = _fullscreen();\n\n            // Sniff out the browser\n            plyr.browser = _browserSniff();\n\n            // Bail if nothing to setup\n            if (!_is.htmlElement(plyr.media)) {\n                return;\n            }\n\n            // Load saved settings from localStorage\n            _setupStorage();\n\n            // Set media type based on tag or data attribute\n            // Supported: video, audio, vimeo, youtube\n            var tagName = media.tagName.toLowerCase();\n            if (tagName === 'div') {\n                plyr.type     = media.getAttribute('data-type');\n                plyr.embedId  = media.getAttribute('data-video-id');\n\n                // Clean up\n                media.removeAttribute('data-type');\n                media.removeAttribute('data-video-id');\n            } else {\n                plyr.type           = tagName;\n                config.crossorigin  = (media.getAttribute('crossorigin') !== null);\n                config.autoplay     = (config.autoplay || (media.getAttribute('autoplay') !== null));\n                config.loop         = (config.loop || (media.getAttribute('loop') !== null));\n            }\n\n            // Check for support\n            plyr.supported = supported(plyr.type);\n\n            // If no native support, bail\n            if (!plyr.supported.basic) {\n                return;\n            }\n\n            // Wrap media\n            plyr.container = _wrap(media, document.createElement('div'));\n\n            // Allow focus to be captured\n            plyr.container.setAttribute('tabindex', 0);\n\n            // Add style hook\n            _toggleStyleHook();\n\n            // Debug info\n            _log('' + plyr.browser.name + ' ' + plyr.browser.version);\n\n            // Setup media\n            _setupMedia();\n\n            // Setup interface\n            // If embed but not fully supported, setupInterface (to avoid flash of controls) and call ready now\n            if (_inArray(config.types.html5, plyr.type) || (_inArray(config.types.embed, plyr.type) && !plyr.supported.full)) {\n                // Setup UI\n                _setupInterface();\n\n                // Call ready\n                _ready();\n\n                // Set title on button and frame\n                _setTitle();\n            }\n\n            // Successful setup\n            plyr.init = true;\n        }\n\n        // Setup the UI\n        function _setupInterface() {\n            // Don't setup interface if no support\n            if (!plyr.supported.full) {\n                _warn('Basic support only', plyr.type);\n\n                // Remove controls\n                _remove(_getElement(config.selectors.controls.wrapper));\n\n                // Remove large play\n                _remove(_getElement(config.selectors.buttons.play));\n\n                // Restore native controls\n                _toggleNativeControls(true);\n\n                // Bail\n                return;\n            }\n\n            // Inject custom controls if not present\n            var controlsMissing = !_getElements(config.selectors.controls.wrapper).length;\n            if (controlsMissing) {\n                // Inject custom controls\n                _injectControls();\n            }\n\n            // Find the elements\n            if (!_findElements()) {\n                return;\n            }\n\n            // If the controls are injected, re-bind listeners for controls\n            if (controlsMissing) {\n                _controlListeners();\n            }\n\n            // Media element listeners\n            _mediaListeners();\n\n            // Remove native controls\n            _toggleNativeControls();\n\n            // Setup fullscreen\n            _setupFullscreen();\n\n            // Captions\n            _setupCaptions();\n\n            // Set volume\n            _setVolume();\n            _updateVolume();\n\n            // Reset time display\n            _timeUpdate();\n\n            // Update the UI\n            _checkPlaying();\n        }\n\n        api = {\n            getOriginal:        function() { return original; },\n            getContainer:       function() { return plyr.container },\n            getEmbed:           function() { return plyr.embed; },\n            getMedia:           function() { return plyr.media; },\n            getType:            function() { return plyr.type; },\n            getDuration:        _getDuration,\n            getCurrentTime:     function() { return plyr.media.currentTime; },\n            getVolume:          function() { return plyr.media.volume; },\n            isMuted:            function() { return plyr.media.muted; },\n            isReady:            function() { return _hasClass(plyr.container, config.classes.ready); },\n            isLoading:          function() { return _hasClass(plyr.container, config.classes.loading); },\n            isPaused:           function() { return plyr.media.paused; },\n            on:                 function(event, callback) { _on(plyr.container, event, callback); return this; },\n            play:               _play,\n            pause:              _pause,\n            stop:               function() { _pause(); _seek(); },\n            restart:            _seek,\n            rewind:             _rewind,\n            forward:            _forward,\n            seek:               _seek,\n            source:             _source,\n            poster:             _updatePoster,\n            setVolume:          _setVolume,\n            togglePlay:         _togglePlay,\n            toggleMute:         _toggleMute,\n            toggleCaptions:     _toggleCaptions,\n            toggleFullscreen:   _toggleFullscreen,\n            toggleControls:     _toggleControls,\n            isFullscreen:       function() { return plyr.isFullscreen || false; },\n            support:            function(mimeType) { return _supportMime(plyr, mimeType); },\n            destroy:            _destroy\n        };\n\n        // Everything done\n        function _ready() {\n            // Ready event at end of execution stack\n            window.setTimeout(function() {\n                _triggerEvent(plyr.media, 'ready');\n            }, 0);\n\n            // Set class hook on media element\n            _toggleClass(plyr.media, defaults.classes.setup, true);\n\n            // Set container class for ready\n            _toggleClass(plyr.container, config.classes.ready, true);\n\n            // Store a refernce to instance\n            plyr.media.plyr = api;\n\n            // Autoplay\n            if (config.autoplay) {\n                _play();\n            }\n        }\n\n        // Initialize instance\n        _init();\n\n        // If init failed, return null\n        if (!plyr.init) {\n            return null;\n        }\n\n        return api;\n    }\n\n    // Load a sprite\n    function loadSprite(url, id) {\n        var x = new XMLHttpRequest();\n\n        // If the id is set and sprite exists, bail\n        if (_is.string(id) && _is.htmlElement(document.querySelector('#' + id))) {\n            return;\n        }\n\n        // Create placeholder (to prevent loading twice)\n        var container = document.createElement('div');\n        container.setAttribute('hidden', '');\n        if (_is.string(id)) {\n            container.setAttribute('id', id);\n        }\n        document.body.insertBefore(container, document.body.childNodes[0]);\n\n        // Check for CORS support\n        if ('withCredentials' in x) {\n            x.open('GET', url, true);\n        } else {\n            return;\n        }\n\n        // Inject hidden div with sprite on load\n        x.onload = function() {\n            container.innerHTML = x.responseText;\n        }\n\n        x.send();\n    }\n\n    // Check for support\n    function supported(type) {\n        var browser     = _browserSniff(),\n            isOldIE     = (browser.isIE && browser.version <= 9),\n            isIos       = browser.isIos,\n            isIphone    = browser.isIphone,\n            audioSupport = !!document.createElement('audio').canPlayType,\n            videoSupport = !!document.createElement('video').canPlayType,\n            basic       = false,\n            full        = false;\n\n        switch (type) {\n            case 'video':\n                basic = videoSupport;\n                full  = (basic && (!isOldIE && !isIphone));\n                break;\n\n            case 'audio':\n                basic = audioSupport;\n                full  = (basic && !isOldIE);\n                break;\n\n            // Vimeo does not seem to be supported on iOS via API\n            // Issue raised https://github.com/vimeo/player.js/issues/87\n            case 'vimeo':\n                basic = true;\n                full = (!isOldIE && !isIos);\n                break;\n\n            case 'youtube':\n                basic = true;\n                full = (!isOldIE && !isIos);\n\n                // YouTube seems to work on iOS 10+ on iPad\n                if (isIos && !isIphone && browser.version >= 10) {\n                    full = true;\n                }\n\n                break;\n\n            case 'soundcloud':\n                basic = true;\n                full  = (!isOldIE && !isIphone);\n                break;\n\n            default:\n                basic = (audioSupport && videoSupport);\n                full  = (basic && !isOldIE);\n        }\n\n        return {\n            basic:  basic,\n            full:   full\n        };\n    }\n\n    // Setup function\n    function setup(targets, options) {\n        // Get the players\n        var players     = [],\n            instances   = [],\n            selector    = [defaults.selectors.html5, defaults.selectors.embed].join(',');\n\n        // Select the elements\n        if (_is.string(targets)) {\n            // String selector passed\n            targets = document.querySelectorAll(targets);\n        }  else if (_is.htmlElement(targets)) {\n            // Single HTMLElement passed\n            targets = [targets];\n        }  else if (!_is.nodeList(targets) && !_is.array(targets) && !_is.string(targets))  {\n            // No selector passed, possibly options as first argument\n            // If options are the first argument\n            if (_is.undefined(options) && _is.object(targets)) {\n                options = targets;\n            }\n\n            // Use default selector\n            targets = document.querySelectorAll(selector);\n        }\n\n        // Convert NodeList to array\n        if (_is.nodeList(targets)) {\n            targets = Array.prototype.slice.call(targets);\n        }\n\n        // Bail if disabled or no basic support\n        // You may want to disable certain UAs etc\n        if (!supported().basic || !targets.length) {\n            return false;\n        }\n\n        // Add to container list\n        function add(target, media) {\n            if (!_hasClass(media, defaults.classes.hook)) {\n                players.push({\n                    // Always wrap in a <div> for styling\n                    //container:  _wrap(media, document.createElement('div')),\n                    // Could be a container or the media itself\n                    target:     target,\n                    // This should be the <video>, <audio> or <div> (YouTube/Vimeo)\n                    media:      media\n                });\n            }\n        }\n\n        // Check if the targets have multiple media elements\n        for (var i = 0; i < targets.length; i++) {\n            var target = targets[i];\n\n            // Get children\n            var children = target.querySelectorAll(selector);\n\n            // If there's more than one media element child, wrap them\n            if (children.length) {\n                for (var x = 0; x < children.length; x++) {\n                    add(target, children[x]);\n                }\n            } else if (_matches(target, selector)) {\n                // Target is media element\n                add(target, target);\n            }\n        }\n\n        // Create a player instance for each element\n        players.forEach(function(player) {\n            var element     = player.target,\n                media       = player.media,\n                match       = false;\n\n            // The target element can also be the media element\n            if (media === element) {\n                match = true;\n            }\n\n            // Setup a player instance and add to the element\n            // Create instance-specific config\n            var data = {};\n\n            // Try parsing data attribute config\n            try { data = JSON.parse(element.getAttribute('data-plyr')); }\n            catch(e) { }\n\n            var config = _extend({}, defaults, options, data);\n\n            // Bail if not enabled\n            if (!config.enabled) {\n                return null;\n            }\n\n            // Create new instance\n            var instance = new Plyr(media, config);\n\n            // Go to next if setup failed\n            if (!_is.object(instance)) {\n                return;\n            }\n\n            // Listen for events if debugging\n            if (config.debug) {\n                var events = config.events.concat(['setup', 'statechange', 'enterfullscreen', 'exitfullscreen', 'captionsenabled', 'captionsdisabled']);\n\n                _on(instance.getContainer(), events.join(' '), function(event) {\n                    console.log([config.logPrefix, 'event:', event.type].join(' '), event.detail.plyr);\n                });\n            }\n\n            // Callback\n            _event(instance.getContainer(), 'setup', true, {\n                plyr: instance\n            });\n\n            // Add to return array even if it's already setup\n            instances.push(instance);\n        });\n\n        return instances;\n    }\n\n    // Get all instances within a provided container\n    function get(container) {\n        if (_is.string(container)) {\n            // Get selector if string passed\n            container = document.querySelector(container);\n        } else if (_is.undefined(container)) {\n            // Use body by default to get all on page\n            container = document.body;\n        }\n\n        // If we have a HTML element\n        if (_is.htmlElement(container)) {\n            var elements = container.querySelectorAll('.' + defaults.classes.setup),\n                instances = [];\n\n            Array.prototype.slice.call(elements).forEach(function(element) {\n                if (_is.object(element.plyr)) {\n                    instances.push(element.plyr);\n                }\n            });\n\n            return instances;\n        }\n\n        return [];\n    }\n\n    return {\n        setup:      setup,\n        supported:  supported,\n        loadSprite: loadSprite,\n        get:        get\n    };\n}));\n\n// Custom event polyfill\n// https://developer.mozilla.org/en-US/docs/Web/API/CustomEvent/CustomEvent\n(function () {\n    if (typeof window.CustomEvent === 'function') {\n        return;\n    }\n\n    function CustomEvent(event, params) {\n        params = params || { bubbles: false, cancelable: false, detail: undefined };\n        var evt = document.createEvent('CustomEvent');\n        evt.initCustomEvent(event, params.bubbles, params.cancelable, params.detail);\n        return evt;\n    }\n\n    CustomEvent.prototype = window.Event.prototype;\n\n    window.CustomEvent = CustomEvent;\n})();\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNC5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL34vcGx5ci9zcmMvanMvcGx5ci5qcz85OWE0Il0sInNvdXJjZXNDb250ZW50IjpbIi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBQbHlyXG4vLyBwbHlyLmpzIHYyLjAuMTFcbi8vIGh0dHBzOi8vZ2l0aHViLmNvbS9zZWx6L3BseXJcbi8vIExpY2Vuc2U6IFRoZSBNSVQgTGljZW5zZSAoTUlUKVxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIENyZWRpdHM6IGh0dHA6Ly9wYXlwYWwuZ2l0aHViLmlvL2FjY2Vzc2libGUtaHRtbDUtdmlkZW8tcGxheWVyL1xuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuOyhmdW5jdGlvbihyb290LCBmYWN0b3J5KSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuICAgIC8qZ2xvYmFsIGRlZmluZSxtb2R1bGUqL1xuXG4gICAgaWYgKHR5cGVvZiBtb2R1bGUgPT09ICdvYmplY3QnICYmIHR5cGVvZiBtb2R1bGUuZXhwb3J0cyA9PT0gJ29iamVjdCcpIHtcbiAgICAgICAgLy8gTm9kZSwgQ29tbW9uSlMtbGlrZVxuICAgICAgICBtb2R1bGUuZXhwb3J0cyA9IGZhY3Rvcnkocm9vdCwgZG9jdW1lbnQpO1xuICAgIH0gZWxzZSBpZiAodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKSB7XG4gICAgICAgIC8vIEFNRFxuICAgICAgICBkZWZpbmUoW10sIGZ1bmN0aW9uICgpIHsgcmV0dXJuIGZhY3Rvcnkocm9vdCwgZG9jdW1lbnQpOyB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgICAvLyBCcm93c2VyIGdsb2JhbHMgKHJvb3QgaXMgd2luZG93KVxuICAgICAgICByb290LnBseXIgPSBmYWN0b3J5KHJvb3QsIGRvY3VtZW50KTtcbiAgICB9XG59KHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnID8gd2luZG93IDogdGhpcywgZnVuY3Rpb24od2luZG93LCBkb2N1bWVudCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIC8vIEdsb2JhbHNcbiAgICB2YXIgZnVsbHNjcmVlbixcbiAgICBzY3JvbGwgPSB7IHg6IDAsIHk6IDAgfSxcblxuICAgIC8vIERlZmF1bHQgY29uZmlnXG4gICAgZGVmYXVsdHMgPSB7XG4gICAgICAgIGVuYWJsZWQ6ICAgICAgICAgICAgICAgIHRydWUsXG4gICAgICAgIGRlYnVnOiAgICAgICAgICAgICAgICAgIGZhbHNlLFxuICAgICAgICBhdXRvcGxheTogICAgICAgICAgICAgICBmYWxzZSxcbiAgICAgICAgbG9vcDogICAgICAgICAgICAgICAgICAgZmFsc2UsXG4gICAgICAgIHNlZWtUaW1lOiAgICAgICAgICAgICAgIDEwLFxuICAgICAgICB2b2x1bWU6ICAgICAgICAgICAgICAgICAxMCxcbiAgICAgICAgdm9sdW1lTWluOiAgICAgICAgICAgICAgMCxcbiAgICAgICAgdm9sdW1lTWF4OiAgICAgICAgICAgICAgMTAsXG4gICAgICAgIHZvbHVtZVN0ZXA6ICAgICAgICAgICAgIDEsXG4gICAgICAgIGR1cmF0aW9uOiAgICAgICAgICAgICAgIG51bGwsXG4gICAgICAgIGRpc3BsYXlEdXJhdGlvbjogICAgICAgIHRydWUsXG4gICAgICAgIGxvYWRTcHJpdGU6ICAgICAgICAgICAgIHRydWUsXG4gICAgICAgIGljb25QcmVmaXg6ICAgICAgICAgICAgICdwbHlyJyxcbiAgICAgICAgaWNvblVybDogICAgICAgICAgICAgICAgJ2h0dHBzOi8vY2RuLnBseXIuaW8vMi4wLjExL3BseXIuc3ZnJyxcbiAgICAgICAgY2xpY2tUb1BsYXk6ICAgICAgICAgICAgdHJ1ZSxcbiAgICAgICAgaGlkZUNvbnRyb2xzOiAgICAgICAgICAgdHJ1ZSxcbiAgICAgICAgc2hvd1Bvc3Rlck9uRW5kOiAgICAgICAgZmFsc2UsXG4gICAgICAgIGRpc2FibGVDb250ZXh0TWVudTogICAgIHRydWUsXG4gICAgICAgIGtleWJvYXJkU2hvcmN1dHM6ICAgICAgIHtcbiAgICAgICAgICAgIGZvY3VzZWQ6ICAgICAgICAgICAgdHJ1ZSxcbiAgICAgICAgICAgIGdsb2JhbDogICAgICAgICAgICAgZmFsc2VcbiAgICAgICAgfSxcbiAgICAgICAgdG9vbHRpcHM6IHtcbiAgICAgICAgICAgIGNvbnRyb2xzOiAgICAgICAgICAgZmFsc2UsXG4gICAgICAgICAgICBzZWVrOiAgICAgICAgICAgICAgIHRydWVcbiAgICAgICAgfSxcbiAgICAgICAgc2VsZWN0b3JzOiB7XG4gICAgICAgICAgICBodG1sNTogICAgICAgICAgICAgICd2aWRlbywgYXVkaW8nLFxuICAgICAgICAgICAgZW1iZWQ6ICAgICAgICAgICAgICAnW2RhdGEtdHlwZV0nLFxuICAgICAgICAgICAgZWRpdGFibGU6ICAgICAgICAgICAnaW5wdXQsIHRleHRhcmVhLCBzZWxlY3QsIFtjb250ZW50ZWRpdGFibGVdJyxcbiAgICAgICAgICAgIGNvbnRhaW5lcjogICAgICAgICAgJy5wbHlyJyxcbiAgICAgICAgICAgIGNvbnRyb2xzOiB7XG4gICAgICAgICAgICAgICAgY29udGFpbmVyOiAgICAgIG51bGwsXG4gICAgICAgICAgICAgICAgd3JhcHBlcjogICAgICAgICcucGx5cl9fY29udHJvbHMnXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgbGFiZWxzOiAgICAgICAgICAgICAnW2RhdGEtcGx5cl0nLFxuICAgICAgICAgICAgYnV0dG9uczoge1xuICAgICAgICAgICAgICAgIHNlZWs6ICAgICAgICAgICAnW2RhdGEtcGx5cj1cInNlZWtcIl0nLFxuICAgICAgICAgICAgICAgIHBsYXk6ICAgICAgICAgICAnW2RhdGEtcGx5cj1cInBsYXlcIl0nLFxuICAgICAgICAgICAgICAgIHBhdXNlOiAgICAgICAgICAnW2RhdGEtcGx5cj1cInBhdXNlXCJdJyxcbiAgICAgICAgICAgICAgICByZXN0YXJ0OiAgICAgICAgJ1tkYXRhLXBseXI9XCJyZXN0YXJ0XCJdJyxcbiAgICAgICAgICAgICAgICByZXdpbmQ6ICAgICAgICAgJ1tkYXRhLXBseXI9XCJyZXdpbmRcIl0nLFxuICAgICAgICAgICAgICAgIGZvcndhcmQ6ICAgICAgICAnW2RhdGEtcGx5cj1cImZhc3QtZm9yd2FyZFwiXScsXG4gICAgICAgICAgICAgICAgbXV0ZTogICAgICAgICAgICdbZGF0YS1wbHlyPVwibXV0ZVwiXScsXG4gICAgICAgICAgICAgICAgY2FwdGlvbnM6ICAgICAgICdbZGF0YS1wbHlyPVwiY2FwdGlvbnNcIl0nLFxuICAgICAgICAgICAgICAgIGZ1bGxzY3JlZW46ICAgICAnW2RhdGEtcGx5cj1cImZ1bGxzY3JlZW5cIl0nXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgdm9sdW1lOiB7XG4gICAgICAgICAgICAgICAgaW5wdXQ6ICAgICAgICAgICdbZGF0YS1wbHlyPVwidm9sdW1lXCJdJyxcbiAgICAgICAgICAgICAgICBkaXNwbGF5OiAgICAgICAgJy5wbHlyX192b2x1bWUtLWRpc3BsYXknXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcHJvZ3Jlc3M6IHtcbiAgICAgICAgICAgICAgICBjb250YWluZXI6ICAgICAgJy5wbHlyX19wcm9ncmVzcycsXG4gICAgICAgICAgICAgICAgYnVmZmVyOiAgICAgICAgICcucGx5cl9fcHJvZ3Jlc3MtLWJ1ZmZlcicsXG4gICAgICAgICAgICAgICAgcGxheWVkOiAgICAgICAgICcucGx5cl9fcHJvZ3Jlc3MtLXBsYXllZCdcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBjYXB0aW9uczogICAgICAgICAgICcucGx5cl9fY2FwdGlvbnMnLFxuICAgICAgICAgICAgY3VycmVudFRpbWU6ICAgICAgICAnLnBseXJfX3RpbWUtLWN1cnJlbnQnLFxuICAgICAgICAgICAgZHVyYXRpb246ICAgICAgICAgICAnLnBseXJfX3RpbWUtLWR1cmF0aW9uJ1xuICAgICAgICB9LFxuICAgICAgICBjbGFzc2VzOiB7XG4gICAgICAgICAgICBzZXR1cDogICAgICAgICAgICAgICdwbHlyLS1zZXR1cCcsXG4gICAgICAgICAgICByZWFkeTogICAgICAgICAgICAgICdwbHlyLS1yZWFkeScsXG4gICAgICAgICAgICB2aWRlb1dyYXBwZXI6ICAgICAgICdwbHlyX192aWRlby13cmFwcGVyJyxcbiAgICAgICAgICAgIGVtYmVkV3JhcHBlcjogICAgICAgJ3BseXJfX3ZpZGVvLWVtYmVkJyxcbiAgICAgICAgICAgIHR5cGU6ICAgICAgICAgICAgICAgJ3BseXItLXswfScsXG4gICAgICAgICAgICBzdG9wcGVkOiAgICAgICAgICAgICdwbHlyLS1zdG9wcGVkJyxcbiAgICAgICAgICAgIHBsYXlpbmc6ICAgICAgICAgICAgJ3BseXItLXBsYXlpbmcnLFxuICAgICAgICAgICAgbXV0ZWQ6ICAgICAgICAgICAgICAncGx5ci0tbXV0ZWQnLFxuICAgICAgICAgICAgbG9hZGluZzogICAgICAgICAgICAncGx5ci0tbG9hZGluZycsXG4gICAgICAgICAgICBob3ZlcjogICAgICAgICAgICAgICdwbHlyLS1ob3ZlcicsXG4gICAgICAgICAgICB0b29sdGlwOiAgICAgICAgICAgICdwbHlyX190b29sdGlwJyxcbiAgICAgICAgICAgIGhpZGRlbjogICAgICAgICAgICAgJ3BseXJfX3NyLW9ubHknLFxuICAgICAgICAgICAgaGlkZUNvbnRyb2xzOiAgICAgICAncGx5ci0taGlkZS1jb250cm9scycsXG4gICAgICAgICAgICBpc0lvczogICAgICAgICAgICAgICdwbHlyLS1pcy1pb3MnLFxuICAgICAgICAgICAgaXNUb3VjaDogICAgICAgICAgICAncGx5ci0taXMtdG91Y2gnLFxuICAgICAgICAgICAgY2FwdGlvbnM6IHtcbiAgICAgICAgICAgICAgICBlbmFibGVkOiAgICAgICAgJ3BseXItLWNhcHRpb25zLWVuYWJsZWQnLFxuICAgICAgICAgICAgICAgIGFjdGl2ZTogICAgICAgICAncGx5ci0tY2FwdGlvbnMtYWN0aXZlJ1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGZ1bGxzY3JlZW46IHtcbiAgICAgICAgICAgICAgICBlbmFibGVkOiAgICAgICAgJ3BseXItLWZ1bGxzY3JlZW4tZW5hYmxlZCcsXG4gICAgICAgICAgICAgICAgYWN0aXZlOiAgICAgICAgICdwbHlyLS1mdWxsc2NyZWVuLWFjdGl2ZSdcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB0YWJGb2N1czogICAgICAgICAgICd0YWItZm9jdXMnXG4gICAgICAgIH0sXG4gICAgICAgIGNhcHRpb25zOiB7XG4gICAgICAgICAgICBkZWZhdWx0QWN0aXZlOiAgICAgIGZhbHNlXG4gICAgICAgIH0sXG4gICAgICAgIGZ1bGxzY3JlZW46IHtcbiAgICAgICAgICAgIGVuYWJsZWQ6ICAgICAgICAgICAgdHJ1ZSxcbiAgICAgICAgICAgIGZhbGxiYWNrOiAgICAgICAgICAgdHJ1ZSxcbiAgICAgICAgICAgIGFsbG93QXVkaW86ICAgICAgICAgZmFsc2VcbiAgICAgICAgfSxcbiAgICAgICAgc3RvcmFnZToge1xuICAgICAgICAgICAgZW5hYmxlZDogICAgICAgICAgICB0cnVlLFxuICAgICAgICAgICAga2V5OiAgICAgICAgICAgICAgICAncGx5cidcbiAgICAgICAgfSxcbiAgICAgICAgY29udHJvbHM6ICAgICAgICAgICAgICAgWydwbGF5LWxhcmdlJywgJ3BsYXknLCAncHJvZ3Jlc3MnLCAnY3VycmVudC10aW1lJywgJ211dGUnLCAndm9sdW1lJywgJ2NhcHRpb25zJywgJ2Z1bGxzY3JlZW4nXSxcbiAgICAgICAgaTE4bjoge1xuICAgICAgICAgICAgcmVzdGFydDogICAgICAgICAgICAnUmVzdGFydCcsXG4gICAgICAgICAgICByZXdpbmQ6ICAgICAgICAgICAgICdSZXdpbmQge3NlZWt0aW1lfSBzZWNzJyxcbiAgICAgICAgICAgIHBsYXk6ICAgICAgICAgICAgICAgJ1BsYXknLFxuICAgICAgICAgICAgcGF1c2U6ICAgICAgICAgICAgICAnUGF1c2UnLFxuICAgICAgICAgICAgZm9yd2FyZDogICAgICAgICAgICAnRm9yd2FyZCB7c2Vla3RpbWV9IHNlY3MnLFxuICAgICAgICAgICAgcGxheWVkOiAgICAgICAgICAgICAncGxheWVkJyxcbiAgICAgICAgICAgIGJ1ZmZlcmVkOiAgICAgICAgICAgJ2J1ZmZlcmVkJyxcbiAgICAgICAgICAgIGN1cnJlbnRUaW1lOiAgICAgICAgJ0N1cnJlbnQgdGltZScsXG4gICAgICAgICAgICBkdXJhdGlvbjogICAgICAgICAgICdEdXJhdGlvbicsXG4gICAgICAgICAgICB2b2x1bWU6ICAgICAgICAgICAgICdWb2x1bWUnLFxuICAgICAgICAgICAgdG9nZ2xlTXV0ZTogICAgICAgICAnVG9nZ2xlIE11dGUnLFxuICAgICAgICAgICAgdG9nZ2xlQ2FwdGlvbnM6ICAgICAnVG9nZ2xlIENhcHRpb25zJyxcbiAgICAgICAgICAgIHRvZ2dsZUZ1bGxzY3JlZW46ICAgJ1RvZ2dsZSBGdWxsc2NyZWVuJyxcbiAgICAgICAgICAgIGZyYW1lVGl0bGU6ICAgICAgICAgJ1BsYXllciBmb3Ige3RpdGxlfSdcbiAgICAgICAgfSxcbiAgICAgICAgdHlwZXM6IHtcbiAgICAgICAgICAgIGVtYmVkOiAgICAgICAgICAgICAgWyd5b3V0dWJlJywgJ3ZpbWVvJywgJ3NvdW5kY2xvdWQnXSxcbiAgICAgICAgICAgIGh0bWw1OiAgICAgICAgICAgICAgWyd2aWRlbycsICdhdWRpbyddXG4gICAgICAgIH0sXG4gICAgICAgIC8vIFVSTHNcbiAgICAgICAgdXJsczoge1xuICAgICAgICAgICAgdmltZW86IHtcbiAgICAgICAgICAgICAgICBhcGk6ICAgICAgICAgICAgJ2h0dHBzOi8vcGxheWVyLnZpbWVvLmNvbS9hcGkvcGxheWVyLmpzJyxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB5b3V0dWJlOiB7XG4gICAgICAgICAgICAgICAgYXBpOiAgICAgICAgICAgICdodHRwczovL3d3dy55b3V0dWJlLmNvbS9pZnJhbWVfYXBpJ1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHNvdW5kY2xvdWQ6IHtcbiAgICAgICAgICAgICAgICBhcGk6ICAgICAgICAgICAgJ2h0dHBzOi8vdy5zb3VuZGNsb3VkLmNvbS9wbGF5ZXIvYXBpLmpzJ1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICAvLyBDdXN0b20gY29udHJvbCBsaXN0ZW5lcnNcbiAgICAgICAgbGlzdGVuZXJzOiB7XG4gICAgICAgICAgICBzZWVrOiAgICAgICAgICAgICAgIG51bGwsXG4gICAgICAgICAgICBwbGF5OiAgICAgICAgICAgICAgIG51bGwsXG4gICAgICAgICAgICBwYXVzZTogICAgICAgICAgICAgIG51bGwsXG4gICAgICAgICAgICByZXN0YXJ0OiAgICAgICAgICAgIG51bGwsXG4gICAgICAgICAgICByZXdpbmQ6ICAgICAgICAgICAgIG51bGwsXG4gICAgICAgICAgICBmb3J3YXJkOiAgICAgICAgICAgIG51bGwsXG4gICAgICAgICAgICBtdXRlOiAgICAgICAgICAgICAgIG51bGwsXG4gICAgICAgICAgICB2b2x1bWU6ICAgICAgICAgICAgIG51bGwsXG4gICAgICAgICAgICBjYXB0aW9uczogICAgICAgICAgIG51bGwsXG4gICAgICAgICAgICBmdWxsc2NyZWVuOiAgICAgICAgIG51bGxcbiAgICAgICAgfSxcbiAgICAgICAgLy8gRXZlbnRzIHRvIHdhdGNoIG9uIEhUTUw1IG1lZGlhIGVsZW1lbnRzXG4gICAgICAgIGV2ZW50czogICAgICAgICAgICAgICAgIFsncmVhZHknLCAnZW5kZWQnLCAncHJvZ3Jlc3MnLCAnc3RhbGxlZCcsICdwbGF5aW5nJywgJ3dhaXRpbmcnLCAnY2FucGxheScsICdjYW5wbGF5dGhyb3VnaCcsICdsb2Fkc3RhcnQnLCAnbG9hZGVkZGF0YScsICdsb2FkZWRtZXRhZGF0YScsICd0aW1ldXBkYXRlJywgJ3ZvbHVtZWNoYW5nZScsICdwbGF5JywgJ3BhdXNlJywgJ2Vycm9yJywgJ3NlZWtpbmcnLCAnc2Vla2VkJywgJ2VtcHRpZWQnXSxcbiAgICAgICAgLy8gTG9nZ2luZ1xuICAgICAgICBsb2dQcmVmaXg6ICAgICAgICAgICAgICAnW1BseXJdJ1xuICAgIH07XG5cbiAgICAvLyBDcmVkaXRzOiBodHRwOi8vcGF5cGFsLmdpdGh1Yi5pby9hY2Nlc3NpYmxlLWh0bWw1LXZpZGVvLXBsYXllci9cbiAgICAvLyBVbmZvcnR1bmF0ZWx5LCBkdWUgdG8gbWl4ZWQgc3VwcG9ydCwgVUEgc25pZmZpbmcgaXMgcmVxdWlyZWRcbiAgICBmdW5jdGlvbiBfYnJvd3NlclNuaWZmKCkge1xuICAgICAgICB2YXIgdWEgPSBuYXZpZ2F0b3IudXNlckFnZW50LFxuICAgICAgICAgICAgbmFtZSA9IG5hdmlnYXRvci5hcHBOYW1lLFxuICAgICAgICAgICAgZnVsbFZlcnNpb24gPSAnJyArIHBhcnNlRmxvYXQobmF2aWdhdG9yLmFwcFZlcnNpb24pLFxuICAgICAgICAgICAgbWFqb3JWZXJzaW9uID0gcGFyc2VJbnQobmF2aWdhdG9yLmFwcFZlcnNpb24sIDEwKSxcbiAgICAgICAgICAgIG5hbWVPZmZzZXQsXG4gICAgICAgICAgICB2ZXJPZmZzZXQsXG4gICAgICAgICAgICBpeCxcbiAgICAgICAgICAgIGlzSUUgPSBmYWxzZSxcbiAgICAgICAgICAgIGlzRmlyZWZveCA9IGZhbHNlLFxuICAgICAgICAgICAgaXNDaHJvbWUgPSBmYWxzZSxcbiAgICAgICAgICAgIGlzU2FmYXJpID0gZmFsc2U7XG5cbiAgICAgICAgaWYgKChuYXZpZ2F0b3IuYXBwVmVyc2lvbi5pbmRleE9mKCdXaW5kb3dzIE5UJykgIT09IC0xKSAmJiAobmF2aWdhdG9yLmFwcFZlcnNpb24uaW5kZXhPZigncnY6MTEnKSAhPT0gLTEpKSB7XG4gICAgICAgICAgICAvLyBNU0lFIDExXG4gICAgICAgICAgICBpc0lFID0gdHJ1ZTtcbiAgICAgICAgICAgIG5hbWUgPSAnSUUnO1xuICAgICAgICAgICAgZnVsbFZlcnNpb24gPSAnMTEnO1xuICAgICAgICB9IGVsc2UgaWYgKCh2ZXJPZmZzZXQgPSB1YS5pbmRleE9mKCdNU0lFJykpICE9PSAtMSkge1xuICAgICAgICAgICAgLy8gTVNJRVxuICAgICAgICAgICAgaXNJRSA9IHRydWU7XG4gICAgICAgICAgICBuYW1lID0gJ0lFJztcbiAgICAgICAgICAgIGZ1bGxWZXJzaW9uID0gdWEuc3Vic3RyaW5nKHZlck9mZnNldCArIDUpO1xuICAgICAgICB9IGVsc2UgaWYgKCh2ZXJPZmZzZXQgPSB1YS5pbmRleE9mKCdDaHJvbWUnKSkgIT09IC0xKSB7XG4gICAgICAgICAgICAvLyBDaHJvbWVcbiAgICAgICAgICAgIGlzQ2hyb21lID0gdHJ1ZTtcbiAgICAgICAgICAgIG5hbWUgPSAnQ2hyb21lJztcbiAgICAgICAgICAgIGZ1bGxWZXJzaW9uID0gdWEuc3Vic3RyaW5nKHZlck9mZnNldCArIDcpO1xuICAgICAgICB9IGVsc2UgaWYgKCh2ZXJPZmZzZXQgPSB1YS5pbmRleE9mKCdTYWZhcmknKSkgIT09IC0xKSB7XG4gICAgICAgICAgICAvLyBTYWZhcmlcbiAgICAgICAgICAgIGlzU2FmYXJpID0gdHJ1ZTtcbiAgICAgICAgICAgIG5hbWUgPSAnU2FmYXJpJztcbiAgICAgICAgICAgIGZ1bGxWZXJzaW9uID0gdWEuc3Vic3RyaW5nKHZlck9mZnNldCArIDcpO1xuICAgICAgICAgICAgaWYgKCh2ZXJPZmZzZXQgPSB1YS5pbmRleE9mKCdWZXJzaW9uJykpICE9PSAtMSkge1xuICAgICAgICAgICAgICAgIGZ1bGxWZXJzaW9uID0gdWEuc3Vic3RyaW5nKHZlck9mZnNldCArIDgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKCh2ZXJPZmZzZXQgPSB1YS5pbmRleE9mKCdGaXJlZm94JykpICE9PSAtMSkge1xuICAgICAgICAgICAgLy8gRmlyZWZveFxuICAgICAgICAgICAgaXNGaXJlZm94ID0gdHJ1ZTtcbiAgICAgICAgICAgIG5hbWUgPSAnRmlyZWZveCc7XG4gICAgICAgICAgICBmdWxsVmVyc2lvbiA9IHVhLnN1YnN0cmluZyh2ZXJPZmZzZXQgKyA4KTtcbiAgICAgICAgfSBlbHNlIGlmICgobmFtZU9mZnNldCA9IHVhLmxhc3RJbmRleE9mKCcgJykgKyAxKSA8ICh2ZXJPZmZzZXQgPSB1YS5sYXN0SW5kZXhPZignLycpKSkge1xuICAgICAgICAgICAgLy8gSW4gbW9zdCBvdGhlciBicm93c2VycywgJ25hbWUvdmVyc2lvbicgaXMgYXQgdGhlIGVuZCBvZiB1c2VyQWdlbnRcbiAgICAgICAgICAgIG5hbWUgPSB1YS5zdWJzdHJpbmcobmFtZU9mZnNldCx2ZXJPZmZzZXQpO1xuICAgICAgICAgICAgZnVsbFZlcnNpb24gPSB1YS5zdWJzdHJpbmcodmVyT2Zmc2V0ICsgMSk7XG5cbiAgICAgICAgICAgIGlmIChuYW1lLnRvTG93ZXJDYXNlKCkgPT09IG5hbWUudG9VcHBlckNhc2UoKSkge1xuICAgICAgICAgICAgICAgIG5hbWUgPSBuYXZpZ2F0b3IuYXBwTmFtZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFRyaW0gdGhlIGZ1bGxWZXJzaW9uIHN0cmluZyBhdCBzZW1pY29sb24vc3BhY2UgaWYgcHJlc2VudFxuICAgICAgICBpZiAoKGl4ID0gZnVsbFZlcnNpb24uaW5kZXhPZignOycpKSAhPT0gLTEpIHtcbiAgICAgICAgICAgIGZ1bGxWZXJzaW9uID0gZnVsbFZlcnNpb24uc3Vic3RyaW5nKDAsIGl4KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoKGl4ID0gZnVsbFZlcnNpb24uaW5kZXhPZignICcpKSAhPT0gLTEpIHtcbiAgICAgICAgICAgIGZ1bGxWZXJzaW9uID0gZnVsbFZlcnNpb24uc3Vic3RyaW5nKDAsIGl4KTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEdldCBtYWpvciB2ZXJzaW9uXG4gICAgICAgIG1ham9yVmVyc2lvbiA9IHBhcnNlSW50KCcnICsgZnVsbFZlcnNpb24sIDEwKTtcbiAgICAgICAgaWYgKGlzTmFOKG1ham9yVmVyc2lvbikpIHtcbiAgICAgICAgICAgIGZ1bGxWZXJzaW9uID0gJycgKyBwYXJzZUZsb2F0KG5hdmlnYXRvci5hcHBWZXJzaW9uKTtcbiAgICAgICAgICAgIG1ham9yVmVyc2lvbiA9IHBhcnNlSW50KG5hdmlnYXRvci5hcHBWZXJzaW9uLCAxMCk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBSZXR1cm4gZGF0YVxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgbmFtZTogICAgICAgbmFtZSxcbiAgICAgICAgICAgIHZlcnNpb246ICAgIG1ham9yVmVyc2lvbixcbiAgICAgICAgICAgIGlzSUU6ICAgICAgIGlzSUUsXG4gICAgICAgICAgICBpc0ZpcmVmb3g6ICBpc0ZpcmVmb3gsXG4gICAgICAgICAgICBpc0Nocm9tZTogICBpc0Nocm9tZSxcbiAgICAgICAgICAgIGlzU2FmYXJpOiAgIGlzU2FmYXJpLFxuICAgICAgICAgICAgaXNJb3M6ICAgICAgLyhpUGFkfGlQaG9uZXxpUG9kKS9nLnRlc3QobmF2aWdhdG9yLnBsYXRmb3JtKSxcbiAgICAgICAgICAgIGlzSXBob25lOiAgIC8oaVBob25lfGlQb2QpL2cudGVzdChuYXZpZ2F0b3IudXNlckFnZW50KSxcbiAgICAgICAgICAgIGlzVG91Y2g6ICAgICdvbnRvdWNoc3RhcnQnIGluIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudFxuICAgICAgICB9O1xuICAgIH1cblxuICAgIC8vIENoZWNrIGZvciBtaW1lIHR5cGUgc3VwcG9ydCBhZ2FpbnN0IGEgcGxheWVyIGluc3RhbmNlXG4gICAgLy8gQ3JlZGl0czogaHR0cDovL2RpdmVpbnRvaHRtbDUuaW5mby9ldmVyeXRoaW5nLmh0bWxcbiAgICAvLyBSZWxhdGVkOiBodHRwOi8vd3d3LmxlYW5iYWNrcGx5ci5jb20vdGVzdC9oNW10Lmh0bWxcbiAgICBmdW5jdGlvbiBfc3VwcG9ydE1pbWUocGx5ciwgbWltZVR5cGUpIHtcbiAgICAgICAgdmFyIG1lZGlhID0gcGx5ci5tZWRpYTtcblxuICAgICAgICBpZiAocGx5ci50eXBlID09PSAndmlkZW8nKSB7XG4gICAgICAgICAgICAvLyBDaGVjayB0eXBlXG4gICAgICAgICAgICBzd2l0Y2ggKG1pbWVUeXBlKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAndmlkZW8vd2VibSc6ICAgcmV0dXJuICEhKG1lZGlhLmNhblBsYXlUeXBlICYmIG1lZGlhLmNhblBsYXlUeXBlKCd2aWRlby93ZWJtOyBjb2RlY3M9XCJ2cDgsIHZvcmJpc1wiJykucmVwbGFjZSgvbm8vLCAnJykpO1xuICAgICAgICAgICAgICAgIGNhc2UgJ3ZpZGVvL21wNCc6ICAgIHJldHVybiAhIShtZWRpYS5jYW5QbGF5VHlwZSAmJiBtZWRpYS5jYW5QbGF5VHlwZSgndmlkZW8vbXA0OyBjb2RlY3M9XCJhdmMxLjQyRTAxRSwgbXA0YS40MC4yXCInKS5yZXBsYWNlKC9uby8sICcnKSk7XG4gICAgICAgICAgICAgICAgY2FzZSAndmlkZW8vb2dnJzogICAgcmV0dXJuICEhKG1lZGlhLmNhblBsYXlUeXBlICYmIG1lZGlhLmNhblBsYXlUeXBlKCd2aWRlby9vZ2c7IGNvZGVjcz1cInRoZW9yYVwiJykucmVwbGFjZSgvbm8vLCAnJykpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKHBseXIudHlwZSA9PT0gJ2F1ZGlvJykge1xuICAgICAgICAgICAgLy8gQ2hlY2sgdHlwZVxuICAgICAgICAgICAgc3dpdGNoIChtaW1lVHlwZSkge1xuICAgICAgICAgICAgICAgIGNhc2UgJ2F1ZGlvL21wZWcnOiAgIHJldHVybiAhIShtZWRpYS5jYW5QbGF5VHlwZSAmJiBtZWRpYS5jYW5QbGF5VHlwZSgnYXVkaW8vbXBlZzsnKS5yZXBsYWNlKC9uby8sICcnKSk7XG4gICAgICAgICAgICAgICAgY2FzZSAnYXVkaW8vb2dnJzogICAgcmV0dXJuICEhKG1lZGlhLmNhblBsYXlUeXBlICYmIG1lZGlhLmNhblBsYXlUeXBlKCdhdWRpby9vZ2c7IGNvZGVjcz1cInZvcmJpc1wiJykucmVwbGFjZSgvbm8vLCAnJykpO1xuICAgICAgICAgICAgICAgIGNhc2UgJ2F1ZGlvL3dhdic6ICAgIHJldHVybiAhIShtZWRpYS5jYW5QbGF5VHlwZSAmJiBtZWRpYS5jYW5QbGF5VHlwZSgnYXVkaW8vd2F2OyBjb2RlY3M9XCIxXCInKS5yZXBsYWNlKC9uby8sICcnKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyBJZiB3ZSBnb3QgdGhpcyBmYXIsIHdlJ3JlIHN0dWZmZWRcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIC8vIEluamVjdCBhIHNjcmlwdFxuICAgIGZ1bmN0aW9uIF9pbmplY3RTY3JpcHQoc291cmNlKSB7XG4gICAgICAgIGlmIChkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdzY3JpcHRbc3JjPVwiJyArIHNvdXJjZSArICdcIl0nKS5sZW5ndGgpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciB0YWcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzY3JpcHQnKTtcbiAgICAgICAgdGFnLnNyYyA9IHNvdXJjZTtcbiAgICAgICAgdmFyIGZpcnN0U2NyaXB0VGFnID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ3NjcmlwdCcpWzBdO1xuICAgICAgICBmaXJzdFNjcmlwdFRhZy5wYXJlbnROb2RlLmluc2VydEJlZm9yZSh0YWcsIGZpcnN0U2NyaXB0VGFnKTtcbiAgICB9XG5cbiAgICAvLyBFbGVtZW50IGV4aXN0cyBpbiBhbiBhcnJheVxuICAgIGZ1bmN0aW9uIF9pbkFycmF5KGhheXN0YWNrLCBuZWVkbGUpIHtcbiAgICAgICAgcmV0dXJuIEFycmF5LnByb3RvdHlwZS5pbmRleE9mICYmIChoYXlzdGFjay5pbmRleE9mKG5lZWRsZSkgIT09IC0xKTtcbiAgICB9XG5cbiAgICAvLyBSZXBsYWNlIGFsbFxuICAgIGZ1bmN0aW9uIF9yZXBsYWNlQWxsKHN0cmluZywgZmluZCwgcmVwbGFjZSkge1xuICAgICAgICByZXR1cm4gc3RyaW5nLnJlcGxhY2UobmV3IFJlZ0V4cChmaW5kLnJlcGxhY2UoLyhbLiorP1xcXj0hOiR7fSgpfFxcW1xcXVxcL1xcXFxdKS9nLCAnXFxcXCQxJyksICdnJyksIHJlcGxhY2UpO1xuICAgIH1cblxuICAgIC8vIFdyYXAgYW4gZWxlbWVudFxuICAgIGZ1bmN0aW9uIF93cmFwKGVsZW1lbnRzLCB3cmFwcGVyKSB7XG4gICAgICAgIC8vIENvbnZlcnQgYGVsZW1lbnRzYCB0byBhbiBhcnJheSwgaWYgbmVjZXNzYXJ5LlxuICAgICAgICBpZiAoIWVsZW1lbnRzLmxlbmd0aCkge1xuICAgICAgICAgICAgZWxlbWVudHMgPSBbZWxlbWVudHNdO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gTG9vcHMgYmFja3dhcmRzIHRvIHByZXZlbnQgaGF2aW5nIHRvIGNsb25lIHRoZSB3cmFwcGVyIG9uIHRoZVxuICAgICAgICAvLyBmaXJzdCBlbGVtZW50IChzZWUgYGNoaWxkYCBiZWxvdykuXG4gICAgICAgIGZvciAodmFyIGkgPSBlbGVtZW50cy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xuICAgICAgICAgICAgdmFyIGNoaWxkICAgPSAoaSA+IDApID8gd3JhcHBlci5jbG9uZU5vZGUodHJ1ZSkgOiB3cmFwcGVyO1xuICAgICAgICAgICAgdmFyIGVsZW1lbnQgPSBlbGVtZW50c1tpXTtcblxuICAgICAgICAgICAgLy8gQ2FjaGUgdGhlIGN1cnJlbnQgcGFyZW50IGFuZCBzaWJsaW5nLlxuICAgICAgICAgICAgdmFyIHBhcmVudCAgPSBlbGVtZW50LnBhcmVudE5vZGU7XG4gICAgICAgICAgICB2YXIgc2libGluZyA9IGVsZW1lbnQubmV4dFNpYmxpbmc7XG5cbiAgICAgICAgICAgIC8vIFdyYXAgdGhlIGVsZW1lbnQgKGlzIGF1dG9tYXRpY2FsbHkgcmVtb3ZlZCBmcm9tIGl0cyBjdXJyZW50XG4gICAgICAgICAgICAvLyBwYXJlbnQpLlxuICAgICAgICAgICAgY2hpbGQuYXBwZW5kQ2hpbGQoZWxlbWVudCk7XG5cbiAgICAgICAgICAgIC8vIElmIHRoZSBlbGVtZW50IGhhZCBhIHNpYmxpbmcsIGluc2VydCB0aGUgd3JhcHBlciBiZWZvcmVcbiAgICAgICAgICAgIC8vIHRoZSBzaWJsaW5nIHRvIG1haW50YWluIHRoZSBIVE1MIHN0cnVjdHVyZTsgb3RoZXJ3aXNlLCBqdXN0XG4gICAgICAgICAgICAvLyBhcHBlbmQgaXQgdG8gdGhlIHBhcmVudC5cbiAgICAgICAgICAgIGlmIChzaWJsaW5nKSB7XG4gICAgICAgICAgICAgICAgcGFyZW50Lmluc2VydEJlZm9yZShjaGlsZCwgc2libGluZyk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHBhcmVudC5hcHBlbmRDaGlsZChjaGlsZCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiBjaGlsZDtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vIFVud3JhcCBhbiBlbGVtZW50XG4gICAgLy8gaHR0cDovL3BsYWluanMuY29tL2phdmFzY3JpcHQvbWFuaXB1bGF0aW9uL3Vud3JhcC1hLWRvbS1lbGVtZW50LTM1L1xuICAgIC8qZnVuY3Rpb24gX3Vud3JhcCh3cmFwcGVyKSB7XG4gICAgICAgIC8vIEdldCB0aGUgZWxlbWVudCdzIHBhcmVudCBub2RlXG4gICAgICAgIHZhciBwYXJlbnQgPSB3cmFwcGVyLnBhcmVudE5vZGU7XG5cbiAgICAgICAgLy8gTW92ZSBhbGwgY2hpbGRyZW4gb3V0IG9mIHRoZSBlbGVtZW50XG4gICAgICAgIHdoaWxlICh3cmFwcGVyLmZpcnN0Q2hpbGQpIHtcbiAgICAgICAgICAgIHBhcmVudC5pbnNlcnRCZWZvcmUod3JhcHBlci5maXJzdENoaWxkLCB3cmFwcGVyKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFJlbW92ZSB0aGUgZW1wdHkgZWxlbWVudFxuICAgICAgICBwYXJlbnQucmVtb3ZlQ2hpbGQod3JhcHBlcik7XG4gICAgfSovXG5cbiAgICAvLyBSZW1vdmUgYW4gZWxlbWVudFxuICAgIGZ1bmN0aW9uIF9yZW1vdmUoZWxlbWVudCkge1xuICAgICAgICBpZiAoIWVsZW1lbnQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBlbGVtZW50LnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoZWxlbWVudCk7XG4gICAgfVxuXG4gICAgLy8gUHJlcGVuZCBjaGlsZFxuICAgIGZ1bmN0aW9uIF9wcmVwZW5kQ2hpbGQocGFyZW50LCBlbGVtZW50KSB7XG4gICAgICAgIHBhcmVudC5pbnNlcnRCZWZvcmUoZWxlbWVudCwgcGFyZW50LmZpcnN0Q2hpbGQpO1xuICAgIH1cblxuICAgIC8vIFNldCBhdHRyaWJ1dGVzXG4gICAgZnVuY3Rpb24gX3NldEF0dHJpYnV0ZXMoZWxlbWVudCwgYXR0cmlidXRlcykge1xuICAgICAgICBmb3IgKHZhciBrZXkgaW4gYXR0cmlidXRlcykge1xuICAgICAgICAgICAgZWxlbWVudC5zZXRBdHRyaWJ1dGUoa2V5LCAoX2lzLmJvb2xlYW4oYXR0cmlidXRlc1trZXldKSAmJiBhdHRyaWJ1dGVzW2tleV0pID8gJycgOiBhdHRyaWJ1dGVzW2tleV0pO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLy8gSW5zZXJ0IGEgSFRNTCBlbGVtZW50XG4gICAgZnVuY3Rpb24gX2luc2VydEVsZW1lbnQodHlwZSwgcGFyZW50LCBhdHRyaWJ1dGVzKSB7XG4gICAgICAgIC8vIENyZWF0ZSBhIG5ldyA8ZWxlbWVudD5cbiAgICAgICAgdmFyIGVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KHR5cGUpO1xuXG4gICAgICAgIC8vIFNldCBhbGwgcGFzc2VkIGF0dHJpYnV0ZXNcbiAgICAgICAgX3NldEF0dHJpYnV0ZXMoZWxlbWVudCwgYXR0cmlidXRlcyk7XG5cbiAgICAgICAgLy8gSW5qZWN0IHRoZSBuZXcgZWxlbWVudFxuICAgICAgICBfcHJlcGVuZENoaWxkKHBhcmVudCwgZWxlbWVudCk7XG4gICAgfVxuXG4gICAgLy8gR2V0IGEgY2xhc3NuYW1lIGZyb20gc2VsZWN0b3JcbiAgICBmdW5jdGlvbiBfZ2V0Q2xhc3NuYW1lKHNlbGVjdG9yKSB7XG4gICAgICAgIHJldHVybiBzZWxlY3Rvci5yZXBsYWNlKCcuJywgJycpO1xuICAgIH1cblxuICAgIC8vIFRvZ2dsZSBjbGFzcyBvbiBhbiBlbGVtZW50XG4gICAgZnVuY3Rpb24gX3RvZ2dsZUNsYXNzKGVsZW1lbnQsIGNsYXNzTmFtZSwgc3RhdGUpIHtcbiAgICAgICAgaWYgKGVsZW1lbnQpIHtcbiAgICAgICAgICAgIGlmIChlbGVtZW50LmNsYXNzTGlzdCkge1xuICAgICAgICAgICAgICAgIGVsZW1lbnQuY2xhc3NMaXN0W3N0YXRlID8gJ2FkZCcgOiAncmVtb3ZlJ10oY2xhc3NOYW1lKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdmFyIG5hbWUgPSAoJyAnICsgZWxlbWVudC5jbGFzc05hbWUgKyAnICcpLnJlcGxhY2UoL1xccysvZywgJyAnKS5yZXBsYWNlKCcgJyArIGNsYXNzTmFtZSArICcgJywgJycpO1xuICAgICAgICAgICAgICAgIGVsZW1lbnQuY2xhc3NOYW1lID0gbmFtZSArIChzdGF0ZSA/ICcgJyArIGNsYXNzTmFtZSA6ICcnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vIEhhcyBjbGFzcyBuYW1lXG4gICAgZnVuY3Rpb24gX2hhc0NsYXNzKGVsZW1lbnQsIGNsYXNzTmFtZSkge1xuICAgICAgICBpZiAoZWxlbWVudCkge1xuICAgICAgICAgICAgaWYgKGVsZW1lbnQuY2xhc3NMaXN0KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKGNsYXNzTmFtZSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgUmVnRXhwKCcoXFxcXHN8XiknICsgY2xhc3NOYW1lICsgJyhcXFxcc3wkKScpLnRlc3QoZWxlbWVudC5jbGFzc05hbWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICAvLyBFbGVtZW50IG1hdGNoZXMgc2VsZWN0b3JcbiAgICBmdW5jdGlvbiBfbWF0Y2hlcyhlbGVtZW50LCBzZWxlY3Rvcikge1xuICAgICAgICB2YXIgcCA9IEVsZW1lbnQucHJvdG90eXBlO1xuXG4gICAgICAgIHZhciBmID0gcC5tYXRjaGVzIHx8IHAud2Via2l0TWF0Y2hlc1NlbGVjdG9yIHx8IHAubW96TWF0Y2hlc1NlbGVjdG9yIHx8IHAubXNNYXRjaGVzU2VsZWN0b3IgfHwgZnVuY3Rpb24ocykge1xuICAgICAgICAgICAgcmV0dXJuIFtdLmluZGV4T2YuY2FsbChkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKHMpLCB0aGlzKSAhPT0gLTE7XG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIGYuY2FsbChlbGVtZW50LCBzZWxlY3Rvcik7XG4gICAgfVxuXG4gICAgLy8gQmluZCBhbG9uZyB3aXRoIGN1c3RvbSBoYW5kbGVyXG4gICAgZnVuY3Rpb24gX3Byb3h5TGlzdGVuZXIoZWxlbWVudCwgZXZlbnROYW1lLCB1c2VyTGlzdGVuZXIsIGRlZmF1bHRMaXN0ZW5lciwgdXNlQ2FwdHVyZSkge1xuICAgICAgICBfb24oZWxlbWVudCwgZXZlbnROYW1lLCBmdW5jdGlvbihldmVudCkge1xuICAgICAgICAgICAgaWYgKHVzZXJMaXN0ZW5lcikge1xuICAgICAgICAgICAgICAgIHVzZXJMaXN0ZW5lci5hcHBseShlbGVtZW50LCBbZXZlbnRdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGRlZmF1bHRMaXN0ZW5lci5hcHBseShlbGVtZW50LCBbZXZlbnRdKTtcbiAgICAgICAgfSwgdXNlQ2FwdHVyZSk7XG4gICAgfVxuXG4gICAgLy8gVG9nZ2xlIGV2ZW50IGxpc3RlbmVyXG4gICAgZnVuY3Rpb24gX3RvZ2dsZUxpc3RlbmVyKGVsZW1lbnQsIGV2ZW50cywgY2FsbGJhY2ssIHRvZ2dsZSwgdXNlQ2FwdHVyZSkge1xuICAgICAgICB2YXIgZXZlbnRMaXN0ID0gZXZlbnRzLnNwbGl0KCcgJyk7XG5cbiAgICAgICAgLy8gV2hldGhlciB0aGUgbGlzdGVuZXIgaXMgYSBjYXB0dXJpbmcgbGlzdGVuZXIgb3Igbm90XG4gICAgICAgIC8vIERlZmF1bHQgdG8gZmFsc2VcbiAgICAgICAgaWYgKCFfaXMuYm9vbGVhbih1c2VDYXB0dXJlKSkge1xuICAgICAgICAgICAgdXNlQ2FwdHVyZSA9IGZhbHNlO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gSWYgYSBub2RlbGlzdCBpcyBwYXNzZWQsIGNhbGwgaXRzZWxmIG9uIGVhY2ggbm9kZVxuICAgICAgICBpZiAoZWxlbWVudCBpbnN0YW5jZW9mIE5vZGVMaXN0KSB7XG4gICAgICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IGVsZW1lbnQubGVuZ3RoOyB4KyspIHtcbiAgICAgICAgICAgICAgICBpZiAoZWxlbWVudFt4XSBpbnN0YW5jZW9mIE5vZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgX3RvZ2dsZUxpc3RlbmVyKGVsZW1lbnRbeF0sIGFyZ3VtZW50c1sxXSwgYXJndW1lbnRzWzJdLCBhcmd1bWVudHNbM10pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIElmIGEgc2luZ2xlIG5vZGUgaXMgcGFzc2VkLCBiaW5kIHRoZSBldmVudCBsaXN0ZW5lclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGV2ZW50TGlzdC5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgZWxlbWVudFt0b2dnbGUgPyAnYWRkRXZlbnRMaXN0ZW5lcicgOiAncmVtb3ZlRXZlbnRMaXN0ZW5lciddKGV2ZW50TGlzdFtpXSwgY2FsbGJhY2ssIHVzZUNhcHR1cmUpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLy8gQmluZCBldmVudFxuICAgIGZ1bmN0aW9uIF9vbihlbGVtZW50LCBldmVudHMsIGNhbGxiYWNrLCB1c2VDYXB0dXJlKSB7XG4gICAgICAgIGlmIChlbGVtZW50KSB7XG4gICAgICAgICAgICBfdG9nZ2xlTGlzdGVuZXIoZWxlbWVudCwgZXZlbnRzLCBjYWxsYmFjaywgdHJ1ZSwgdXNlQ2FwdHVyZSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBVbmJpbmQgZXZlbnRcbiAgICAvKmZ1bmN0aW9uIF9vZmYoZWxlbWVudCwgZXZlbnRzLCBjYWxsYmFjaywgdXNlQ2FwdHVyZSkge1xuICAgICAgICBpZiAoZWxlbWVudCkge1xuICAgICAgICAgICAgX3RvZ2dsZUxpc3RlbmVyKGVsZW1lbnQsIGV2ZW50cywgY2FsbGJhY2ssIGZhbHNlLCB1c2VDYXB0dXJlKTtcbiAgICAgICAgfVxuICAgIH0qL1xuXG4gICAgLy8gVHJpZ2dlciBldmVudFxuICAgIGZ1bmN0aW9uIF9ldmVudChlbGVtZW50LCB0eXBlLCBidWJibGVzLCBwcm9wZXJ0aWVzKSB7XG4gICAgICAgIC8vIEJhaWwgaWYgbm8gZWxlbWVudFxuICAgICAgICBpZiAoIWVsZW1lbnQgfHwgIXR5cGUpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIERlZmF1bHQgYnViYmxlcyB0byBmYWxzZVxuICAgICAgICBpZiAoIV9pcy5ib29sZWFuKGJ1YmJsZXMpKSB7XG4gICAgICAgICAgICBidWJibGVzID0gZmFsc2U7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBDcmVhdGUgYW5kIGRpc3BhdGNoIHRoZSBldmVudFxuICAgICAgICB2YXIgZXZlbnQgPSBuZXcgQ3VzdG9tRXZlbnQodHlwZSwge1xuICAgICAgICAgICAgYnViYmxlczogICAgYnViYmxlcyxcbiAgICAgICAgICAgIGRldGFpbDogICAgIHByb3BlcnRpZXNcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gRGlzcGF0Y2ggdGhlIGV2ZW50XG4gICAgICAgIGVsZW1lbnQuZGlzcGF0Y2hFdmVudChldmVudCk7XG4gICAgfVxuXG4gICAgLy8gVG9nZ2xlIGFyaWEtcHJlc3NlZCBzdGF0ZSBvbiBhIHRvZ2dsZSBidXR0b25cbiAgICAvLyBodHRwOi8vd3d3LnNzYmJhcnRncm91cC5jb20vYmxvZy9ob3ctbm90LXRvLW1pc3VzZS1hcmlhLXN0YXRlcy1wcm9wZXJ0aWVzLWFuZC1yb2xlc1xuICAgIGZ1bmN0aW9uIF90b2dnbGVTdGF0ZSh0YXJnZXQsIHN0YXRlKSB7XG4gICAgICAgIC8vIEJhaWwgaWYgbm8gdGFyZ2V0XG4gICAgICAgIGlmICghdGFyZ2V0KSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICAvLyBHZXQgc3RhdGVcbiAgICAgICAgc3RhdGUgPSAoX2lzLmJvb2xlYW4oc3RhdGUpID8gc3RhdGUgOiAhdGFyZ2V0LmdldEF0dHJpYnV0ZSgnYXJpYS1wcmVzc2VkJykpO1xuXG4gICAgICAgIC8vIFNldCB0aGUgYXR0cmlidXRlIG9uIHRhcmdldFxuICAgICAgICB0YXJnZXQuc2V0QXR0cmlidXRlKCdhcmlhLXByZXNzZWQnLCBzdGF0ZSk7XG5cbiAgICAgICAgcmV0dXJuIHN0YXRlO1xuICAgIH1cblxuICAgIC8vIEdldCBwZXJjZW50YWdlXG4gICAgZnVuY3Rpb24gX2dldFBlcmNlbnRhZ2UoY3VycmVudCwgbWF4KSB7XG4gICAgICAgIGlmIChjdXJyZW50ID09PSAwIHx8IG1heCA9PT0gMCB8fCBpc05hTihjdXJyZW50KSB8fCBpc05hTihtYXgpKSB7XG4gICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gKChjdXJyZW50IC8gbWF4KSAqIDEwMCkudG9GaXhlZCgyKTtcbiAgICB9XG5cbiAgICAvLyBEZWVwIGV4dGVuZC9tZXJnZSBkZXN0aW5hdGlvbiBvYmplY3Qgd2l0aCBOIG1vcmUgb2JqZWN0c1xuICAgIC8vIGh0dHA6Ly9hbmRyZXdkdXBvbnQubmV0LzIwMDkvMDgvMjgvZGVlcC1leHRlbmRpbmctb2JqZWN0cy1pbi1qYXZhc2NyaXB0L1xuICAgIC8vIFJlbW92ZWQgY2FsbCB0byBhcmd1bWVudHMuY2FsbGVlICh1c2VkIGV4cGxpY2l0IGZ1bmN0aW9uIG5hbWUgaW5zdGVhZClcbiAgICBmdW5jdGlvbiBfZXh0ZW5kKCkge1xuICAgICAgICAvLyBHZXQgYXJndW1lbnRzXG4gICAgICAgIHZhciBvYmplY3RzID0gYXJndW1lbnRzO1xuXG4gICAgICAgIC8vIEJhaWwgaWYgbm90aGluZyB0byBtZXJnZVxuICAgICAgICBpZiAoIW9iamVjdHMubGVuZ3RoKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICAvLyBSZXR1cm4gZmlyc3QgaWYgc3BlY2lmaWVkIGJ1dCBub3RoaW5nIHRvIG1lcmdlXG4gICAgICAgIGlmIChvYmplY3RzLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICAgICAgcmV0dXJuIG9iamVjdHNbMF07XG4gICAgICAgIH1cblxuICAgICAgICAvLyBGaXJzdCBvYmplY3QgaXMgdGhlIGRlc3RpbmF0aW9uXG4gICAgICAgIHZhciBkZXN0aW5hdGlvbiA9IEFycmF5LnByb3RvdHlwZS5zaGlmdC5jYWxsKG9iamVjdHMpLFxuICAgICAgICAgICAgbGVuZ3RoICAgICAgPSBvYmplY3RzLmxlbmd0aDtcblxuICAgICAgICAvLyBMb29wIHRocm91Z2ggYWxsIG9iamVjdHMgdG8gbWVyZ2VcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIHNvdXJjZSA9IG9iamVjdHNbaV07XG5cbiAgICAgICAgICAgIGZvciAodmFyIHByb3BlcnR5IGluIHNvdXJjZSkge1xuICAgICAgICAgICAgICAgIGlmIChzb3VyY2VbcHJvcGVydHldICYmIHNvdXJjZVtwcm9wZXJ0eV0uY29uc3RydWN0b3IgJiYgc291cmNlW3Byb3BlcnR5XS5jb25zdHJ1Y3RvciA9PT0gT2JqZWN0KSB7XG4gICAgICAgICAgICAgICAgICAgIGRlc3RpbmF0aW9uW3Byb3BlcnR5XSA9IGRlc3RpbmF0aW9uW3Byb3BlcnR5XSB8fCB7fTtcbiAgICAgICAgICAgICAgICAgICAgX2V4dGVuZChkZXN0aW5hdGlvbltwcm9wZXJ0eV0sIHNvdXJjZVtwcm9wZXJ0eV0pO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGRlc3RpbmF0aW9uW3Byb3BlcnR5XSA9IHNvdXJjZVtwcm9wZXJ0eV07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGRlc3RpbmF0aW9uO1xuICAgIH1cblxuICAgIC8vIENoZWNrIHZhcmlhYmxlIHR5cGVzXG4gICAgdmFyIF9pcyA9IHtcbiAgICAgICAgb2JqZWN0OiBmdW5jdGlvbihpbnB1dCkge1xuICAgICAgICAgICAgcmV0dXJuIGlucHV0ICE9PSBudWxsICYmIHR5cGVvZihpbnB1dCkgPT09ICdvYmplY3QnO1xuICAgICAgICB9LFxuICAgICAgICBhcnJheTogZnVuY3Rpb24oaW5wdXQpIHtcbiAgICAgICAgICAgIHJldHVybiBpbnB1dCAhPT0gbnVsbCAmJiAodHlwZW9mKGlucHV0KSA9PT0gJ29iamVjdCcgJiYgaW5wdXQuY29uc3RydWN0b3IgPT09IEFycmF5KTtcbiAgICAgICAgfSxcbiAgICAgICAgbnVtYmVyOiBmdW5jdGlvbihpbnB1dCkge1xuICAgICAgICAgICAgcmV0dXJuIGlucHV0ICE9PSBudWxsICYmICh0eXBlb2YoaW5wdXQpID09PSAnbnVtYmVyJyAmJiAhaXNOYU4oaW5wdXQgLSAwKSB8fCAodHlwZW9mIGlucHV0ID09PSAnb2JqZWN0JyAmJiBpbnB1dC5jb25zdHJ1Y3RvciA9PT0gTnVtYmVyKSk7XG4gICAgICAgIH0sXG4gICAgICAgIHN0cmluZzogZnVuY3Rpb24oaW5wdXQpIHtcbiAgICAgICAgICAgIHJldHVybiBpbnB1dCAhPT0gbnVsbCAmJiAodHlwZW9mIGlucHV0ID09PSAnc3RyaW5nJyB8fCAodHlwZW9mIGlucHV0ID09PSAnb2JqZWN0JyAmJiBpbnB1dC5jb25zdHJ1Y3RvciA9PT0gU3RyaW5nKSk7XG4gICAgICAgIH0sXG4gICAgICAgIGJvb2xlYW46IGZ1bmN0aW9uKGlucHV0KSB7XG4gICAgICAgICAgICByZXR1cm4gaW5wdXQgIT09IG51bGwgJiYgdHlwZW9mIGlucHV0ID09PSAnYm9vbGVhbic7XG4gICAgICAgIH0sXG4gICAgICAgIG5vZGVMaXN0OiBmdW5jdGlvbihpbnB1dCkge1xuICAgICAgICAgICAgcmV0dXJuIGlucHV0ICE9PSBudWxsICYmIGlucHV0IGluc3RhbmNlb2YgTm9kZUxpc3Q7XG4gICAgICAgIH0sXG4gICAgICAgIGh0bWxFbGVtZW50OiBmdW5jdGlvbihpbnB1dCkge1xuICAgICAgICAgICAgcmV0dXJuIGlucHV0ICE9PSBudWxsICYmIGlucHV0IGluc3RhbmNlb2YgSFRNTEVsZW1lbnQ7XG4gICAgICAgIH0sXG4gICAgICAgIGZ1bmN0aW9uOiBmdW5jdGlvbihpbnB1dCkge1xuICAgICAgICAgICAgcmV0dXJuIGlucHV0ICE9PSBudWxsICYmIHR5cGVvZiBpbnB1dCA9PT0gJ2Z1bmN0aW9uJztcbiAgICAgICAgfSxcbiAgICAgICAgdW5kZWZpbmVkOiBmdW5jdGlvbihpbnB1dCkge1xuICAgICAgICAgICAgcmV0dXJuIGlucHV0ICE9PSBudWxsICYmIHR5cGVvZiBpbnB1dCA9PT0gJ3VuZGVmaW5lZCc7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgLy8gUGFyc2UgWW91VHViZSBJRCBmcm9tIHVybFxuICAgIGZ1bmN0aW9uIF9wYXJzZVlvdVR1YmVJZCh1cmwpIHtcbiAgICAgICAgdmFyIHJlZ2V4ID0gL14uKih5b3V0dS5iZVxcL3x2XFwvfHVcXC9cXHdcXC98ZW1iZWRcXC98d2F0Y2hcXD92PXxcXCZ2PSkoW14jXFwmXFw/XSopLiovO1xuICAgICAgICByZXR1cm4gKHVybC5tYXRjaChyZWdleCkpID8gUmVnRXhwLiQyIDogdXJsO1xuICAgIH1cblxuICAgIC8vIFBhcnNlIFZpbWVvIElEIGZyb20gdXJsXG4gICAgZnVuY3Rpb24gX3BhcnNlVmltZW9JZCh1cmwpIHtcbiAgICAgICAgdmFyIHJlZ2V4ID0gL14uKih2aW1lby5jb21cXC98dmlkZW9cXC8pKFxcZCspLiovO1xuICAgICAgICByZXR1cm4gKHVybC5tYXRjaChyZWdleCkpID8gUmVnRXhwLiQyIDogdXJsO1xuICAgIH1cblxuICAgIC8vIEZ1bGxzY3JlZW4gQVBJXG4gICAgZnVuY3Rpb24gX2Z1bGxzY3JlZW4oKSB7XG4gICAgICAgIHZhciBmdWxsc2NyZWVuID0ge1xuICAgICAgICAgICAgICAgIHN1cHBvcnRzRnVsbFNjcmVlbjogZmFsc2UsXG4gICAgICAgICAgICAgICAgaXNGdWxsU2NyZWVuOiBmdW5jdGlvbigpIHsgcmV0dXJuIGZhbHNlOyB9LFxuICAgICAgICAgICAgICAgIHJlcXVlc3RGdWxsU2NyZWVuOiBmdW5jdGlvbigpIHt9LFxuICAgICAgICAgICAgICAgIGNhbmNlbEZ1bGxTY3JlZW46IGZ1bmN0aW9uKCkge30sXG4gICAgICAgICAgICAgICAgZnVsbFNjcmVlbkV2ZW50TmFtZTogJycsXG4gICAgICAgICAgICAgICAgZWxlbWVudDogbnVsbCxcbiAgICAgICAgICAgICAgICBwcmVmaXg6ICcnXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgYnJvd3NlclByZWZpeGVzID0gJ3dlYmtpdCBvIG1veiBtcyBraHRtbCcuc3BsaXQoJyAnKTtcblxuICAgICAgICAvLyBDaGVjayBmb3IgbmF0aXZlIHN1cHBvcnRcbiAgICAgICAgaWYgKCFfaXMudW5kZWZpbmVkKGRvY3VtZW50LmNhbmNlbEZ1bGxTY3JlZW4pKSB7XG4gICAgICAgICAgICBmdWxsc2NyZWVuLnN1cHBvcnRzRnVsbFNjcmVlbiA9IHRydWU7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyBDaGVjayBmb3IgZnVsbHNjcmVlbiBzdXBwb3J0IGJ5IHZlbmRvciBwcmVmaXhcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBpbCA9IGJyb3dzZXJQcmVmaXhlcy5sZW5ndGg7IGkgPCBpbDsgaSsrICkge1xuICAgICAgICAgICAgICAgIGZ1bGxzY3JlZW4ucHJlZml4ID0gYnJvd3NlclByZWZpeGVzW2ldO1xuXG4gICAgICAgICAgICAgICAgaWYgKCFfaXMudW5kZWZpbmVkKGRvY3VtZW50W2Z1bGxzY3JlZW4ucHJlZml4ICsgJ0NhbmNlbEZ1bGxTY3JlZW4nXSkpIHtcbiAgICAgICAgICAgICAgICAgICAgZnVsbHNjcmVlbi5zdXBwb3J0c0Z1bGxTY3JlZW4gPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCFfaXMudW5kZWZpbmVkKGRvY3VtZW50Lm1zRXhpdEZ1bGxzY3JlZW4pICYmIGRvY3VtZW50Lm1zRnVsbHNjcmVlbkVuYWJsZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gU3BlY2lhbCBjYXNlIGZvciBNUyAod2hlbiBpc24ndCBpdD8pXG4gICAgICAgICAgICAgICAgICAgIGZ1bGxzY3JlZW4ucHJlZml4ID0gJ21zJztcbiAgICAgICAgICAgICAgICAgICAgZnVsbHNjcmVlbi5zdXBwb3J0c0Z1bGxTY3JlZW4gPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyBVcGRhdGUgbWV0aG9kcyB0byBkbyBzb21ldGhpbmcgdXNlZnVsXG4gICAgICAgIGlmIChmdWxsc2NyZWVuLnN1cHBvcnRzRnVsbFNjcmVlbikge1xuICAgICAgICAgICAgLy8gWWV0IGFnYWluIE1pY3Jvc29mdCBhd2Vzb21lbmVzcyxcbiAgICAgICAgICAgIC8vIFNvbWV0aW1lcyB0aGUgcHJlZml4IGlzICdtcycsIHNvbWV0aW1lcyAnTVMnIHRvIGtlZXAgeW91IG9uIHlvdXIgdG9lc1xuICAgICAgICAgICAgZnVsbHNjcmVlbi5mdWxsU2NyZWVuRXZlbnROYW1lID0gKGZ1bGxzY3JlZW4ucHJlZml4ID09PSAnbXMnID8gJ01TRnVsbHNjcmVlbkNoYW5nZScgOiBmdWxsc2NyZWVuLnByZWZpeCArICdmdWxsc2NyZWVuY2hhbmdlJyk7XG5cbiAgICAgICAgICAgIGZ1bGxzY3JlZW4uaXNGdWxsU2NyZWVuID0gZnVuY3Rpb24oZWxlbWVudCkge1xuICAgICAgICAgICAgICAgIGlmIChfaXMudW5kZWZpbmVkKGVsZW1lbnQpKSB7XG4gICAgICAgICAgICAgICAgICAgIGVsZW1lbnQgPSBkb2N1bWVudC5ib2R5O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBzd2l0Y2ggKHRoaXMucHJlZml4KSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJyc6XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZG9jdW1lbnQuZnVsbHNjcmVlbkVsZW1lbnQgPT09IGVsZW1lbnQ7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ21veic6XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZG9jdW1lbnQubW96RnVsbFNjcmVlbkVsZW1lbnQgPT09IGVsZW1lbnQ7XG4gICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZG9jdW1lbnRbdGhpcy5wcmVmaXggKyAnRnVsbHNjcmVlbkVsZW1lbnQnXSA9PT0gZWxlbWVudDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgZnVsbHNjcmVlbi5yZXF1ZXN0RnVsbFNjcmVlbiA9IGZ1bmN0aW9uKGVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICBpZiAoX2lzLnVuZGVmaW5lZChlbGVtZW50KSkge1xuICAgICAgICAgICAgICAgICAgICBlbGVtZW50ID0gZG9jdW1lbnQuYm9keTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuICh0aGlzLnByZWZpeCA9PT0gJycpID8gZWxlbWVudC5yZXF1ZXN0RnVsbFNjcmVlbigpIDogZWxlbWVudFt0aGlzLnByZWZpeCArICh0aGlzLnByZWZpeCA9PT0gJ21zJyA/ICdSZXF1ZXN0RnVsbHNjcmVlbicgOiAnUmVxdWVzdEZ1bGxTY3JlZW4nKV0oKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBmdWxsc2NyZWVuLmNhbmNlbEZ1bGxTY3JlZW4gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gKHRoaXMucHJlZml4ID09PSAnJykgPyBkb2N1bWVudC5jYW5jZWxGdWxsU2NyZWVuKCkgOiBkb2N1bWVudFt0aGlzLnByZWZpeCArICh0aGlzLnByZWZpeCA9PT0gJ21zJyA/ICdFeGl0RnVsbHNjcmVlbicgOiAnQ2FuY2VsRnVsbFNjcmVlbicpXSgpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGZ1bGxzY3JlZW4uZWxlbWVudCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiAodGhpcy5wcmVmaXggPT09ICcnKSA/IGRvY3VtZW50LmZ1bGxzY3JlZW5FbGVtZW50IDogZG9jdW1lbnRbdGhpcy5wcmVmaXggKyAnRnVsbHNjcmVlbkVsZW1lbnQnXTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gZnVsbHNjcmVlbjtcbiAgICB9XG5cbiAgICAvLyBMb2NhbCBzdG9yYWdlXG4gICAgdmFyIF9zdG9yYWdlID0ge1xuICAgICAgICBzdXBwb3J0ZWQ6IChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGlmICghKCdsb2NhbFN0b3JhZ2UnIGluIHdpbmRvdykpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIFRyeSB0byB1c2UgaXQgKGl0IG1pZ2h0IGJlIGRpc2FibGVkLCBlLmcuIHVzZXIgaXMgaW4gcHJpdmF0ZS9wb3JuIG1vZGUpXG4gICAgICAgICAgICAvLyBzZWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9TZWx6L3BseXIvaXNzdWVzLzEzMVxuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAvLyBBZGQgdGVzdCBpdGVtXG4gICAgICAgICAgICAgICAgd2luZG93LmxvY2FsU3RvcmFnZS5zZXRJdGVtKCdfX190ZXN0JywgJ09LJyk7XG5cbiAgICAgICAgICAgICAgICAvLyBHZXQgdGhlIHRlc3QgaXRlbVxuICAgICAgICAgICAgICAgIHZhciByZXN1bHQgPSB3aW5kb3cubG9jYWxTdG9yYWdlLmdldEl0ZW0oJ19fX3Rlc3QnKTtcblxuICAgICAgICAgICAgICAgIC8vIENsZWFuIHVwXG4gICAgICAgICAgICAgICAgd2luZG93LmxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKCdfX190ZXN0Jyk7XG5cbiAgICAgICAgICAgICAgICAvLyBDaGVjayBpZiB2YWx1ZSBtYXRjaGVzXG4gICAgICAgICAgICAgICAgcmV0dXJuIChyZXN1bHQgPT09ICdPSycpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfSkoKVxuICAgIH07XG5cbiAgICAvLyBQbGF5ZXIgaW5zdGFuY2VcbiAgICBmdW5jdGlvbiBQbHlyKG1lZGlhLCBjb25maWcpIHtcbiAgICAgICAgdmFyIHBseXIgPSB0aGlzLFxuICAgICAgICB0aW1lcnMgPSB7fSxcbiAgICAgICAgYXBpO1xuXG4gICAgICAgIC8vIFNldCBtZWRpYVxuICAgICAgICBwbHlyLm1lZGlhID0gbWVkaWE7XG4gICAgICAgIHZhciBvcmlnaW5hbCA9IG1lZGlhLmNsb25lTm9kZSh0cnVlKTtcblxuICAgICAgICAvLyBUcmlnZ2VyIGV2ZW50cywgd2l0aCBwbHlyIGluc3RhbmNlIHBhc3NlZFxuICAgICAgICBmdW5jdGlvbiBfdHJpZ2dlckV2ZW50KGVsZW1lbnQsIHR5cGUsIGJ1YmJsZXMsIHByb3BlcnRpZXMpIHtcbiAgICAgICAgICAgIF9ldmVudChlbGVtZW50LCB0eXBlLCBidWJibGVzLCBfZXh0ZW5kKHt9LCBwcm9wZXJ0aWVzLCB7XG4gICAgICAgICAgICAgICAgcGx5cjogYXBpXG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBEZWJ1Z2dpbmdcbiAgICAgICAgZnVuY3Rpb24gX2NvbnNvbGUodHlwZSwgYXJncykge1xuICAgICAgICAgICAgaWYgKGNvbmZpZy5kZWJ1ZyAmJiB3aW5kb3cuY29uc29sZSkge1xuICAgICAgICAgICAgICAgIGFyZ3MgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmdzKTtcblxuICAgICAgICAgICAgICAgIGlmIChfaXMuc3RyaW5nKGNvbmZpZy5sb2dQcmVmaXgpICYmIGNvbmZpZy5sb2dQcmVmaXgubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgIGFyZ3MudW5zaGlmdChjb25maWcubG9nUHJlZml4KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBjb25zb2xlW3R5cGVdLmFwcGx5KGNvbnNvbGUsIGFyZ3MpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHZhciBfbG9nID0gZnVuY3Rpb24oKSB7IF9jb25zb2xlKCdsb2cnLCBhcmd1bWVudHMpIH0sXG4gICAgICAgICAgICBfd2FybiA9IGZ1bmN0aW9uKCkgeyBfY29uc29sZSgnd2FybicsIGFyZ3VtZW50cykgfTtcblxuICAgICAgICAvLyBMb2cgY29uZmlnIG9wdGlvbnNcbiAgICAgICAgX2xvZygnQ29uZmlnJywgY29uZmlnKTtcblxuICAgICAgICAvLyBHZXQgaWNvbiBVUkxcbiAgICAgICAgZnVuY3Rpb24gX2dldEljb25VcmwoKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHVybDogICAgICAgIGNvbmZpZy5pY29uVXJsLFxuICAgICAgICAgICAgICAgIGFic29sdXRlOiAgIChjb25maWcuaWNvblVybC5pbmRleE9mKFwiaHR0cFwiKSA9PT0gMCkgfHwgcGx5ci5icm93c2VyLmlzSUVcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICAvLyBCdWlsZCB0aGUgZGVmYXVsdCBIVE1MXG4gICAgICAgIGZ1bmN0aW9uIF9idWlsZENvbnRyb2xzKCkge1xuICAgICAgICAgICAgLy8gQ3JlYXRlIGh0bWwgYXJyYXlcbiAgICAgICAgICAgIHZhciBodG1sICAgICAgICA9IFtdLFxuICAgICAgICAgICAgICAgIGljb25VcmwgICAgID0gX2dldEljb25VcmwoKSxcbiAgICAgICAgICAgICAgICBpY29uUGF0aCAgICA9ICghaWNvblVybC5hYnNvbHV0ZSA/IGljb25VcmwudXJsIDogJycpICsgJyMnICsgY29uZmlnLmljb25QcmVmaXg7XG5cbiAgICAgICAgICAgIC8vIExhcmdlciBvdmVybGFpZCBwbGF5IGJ1dHRvblxuICAgICAgICAgICAgaWYgKF9pbkFycmF5KGNvbmZpZy5jb250cm9scywgJ3BsYXktbGFyZ2UnKSkge1xuICAgICAgICAgICAgICAgIGh0bWwucHVzaChcbiAgICAgICAgICAgICAgICAgICAgJzxidXR0b24gdHlwZT1cImJ1dHRvblwiIGRhdGEtcGx5cj1cInBsYXlcIiBjbGFzcz1cInBseXJfX3BsYXktbGFyZ2VcIj4nLFxuICAgICAgICAgICAgICAgICAgICAgICAgJzxzdmc+PHVzZSB4bGluazpocmVmPVwiJyArIGljb25QYXRoICsgJy1wbGF5XCIgLz48L3N2Zz4nLFxuICAgICAgICAgICAgICAgICAgICAgICAgJzxzcGFuIGNsYXNzPVwicGx5cl9fc3Itb25seVwiPicgKyBjb25maWcuaTE4bi5wbGF5ICsgJzwvc3Bhbj4nLFxuICAgICAgICAgICAgICAgICAgICAnPC9idXR0b24+J1xuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGh0bWwucHVzaCgnPGRpdiBjbGFzcz1cInBseXJfX2NvbnRyb2xzXCI+Jyk7XG5cbiAgICAgICAgICAgIC8vIFJlc3RhcnQgYnV0dG9uXG4gICAgICAgICAgICBpZiAoX2luQXJyYXkoY29uZmlnLmNvbnRyb2xzLCAncmVzdGFydCcpKSB7XG4gICAgICAgICAgICAgICAgaHRtbC5wdXNoKFxuICAgICAgICAgICAgICAgICAgICAnPGJ1dHRvbiB0eXBlPVwiYnV0dG9uXCIgZGF0YS1wbHlyPVwicmVzdGFydFwiPicsXG4gICAgICAgICAgICAgICAgICAgICAgICAnPHN2Zz48dXNlIHhsaW5rOmhyZWY9XCInICsgaWNvblBhdGggKyAnLXJlc3RhcnRcIiAvPjwvc3ZnPicsXG4gICAgICAgICAgICAgICAgICAgICAgICAnPHNwYW4gY2xhc3M9XCJwbHlyX19zci1vbmx5XCI+JyArIGNvbmZpZy5pMThuLnJlc3RhcnQgKyAnPC9zcGFuPicsXG4gICAgICAgICAgICAgICAgICAgICc8L2J1dHRvbj4nXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gUmV3aW5kIGJ1dHRvblxuICAgICAgICAgICAgaWYgKF9pbkFycmF5KGNvbmZpZy5jb250cm9scywgJ3Jld2luZCcpKSB7XG4gICAgICAgICAgICAgICAgaHRtbC5wdXNoKFxuICAgICAgICAgICAgICAgICAgICAnPGJ1dHRvbiB0eXBlPVwiYnV0dG9uXCIgZGF0YS1wbHlyPVwicmV3aW5kXCI+JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICc8c3ZnPjx1c2UgeGxpbms6aHJlZj1cIicgKyBpY29uUGF0aCArICctcmV3aW5kXCIgLz48L3N2Zz4nLFxuICAgICAgICAgICAgICAgICAgICAgICAgJzxzcGFuIGNsYXNzPVwicGx5cl9fc3Itb25seVwiPicgKyBjb25maWcuaTE4bi5yZXdpbmQgKyAnPC9zcGFuPicsXG4gICAgICAgICAgICAgICAgICAgICc8L2J1dHRvbj4nXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gUGxheSBQYXVzZSBidXR0b25cbiAgICAgICAgICAgIC8vIFRPRE86IFRoaXMgc2hvdWxkIGJlIGEgdG9nZ2xlIGJ1dHRvbiByZWFsbHk/XG4gICAgICAgICAgICBpZiAoX2luQXJyYXkoY29uZmlnLmNvbnRyb2xzLCAncGxheScpKSB7XG4gICAgICAgICAgICAgICAgaHRtbC5wdXNoKFxuICAgICAgICAgICAgICAgICAgICAnPGJ1dHRvbiB0eXBlPVwiYnV0dG9uXCIgZGF0YS1wbHlyPVwicGxheVwiPicsXG4gICAgICAgICAgICAgICAgICAgICAgICAnPHN2Zz48dXNlIHhsaW5rOmhyZWY9XCInICsgaWNvblBhdGggKyAnLXBsYXlcIiAvPjwvc3ZnPicsXG4gICAgICAgICAgICAgICAgICAgICAgICAnPHNwYW4gY2xhc3M9XCJwbHlyX19zci1vbmx5XCI+JyArIGNvbmZpZy5pMThuLnBsYXkgKyAnPC9zcGFuPicsXG4gICAgICAgICAgICAgICAgICAgICc8L2J1dHRvbj4nLFxuICAgICAgICAgICAgICAgICAgICAnPGJ1dHRvbiB0eXBlPVwiYnV0dG9uXCIgZGF0YS1wbHlyPVwicGF1c2VcIj4nLFxuICAgICAgICAgICAgICAgICAgICAgICAgJzxzdmc+PHVzZSB4bGluazpocmVmPVwiJyArIGljb25QYXRoICsgJy1wYXVzZVwiIC8+PC9zdmc+JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICc8c3BhbiBjbGFzcz1cInBseXJfX3NyLW9ubHlcIj4nICsgY29uZmlnLmkxOG4ucGF1c2UgKyAnPC9zcGFuPicsXG4gICAgICAgICAgICAgICAgICAgICc8L2J1dHRvbj4nXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gRmFzdCBmb3J3YXJkIGJ1dHRvblxuICAgICAgICAgICAgaWYgKF9pbkFycmF5KGNvbmZpZy5jb250cm9scywgJ2Zhc3QtZm9yd2FyZCcpKSB7XG4gICAgICAgICAgICAgICAgaHRtbC5wdXNoKFxuICAgICAgICAgICAgICAgICAgICAnPGJ1dHRvbiB0eXBlPVwiYnV0dG9uXCIgZGF0YS1wbHlyPVwiZmFzdC1mb3J3YXJkXCI+JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICc8c3ZnPjx1c2UgeGxpbms6aHJlZj1cIicgKyBpY29uUGF0aCArICctZmFzdC1mb3J3YXJkXCIgLz48L3N2Zz4nLFxuICAgICAgICAgICAgICAgICAgICAgICAgJzxzcGFuIGNsYXNzPVwicGx5cl9fc3Itb25seVwiPicgKyBjb25maWcuaTE4bi5mb3J3YXJkICsgJzwvc3Bhbj4nLFxuICAgICAgICAgICAgICAgICAgICAnPC9idXR0b24+J1xuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIFByb2dyZXNzXG4gICAgICAgICAgICBpZiAoX2luQXJyYXkoY29uZmlnLmNvbnRyb2xzLCAncHJvZ3Jlc3MnKSkge1xuICAgICAgICAgICAgICAgIC8vIENyZWF0ZSBwcm9ncmVzc1xuICAgICAgICAgICAgICAgIGh0bWwucHVzaCgnPHNwYW4gY2xhc3M9XCJwbHlyX19wcm9ncmVzc1wiPicsXG4gICAgICAgICAgICAgICAgICAgICc8bGFiZWwgZm9yPVwic2Vla3tpZH1cIiBjbGFzcz1cInBseXJfX3NyLW9ubHlcIj5TZWVrPC9sYWJlbD4nLFxuICAgICAgICAgICAgICAgICAgICAnPGlucHV0IGlkPVwic2Vla3tpZH1cIiBjbGFzcz1cInBseXJfX3Byb2dyZXNzLS1zZWVrXCIgdHlwZT1cInJhbmdlXCIgbWluPVwiMFwiIG1heD1cIjEwMFwiIHN0ZXA9XCIwLjFcIiB2YWx1ZT1cIjBcIiBkYXRhLXBseXI9XCJzZWVrXCI+JyxcbiAgICAgICAgICAgICAgICAgICAgJzxwcm9ncmVzcyBjbGFzcz1cInBseXJfX3Byb2dyZXNzLS1wbGF5ZWRcIiBtYXg9XCIxMDBcIiB2YWx1ZT1cIjBcIiByb2xlPVwicHJlc2VudGF0aW9uXCI+PC9wcm9ncmVzcz4nLFxuICAgICAgICAgICAgICAgICAgICAnPHByb2dyZXNzIGNsYXNzPVwicGx5cl9fcHJvZ3Jlc3MtLWJ1ZmZlclwiIG1heD1cIjEwMFwiIHZhbHVlPVwiMFwiPicsXG4gICAgICAgICAgICAgICAgICAgICAgICAnPHNwYW4+MDwvc3Bhbj4lICcgKyBjb25maWcuaTE4bi5idWZmZXJlZCxcbiAgICAgICAgICAgICAgICAgICAgJzwvcHJvZ3Jlc3M+Jyk7XG5cbiAgICAgICAgICAgICAgICAvLyBTZWVrIHRvb2x0aXBcbiAgICAgICAgICAgICAgICBpZiAoY29uZmlnLnRvb2x0aXBzLnNlZWspIHtcbiAgICAgICAgICAgICAgICAgICAgaHRtbC5wdXNoKCc8c3BhbiBjbGFzcz1cInBseXJfX3Rvb2x0aXBcIj4wMDowMDwvc3Bhbj4nKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBDbG9zZVxuICAgICAgICAgICAgICAgIGh0bWwucHVzaCgnPC9zcGFuPicpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBNZWRpYSBjdXJyZW50IHRpbWUgZGlzcGxheVxuICAgICAgICAgICAgaWYgKF9pbkFycmF5KGNvbmZpZy5jb250cm9scywgJ2N1cnJlbnQtdGltZScpKSB7XG4gICAgICAgICAgICAgICAgaHRtbC5wdXNoKFxuICAgICAgICAgICAgICAgICAgICAnPHNwYW4gY2xhc3M9XCJwbHlyX190aW1lXCI+JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICc8c3BhbiBjbGFzcz1cInBseXJfX3NyLW9ubHlcIj4nICsgY29uZmlnLmkxOG4uY3VycmVudFRpbWUgKyAnPC9zcGFuPicsXG4gICAgICAgICAgICAgICAgICAgICAgICAnPHNwYW4gY2xhc3M9XCJwbHlyX190aW1lLS1jdXJyZW50XCI+MDA6MDA8L3NwYW4+JyxcbiAgICAgICAgICAgICAgICAgICAgJzwvc3Bhbj4nXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gTWVkaWEgZHVyYXRpb24gZGlzcGxheVxuICAgICAgICAgICAgaWYgKF9pbkFycmF5KGNvbmZpZy5jb250cm9scywgJ2R1cmF0aW9uJykpIHtcbiAgICAgICAgICAgICAgICBodG1sLnB1c2goXG4gICAgICAgICAgICAgICAgICAgICc8c3BhbiBjbGFzcz1cInBseXJfX3RpbWVcIj4nLFxuICAgICAgICAgICAgICAgICAgICAgICAgJzxzcGFuIGNsYXNzPVwicGx5cl9fc3Itb25seVwiPicgKyBjb25maWcuaTE4bi5kdXJhdGlvbiArICc8L3NwYW4+JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICc8c3BhbiBjbGFzcz1cInBseXJfX3RpbWUtLWR1cmF0aW9uXCI+MDA6MDA8L3NwYW4+JyxcbiAgICAgICAgICAgICAgICAgICAgJzwvc3Bhbj4nXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gVG9nZ2xlIG11dGUgYnV0dG9uXG4gICAgICAgICAgICBpZiAoX2luQXJyYXkoY29uZmlnLmNvbnRyb2xzLCAnbXV0ZScpKSB7XG4gICAgICAgICAgICAgICAgaHRtbC5wdXNoKFxuICAgICAgICAgICAgICAgICAgICAnPGJ1dHRvbiB0eXBlPVwiYnV0dG9uXCIgZGF0YS1wbHlyPVwibXV0ZVwiPicsXG4gICAgICAgICAgICAgICAgICAgICAgICAnPHN2ZyBjbGFzcz1cImljb24tLW11dGVkXCI+PHVzZSB4bGluazpocmVmPVwiJyArIGljb25QYXRoICsgJy1tdXRlZFwiIC8+PC9zdmc+JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICc8c3ZnPjx1c2UgeGxpbms6aHJlZj1cIicgKyBpY29uUGF0aCArICctdm9sdW1lXCIgLz48L3N2Zz4nLFxuICAgICAgICAgICAgICAgICAgICAgICAgJzxzcGFuIGNsYXNzPVwicGx5cl9fc3Itb25seVwiPicgKyBjb25maWcuaTE4bi50b2dnbGVNdXRlICsgJzwvc3Bhbj4nLFxuICAgICAgICAgICAgICAgICAgICAnPC9idXR0b24+J1xuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIFZvbHVtZSByYW5nZSBjb250cm9sXG4gICAgICAgICAgICBpZiAoX2luQXJyYXkoY29uZmlnLmNvbnRyb2xzLCAndm9sdW1lJykpIHtcbiAgICAgICAgICAgICAgICBodG1sLnB1c2goXG4gICAgICAgICAgICAgICAgICAgICc8c3BhbiBjbGFzcz1cInBseXJfX3ZvbHVtZVwiPicsXG4gICAgICAgICAgICAgICAgICAgICAgICAnPGxhYmVsIGZvcj1cInZvbHVtZXtpZH1cIiBjbGFzcz1cInBseXJfX3NyLW9ubHlcIj4nICsgY29uZmlnLmkxOG4udm9sdW1lICsgJzwvbGFiZWw+JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICc8aW5wdXQgaWQ9XCJ2b2x1bWV7aWR9XCIgY2xhc3M9XCJwbHlyX192b2x1bWUtLWlucHV0XCIgdHlwZT1cInJhbmdlXCIgbWluPVwiJyArIGNvbmZpZy52b2x1bWVNaW4gKyAnXCIgbWF4PVwiJyArIGNvbmZpZy52b2x1bWVNYXggKyAnXCIgdmFsdWU9XCInICsgY29uZmlnLnZvbHVtZSArICdcIiBkYXRhLXBseXI9XCJ2b2x1bWVcIj4nLFxuICAgICAgICAgICAgICAgICAgICAgICAgJzxwcm9ncmVzcyBjbGFzcz1cInBseXJfX3ZvbHVtZS0tZGlzcGxheVwiIG1heD1cIicgKyBjb25maWcudm9sdW1lTWF4ICsgJ1wiIHZhbHVlPVwiJyArIGNvbmZpZy52b2x1bWVNaW4gKyAnXCIgcm9sZT1cInByZXNlbnRhdGlvblwiPjwvcHJvZ3Jlc3M+JyxcbiAgICAgICAgICAgICAgICAgICAgJzwvc3Bhbj4nXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gVG9nZ2xlIGNhcHRpb25zIGJ1dHRvblxuICAgICAgICAgICAgaWYgKF9pbkFycmF5KGNvbmZpZy5jb250cm9scywgJ2NhcHRpb25zJykpIHtcbiAgICAgICAgICAgICAgICBodG1sLnB1c2goXG4gICAgICAgICAgICAgICAgICAgICc8YnV0dG9uIHR5cGU9XCJidXR0b25cIiBkYXRhLXBseXI9XCJjYXB0aW9uc1wiPicsXG4gICAgICAgICAgICAgICAgICAgICAgICAnPHN2ZyBjbGFzcz1cImljb24tLWNhcHRpb25zLW9uXCI+PHVzZSB4bGluazpocmVmPVwiJyArIGljb25QYXRoICsgJy1jYXB0aW9ucy1vblwiIC8+PC9zdmc+JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICc8c3ZnPjx1c2UgeGxpbms6aHJlZj1cIicgKyBpY29uUGF0aCsgJy1jYXB0aW9ucy1vZmZcIiAvPjwvc3ZnPicsXG4gICAgICAgICAgICAgICAgICAgICAgICAnPHNwYW4gY2xhc3M9XCJwbHlyX19zci1vbmx5XCI+JyArIGNvbmZpZy5pMThuLnRvZ2dsZUNhcHRpb25zICsgJzwvc3Bhbj4nLFxuICAgICAgICAgICAgICAgICAgICAnPC9idXR0b24+J1xuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIFRvZ2dsZSBmdWxsc2NyZWVuIGJ1dHRvblxuICAgICAgICAgICAgaWYgKF9pbkFycmF5KGNvbmZpZy5jb250cm9scywgJ2Z1bGxzY3JlZW4nKSkge1xuICAgICAgICAgICAgICAgIGh0bWwucHVzaChcbiAgICAgICAgICAgICAgICAgICAgJzxidXR0b24gdHlwZT1cImJ1dHRvblwiIGRhdGEtcGx5cj1cImZ1bGxzY3JlZW5cIj4nLFxuICAgICAgICAgICAgICAgICAgICAgICAgJzxzdmcgY2xhc3M9XCJpY29uLS1leGl0LWZ1bGxzY3JlZW5cIj48dXNlIHhsaW5rOmhyZWY9XCInICsgaWNvblBhdGggKyAnLWV4aXQtZnVsbHNjcmVlblwiIC8+PC9zdmc+JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICc8c3ZnPjx1c2UgeGxpbms6aHJlZj1cIicgKyBpY29uUGF0aCArICctZW50ZXItZnVsbHNjcmVlblwiIC8+PC9zdmc+JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICc8c3BhbiBjbGFzcz1cInBseXJfX3NyLW9ubHlcIj4nICsgY29uZmlnLmkxOG4udG9nZ2xlRnVsbHNjcmVlbiArICc8L3NwYW4+JyxcbiAgICAgICAgICAgICAgICAgICAgJzwvYnV0dG9uPidcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBDbG9zZSBldmVyeXRoaW5nXG4gICAgICAgICAgICBodG1sLnB1c2goJzwvZGl2PicpO1xuXG4gICAgICAgICAgICByZXR1cm4gaHRtbC5qb2luKCcnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFNldHVwIGZ1bGxzY3JlZW5cbiAgICAgICAgZnVuY3Rpb24gX3NldHVwRnVsbHNjcmVlbigpIHtcbiAgICAgICAgICAgIGlmICghcGx5ci5zdXBwb3J0ZWQuZnVsbCkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKChwbHlyLnR5cGUgIT09ICdhdWRpbycgfHwgY29uZmlnLmZ1bGxzY3JlZW4uYWxsb3dBdWRpbykgJiYgY29uZmlnLmZ1bGxzY3JlZW4uZW5hYmxlZCkge1xuICAgICAgICAgICAgICAgIC8vIENoZWNrIGZvciBuYXRpdmUgc3VwcG9ydFxuICAgICAgICAgICAgICAgIHZhciBuYXRpdmVTdXBwb3J0ID0gZnVsbHNjcmVlbi5zdXBwb3J0c0Z1bGxTY3JlZW47XG5cbiAgICAgICAgICAgICAgICBpZiAobmF0aXZlU3VwcG9ydCB8fCAoY29uZmlnLmZ1bGxzY3JlZW4uZmFsbGJhY2sgJiYgIV9pbkZyYW1lKCkpKSB7XG4gICAgICAgICAgICAgICAgICAgIF9sb2coKG5hdGl2ZVN1cHBvcnQgPyAnTmF0aXZlJyA6ICdGYWxsYmFjaycpICsgJyBmdWxsc2NyZWVuIGVuYWJsZWQnKTtcblxuICAgICAgICAgICAgICAgICAgICAvLyBBZGQgc3R5bGluZyBob29rXG4gICAgICAgICAgICAgICAgICAgIF90b2dnbGVDbGFzcyhwbHlyLmNvbnRhaW5lciwgY29uZmlnLmNsYXNzZXMuZnVsbHNjcmVlbi5lbmFibGVkLCB0cnVlKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBfbG9nKCdGdWxsc2NyZWVuIG5vdCBzdXBwb3J0ZWQgYW5kIGZhbGxiYWNrIGRpc2FibGVkJyk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gVG9nZ2xlIHN0YXRlXG4gICAgICAgICAgICAgICAgaWYgKHBseXIuYnV0dG9ucyAmJiBwbHlyLmJ1dHRvbnMuZnVsbHNjcmVlbikge1xuICAgICAgICAgICAgICAgICAgICBfdG9nZ2xlU3RhdGUocGx5ci5idXR0b25zLmZ1bGxzY3JlZW4sIGZhbHNlKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBTZXR1cCBmb2N1cyB0cmFwXG4gICAgICAgICAgICAgICAgX2ZvY3VzVHJhcCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gU2V0dXAgY2FwdGlvbnNcbiAgICAgICAgZnVuY3Rpb24gX3NldHVwQ2FwdGlvbnMoKSB7XG4gICAgICAgICAgICAvLyBCYWlsIGlmIG5vdCBIVE1MNSB2aWRlb1xuICAgICAgICAgICAgaWYgKHBseXIudHlwZSAhPT0gJ3ZpZGVvJykge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gSW5qZWN0IHRoZSBjb250YWluZXJcbiAgICAgICAgICAgIGlmICghX2dldEVsZW1lbnQoY29uZmlnLnNlbGVjdG9ycy5jYXB0aW9ucykpIHtcbiAgICAgICAgICAgICAgICBwbHlyLnZpZGVvQ29udGFpbmVyLmluc2VydEFkamFjZW50SFRNTCgnYWZ0ZXJiZWdpbicsICc8ZGl2IGNsYXNzPVwiJyArIF9nZXRDbGFzc25hbWUoY29uZmlnLnNlbGVjdG9ycy5jYXB0aW9ucykgKyAnXCI+PC9kaXY+Jyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIERldGVybWluZSBpZiBIVE1MNSB0ZXh0VHJhY2tzIGlzIHN1cHBvcnRlZFxuICAgICAgICAgICAgcGx5ci51c2luZ1RleHRUcmFja3MgPSBmYWxzZTtcbiAgICAgICAgICAgIGlmIChwbHlyLm1lZGlhLnRleHRUcmFja3MpIHtcbiAgICAgICAgICAgICAgICBwbHlyLnVzaW5nVGV4dFRyYWNrcyA9IHRydWU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIEdldCBVUkwgb2YgY2FwdGlvbiBmaWxlIGlmIGV4aXN0c1xuICAgICAgICAgICAgdmFyIGNhcHRpb25TcmMgPSAnJyxcbiAgICAgICAgICAgICAgICBraW5kLFxuICAgICAgICAgICAgICAgIGNoaWxkcmVuID0gcGx5ci5tZWRpYS5jaGlsZE5vZGVzO1xuXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNoaWxkcmVuLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgaWYgKGNoaWxkcmVuW2ldLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkgPT09ICd0cmFjaycpIHtcbiAgICAgICAgICAgICAgICAgICAga2luZCA9IGNoaWxkcmVuW2ldLmtpbmQ7XG4gICAgICAgICAgICAgICAgICAgIGlmIChraW5kID09PSAnY2FwdGlvbnMnIHx8IGtpbmQgPT09ICdzdWJ0aXRsZXMnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXB0aW9uU3JjID0gY2hpbGRyZW5baV0uZ2V0QXR0cmlidXRlKCdzcmMnKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gUmVjb3JkIGlmIGNhcHRpb24gZmlsZSBleGlzdHMgb3Igbm90XG4gICAgICAgICAgICBwbHlyLmNhcHRpb25FeGlzdHMgPSB0cnVlO1xuICAgICAgICAgICAgaWYgKGNhcHRpb25TcmMgPT09ICcnKSB7XG4gICAgICAgICAgICAgICAgcGx5ci5jYXB0aW9uRXhpc3RzID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgX2xvZygnTm8gY2FwdGlvbiB0cmFjayBmb3VuZCcpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBfbG9nKCdDYXB0aW9uIHRyYWNrIGZvdW5kOyBVUkk6ICcgKyBjYXB0aW9uU3JjKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gSWYgbm8gY2FwdGlvbiBmaWxlIGV4aXN0cywgaGlkZSBjb250YWluZXIgZm9yIGNhcHRpb24gdGV4dFxuICAgICAgICAgICAgaWYgKCFwbHlyLmNhcHRpb25FeGlzdHMpIHtcbiAgICAgICAgICAgICAgICBfdG9nZ2xlQ2xhc3MocGx5ci5jb250YWluZXIsIGNvbmZpZy5jbGFzc2VzLmNhcHRpb25zLmVuYWJsZWQpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyBUdXJuIG9mZiBuYXRpdmUgY2FwdGlvbiByZW5kZXJpbmcgdG8gYXZvaWQgZG91YmxlIGNhcHRpb25zXG4gICAgICAgICAgICAgICAgLy8gVGhpcyBkb2Vzbid0IHNlZW0gdG8gd29yayBpbiBTYWZhcmkgNyssIHNvIHRoZSA8dHJhY2s+IGVsZW1lbnRzIGFyZSByZW1vdmVkIGZyb20gdGhlIGRvbSBiZWxvd1xuICAgICAgICAgICAgICAgIHZhciB0cmFja3MgPSBwbHlyLm1lZGlhLnRleHRUcmFja3M7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgeCA9IDA7IHggPCB0cmFja3MubGVuZ3RoOyB4KyspIHtcbiAgICAgICAgICAgICAgICAgICAgdHJhY2tzW3hdLm1vZGUgPSAnaGlkZGVuJztcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBFbmFibGUgVUlcbiAgICAgICAgICAgICAgICBfc2hvd0NhcHRpb25zKHBseXIpO1xuXG4gICAgICAgICAgICAgICAgLy8gRGlzYWJsZSB1bnN1cHBvcnRlZCBicm93c2VycyB0aGFuIHJlcG9ydCBmYWxzZSBwb3NpdGl2ZVxuICAgICAgICAgICAgICAgIC8vIEZpcmVmb3ggYnVnOiBodHRwczovL2J1Z3ppbGxhLm1vemlsbGEub3JnL3Nob3dfYnVnLmNnaT9pZD0xMDMzMTQ0XG4gICAgICAgICAgICAgICAgaWYgKChwbHlyLmJyb3dzZXIuaXNJRSAmJiBwbHlyLmJyb3dzZXIudmVyc2lvbiA+PSAxMCkgfHxcbiAgICAgICAgICAgICAgICAgICAgKHBseXIuYnJvd3Nlci5pc0ZpcmVmb3ggJiYgcGx5ci5icm93c2VyLnZlcnNpb24gPj0gMzEpKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gRGVidWdnaW5nXG4gICAgICAgICAgICAgICAgICAgIF9sb2coJ0RldGVjdGVkIGJyb3dzZXIgd2l0aCBrbm93biBUZXh0VHJhY2sgaXNzdWVzIC0gdXNpbmcgbWFudWFsIGZhbGxiYWNrJyk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gU2V0IHRvIGZhbHNlIHNvIHNraXBzIHRvICdtYW51YWwnIGNhcHRpb25pbmdcbiAgICAgICAgICAgICAgICAgICAgcGx5ci51c2luZ1RleHRUcmFja3MgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBSZW5kZXJpbmcgY2FwdGlvbiB0cmFja3NcbiAgICAgICAgICAgICAgICAvLyBOYXRpdmUgc3VwcG9ydCByZXF1aXJlZCAtIGh0dHA6Ly9jYW5pdXNlLmNvbS93ZWJ2dHRcbiAgICAgICAgICAgICAgICBpZiAocGx5ci51c2luZ1RleHRUcmFja3MpIHtcbiAgICAgICAgICAgICAgICAgICAgX2xvZygnVGV4dFRyYWNrcyBzdXBwb3J0ZWQnKTtcblxuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciB5ID0gMDsgeSA8IHRyYWNrcy5sZW5ndGg7IHkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRyYWNrID0gdHJhY2tzW3ldO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodHJhY2sua2luZCA9PT0gJ2NhcHRpb25zJyB8fCB0cmFjay5raW5kID09PSAnc3VidGl0bGVzJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9vbih0cmFjaywgJ2N1ZWNoYW5nZScsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBEaXNwbGF5IGEgY3VlLCBpZiB0aGVyZSBpcyBvbmVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuYWN0aXZlQ3Vlc1swXSAmJiAndGV4dCcgaW4gdGhpcy5hY3RpdmVDdWVzWzBdKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfc2V0Q2FwdGlvbih0aGlzLmFjdGl2ZUN1ZXNbMF0uZ2V0Q3VlQXNIVE1MKCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3NldENhcHRpb24oKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gQ2FwdGlvbiB0cmFja3Mgbm90IG5hdGl2ZWx5IHN1cHBvcnRlZFxuICAgICAgICAgICAgICAgICAgICBfbG9nKCdUZXh0VHJhY2tzIG5vdCBzdXBwb3J0ZWQgc28gcmVuZGVyaW5nIGNhcHRpb25zIG1hbnVhbGx5Jyk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gUmVuZGVyIGNhcHRpb25zIGZyb20gYXJyYXkgYXQgYXBwcm9wcmlhdGUgdGltZVxuICAgICAgICAgICAgICAgICAgICBwbHlyLmN1cnJlbnRDYXB0aW9uID0gJyc7XG4gICAgICAgICAgICAgICAgICAgIHBseXIuY2FwdGlvbnMgPSBbXTtcblxuICAgICAgICAgICAgICAgICAgICBpZiAoY2FwdGlvblNyYyAhPT0gJycpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIENyZWF0ZSBYTUxIdHRwUmVxdWVzdCBPYmplY3RcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB4aHIgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgeGhyLm9ucmVhZHlzdGF0ZWNoYW5nZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh4aHIucmVhZHlTdGF0ZSA9PT0gNCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoeGhyLnN0YXR1cyA9PT0gMjAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY2FwdGlvbnMgPSBbXSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXB0aW9uLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcSA9IHhoci5yZXNwb25zZVRleHQ7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vQWNjb3JkaW5nIHRvIHdlYnZ0dCBzcGVjLCBsaW5lIHRlcm1pbmF0b3IgY29uc2lzdHMgb2Ygb25lIG9mIHRoZSBmb2xsb3dpbmdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIENSTEYgKFUrMDAwRCBVKzAwMEEpLCBMRiAoVSswMDBBKSBvciBDUiAoVSswMDBEKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGxpbmVTZXBhcmF0b3IgPSAnXFxyXFxuJztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHJlcS5pbmRleE9mKGxpbmVTZXBhcmF0b3IrbGluZVNlcGFyYXRvcikgPT09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYocmVxLmluZGV4T2YoJ1xcclxccicpICE9PSAtMSl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpbmVTZXBhcmF0b3IgPSAnXFxyJztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaW5lU2VwYXJhdG9yID0gJ1xcbic7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXB0aW9ucyA9IHJlcS5zcGxpdChsaW5lU2VwYXJhdG9yK2xpbmVTZXBhcmF0b3IpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciByID0gMDsgciA8IGNhcHRpb25zLmxlbmd0aDsgcisrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FwdGlvbiA9IGNhcHRpb25zW3JdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBseXIuY2FwdGlvbnNbcl0gPSBbXTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEdldCB0aGUgcGFydHMgb2YgdGhlIGNhcHRpb25zXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBhcnRzID0gY2FwdGlvbi5zcGxpdChsaW5lU2VwYXJhdG9yKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5kZXggPSAwO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gSW5jYXNlIGNhcHRpb24gbnVtYmVycyBhcmUgYWRkZWRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocGFydHNbaW5kZXhdLmluZGV4T2YoXCI6XCIpID09PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmRleCA9IDE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGx5ci5jYXB0aW9uc1tyXSA9IFtwYXJ0c1tpbmRleF0sIHBhcnRzW2luZGV4ICsgMV1dO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBSZW1vdmUgZmlyc3QgZWxlbWVudCAoJ1ZUVCcpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbHlyLmNhcHRpb25zLnNoaWZ0KCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9sb2coJ1N1Y2Nlc3NmdWxseSBsb2FkZWQgdGhlIGNhcHRpb24gZmlsZSB2aWEgQUpBWCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3dhcm4oY29uZmlnLmxvZ1ByZWZpeCArICdUaGVyZSB3YXMgYSBwcm9ibGVtIGxvYWRpbmcgdGhlIGNhcHRpb24gZmlsZSB2aWEgQUpBWCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgeGhyLm9wZW4oJ2dldCcsIGNhcHRpb25TcmMsIHRydWUpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB4aHIuc2VuZCgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gU2V0IHRoZSBjdXJyZW50IGNhcHRpb25cbiAgICAgICAgZnVuY3Rpb24gX3NldENhcHRpb24oY2FwdGlvbikge1xuICAgICAgICAgICAgLyoganNoaW50IHVudXNlZDpmYWxzZSAqL1xuICAgICAgICAgICAgdmFyIGNvbnRhaW5lciA9IF9nZXRFbGVtZW50KGNvbmZpZy5zZWxlY3RvcnMuY2FwdGlvbnMpLFxuICAgICAgICAgICAgICAgIGNvbnRlbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XG5cbiAgICAgICAgICAgIC8vIEVtcHR5IHRoZSBjb250YWluZXJcbiAgICAgICAgICAgIGNvbnRhaW5lci5pbm5lckhUTUwgPSAnJztcblxuICAgICAgICAgICAgLy8gRGVmYXVsdCB0byBlbXB0eVxuICAgICAgICAgICAgaWYgKF9pcy51bmRlZmluZWQoY2FwdGlvbikpIHtcbiAgICAgICAgICAgICAgICBjYXB0aW9uID0gJyc7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIFNldCB0aGUgc3BhbiBjb250ZW50XG4gICAgICAgICAgICBpZiAoX2lzLnN0cmluZyhjYXB0aW9uKSkge1xuICAgICAgICAgICAgICAgIGNvbnRlbnQuaW5uZXJIVE1MID0gY2FwdGlvbi50cmltKCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnRlbnQuYXBwZW5kQ2hpbGQoY2FwdGlvbik7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIFNldCBuZXcgY2FwdGlvbiB0ZXh0XG4gICAgICAgICAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQoY29udGVudCk7XG5cbiAgICAgICAgICAgIC8vIEZvcmNlIHJlZHJhdyAoZm9yIFNhZmFyaSlcbiAgICAgICAgICAgIHZhciByZWRyYXcgPSBjb250YWluZXIub2Zmc2V0SGVpZ2h0O1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQ2FwdGlvbnMgZnVuY3Rpb25zXG4gICAgICAgIC8vIFNlZWsgdGhlIG1hbnVhbCBjYXB0aW9uIHRpbWUgYW5kIHVwZGF0ZSBVSVxuICAgICAgICBmdW5jdGlvbiBfc2Vla01hbnVhbENhcHRpb25zKHRpbWUpIHtcbiAgICAgICAgICAgIC8vIFV0aWxpdGllcyBmb3IgY2FwdGlvbiB0aW1lIGNvZGVzXG4gICAgICAgICAgICBmdW5jdGlvbiBfdGltZWNvZGVDb21tb24odGMsIHBvcykge1xuICAgICAgICAgICAgICAgIHZhciB0Y3BhaXIgPSBbXTtcbiAgICAgICAgICAgICAgICB0Y3BhaXIgPSB0Yy5zcGxpdCgnIC0tPiAnKTtcbiAgICAgICAgICAgICAgICBmb3IodmFyIGkgPSAwOyBpIDwgdGNwYWlyLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFdlYlZUVCBhbGxvd3MgZm9yIGV4dHJhIG1ldGEgZGF0YSBhZnRlciB0aGUgdGltZXN0YW1wIGxpbmVcbiAgICAgICAgICAgICAgICAgICAgLy8gU28gZ2V0IHJpZCBvZiB0aGlzIGlmIGl0IGV4aXN0c1xuICAgICAgICAgICAgICAgICAgICB0Y3BhaXJbaV0gPSB0Y3BhaXJbaV0ucmVwbGFjZSgvKFxcZCs6XFxkKzpcXGQrXFwuXFxkKykuKi8sIFwiJDFcIik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBfc3ViVGNTZWNzKHRjcGFpcltwb3NdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZ1bmN0aW9uIF90aW1lY29kZU1pbih0Yykge1xuICAgICAgICAgICAgICAgIHJldHVybiBfdGltZWNvZGVDb21tb24odGMsIDApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZnVuY3Rpb24gX3RpbWVjb2RlTWF4KHRjKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF90aW1lY29kZUNvbW1vbih0YywgMSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmdW5jdGlvbiBfc3ViVGNTZWNzKHRjKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRjID09PSBudWxsIHx8IHRjID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRjMSA9IFtdLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGMyID0gW10sXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWNvbmRzO1xuICAgICAgICAgICAgICAgICAgICB0YzEgPSB0Yy5zcGxpdCgnLCcpO1xuICAgICAgICAgICAgICAgICAgICB0YzIgPSB0YzFbMF0uc3BsaXQoJzonKTtcbiAgICAgICAgICAgICAgICAgICAgc2Vjb25kcyA9IE1hdGguZmxvb3IodGMyWzBdKjYwKjYwKSArIE1hdGguZmxvb3IodGMyWzFdKjYwKSArIE1hdGguZmxvb3IodGMyWzJdKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHNlY29uZHM7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBJZiBpdCdzIG5vdCB2aWRlbywgb3Igd2UncmUgdXNpbmcgdGV4dFRyYWNrcywgYmFpbC5cbiAgICAgICAgICAgIGlmIChwbHlyLnVzaW5nVGV4dFRyYWNrcyB8fCBwbHlyLnR5cGUgIT09ICd2aWRlbycgfHwgIXBseXIuc3VwcG9ydGVkLmZ1bGwpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIFJlc2V0IHN1YmNvdW50XG4gICAgICAgICAgICBwbHlyLnN1YmNvdW50ID0gMDtcblxuICAgICAgICAgICAgLy8gQ2hlY2sgdGltZSBpcyBhIG51bWJlciwgaWYgbm90IHVzZSBjdXJyZW50VGltZVxuICAgICAgICAgICAgLy8gSUUgaGFzIGEgYnVnIHdoZXJlIGN1cnJlbnRUaW1lIGRvZXNuJ3QgZ28gdG8gMFxuICAgICAgICAgICAgLy8gaHR0cHM6Ly90d2l0dGVyLmNvbS9TYW1fUG90dHMvc3RhdHVzLzU3MzcxNTc0NjUwNjczMTUyMVxuICAgICAgICAgICAgdGltZSA9IF9pcy5udW1iZXIodGltZSkgPyB0aW1lIDogcGx5ci5tZWRpYS5jdXJyZW50VGltZTtcblxuICAgICAgICAgICAgLy8gSWYgdGhlcmUncyBubyBzdWJzIGF2YWlsYWJsZSwgYmFpbFxuICAgICAgICAgICAgaWYgKCFwbHlyLmNhcHRpb25zW3BseXIuc3ViY291bnRdKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB3aGlsZSAoX3RpbWVjb2RlTWF4KHBseXIuY2FwdGlvbnNbcGx5ci5zdWJjb3VudF1bMF0pIDwgdGltZS50b0ZpeGVkKDEpKSB7XG4gICAgICAgICAgICAgICAgcGx5ci5zdWJjb3VudCsrO1xuICAgICAgICAgICAgICAgIGlmIChwbHlyLnN1YmNvdW50ID4gcGx5ci5jYXB0aW9ucy5sZW5ndGggLSAxKSB7XG4gICAgICAgICAgICAgICAgICAgIHBseXIuc3ViY291bnQgPSBwbHlyLmNhcHRpb25zLmxlbmd0aCAtIDE7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gQ2hlY2sgaWYgdGhlIG5leHQgY2FwdGlvbiBpcyBpbiB0aGUgY3VycmVudCB0aW1lIHJhbmdlXG4gICAgICAgICAgICBpZiAocGx5ci5tZWRpYS5jdXJyZW50VGltZS50b0ZpeGVkKDEpID49IF90aW1lY29kZU1pbihwbHlyLmNhcHRpb25zW3BseXIuc3ViY291bnRdWzBdKSAmJlxuICAgICAgICAgICAgICAgIHBseXIubWVkaWEuY3VycmVudFRpbWUudG9GaXhlZCgxKSA8PSBfdGltZWNvZGVNYXgocGx5ci5jYXB0aW9uc1twbHlyLnN1YmNvdW50XVswXSkpIHtcbiAgICAgICAgICAgICAgICAgICAgcGx5ci5jdXJyZW50Q2FwdGlvbiA9IHBseXIuY2FwdGlvbnNbcGx5ci5zdWJjb3VudF1bMV07XG5cbiAgICAgICAgICAgICAgICAvLyBSZW5kZXIgdGhlIGNhcHRpb25cbiAgICAgICAgICAgICAgICBfc2V0Q2FwdGlvbihwbHlyLmN1cnJlbnRDYXB0aW9uKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgX3NldENhcHRpb24oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIERpc3BsYXkgY2FwdGlvbnMgY29udGFpbmVyIGFuZCBidXR0b24gKGZvciBpbml0aWFsaXphdGlvbilcbiAgICAgICAgZnVuY3Rpb24gX3Nob3dDYXB0aW9ucygpIHtcbiAgICAgICAgICAgIC8vIElmIHRoZXJlJ3Mgbm8gY2FwdGlvbiB0b2dnbGUsIGJhaWxcbiAgICAgICAgICAgIGlmICghcGx5ci5idXR0b25zLmNhcHRpb25zKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBfdG9nZ2xlQ2xhc3MocGx5ci5jb250YWluZXIsIGNvbmZpZy5jbGFzc2VzLmNhcHRpb25zLmVuYWJsZWQsIHRydWUpO1xuXG4gICAgICAgICAgICAvLyBUcnkgdG8gbG9hZCB0aGUgdmFsdWUgZnJvbSBzdG9yYWdlXG4gICAgICAgICAgICB2YXIgYWN0aXZlID0gcGx5ci5zdG9yYWdlLmNhcHRpb25zRW5hYmxlZDtcblxuICAgICAgICAgICAgLy8gT3RoZXJ3aXNlIGZhbGwgYmFjayB0byB0aGUgZGVmYXVsdCBjb25maWdcbiAgICAgICAgICAgIGlmICghX2lzLmJvb2xlYW4oYWN0aXZlKSkge1xuICAgICAgICAgICAgICAgIGFjdGl2ZSA9IGNvbmZpZy5jYXB0aW9ucy5kZWZhdWx0QWN0aXZlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoYWN0aXZlKSB7XG4gICAgICAgICAgICAgICAgX3RvZ2dsZUNsYXNzKHBseXIuY29udGFpbmVyLCBjb25maWcuY2xhc3Nlcy5jYXB0aW9ucy5hY3RpdmUsIHRydWUpO1xuICAgICAgICAgICAgICAgIF90b2dnbGVTdGF0ZShwbHlyLmJ1dHRvbnMuY2FwdGlvbnMsIHRydWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gRmluZCBhbGwgZWxlbWVudHNcbiAgICAgICAgZnVuY3Rpb24gX2dldEVsZW1lbnRzKHNlbGVjdG9yKSB7XG4gICAgICAgICAgICByZXR1cm4gcGx5ci5jb250YWluZXIucXVlcnlTZWxlY3RvckFsbChzZWxlY3Rvcik7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBGaW5kIGEgc2luZ2xlIGVsZW1lbnRcbiAgICAgICAgZnVuY3Rpb24gX2dldEVsZW1lbnQoc2VsZWN0b3IpIHtcbiAgICAgICAgICAgIHJldHVybiBfZ2V0RWxlbWVudHMoc2VsZWN0b3IpWzBdO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gRGV0ZXJtaW5lIGlmIHdlJ3JlIGluIGFuIGlmcmFtZVxuICAgICAgICBmdW5jdGlvbiBfaW5GcmFtZSgpIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHdpbmRvdy5zZWxmICE9PSB3aW5kb3cudG9wO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFRyYXAgZm9jdXMgaW5zaWRlIGNvbnRhaW5lclxuICAgICAgICBmdW5jdGlvbiBfZm9jdXNUcmFwKCkge1xuICAgICAgICAgICAgdmFyIHRhYmJhYmxlcyAgID0gX2dldEVsZW1lbnRzKCdpbnB1dDpub3QoW2Rpc2FibGVkXSksIGJ1dHRvbjpub3QoW2Rpc2FibGVkXSknKSxcbiAgICAgICAgICAgICAgICBmaXJzdCAgICAgICA9IHRhYmJhYmxlc1swXSxcbiAgICAgICAgICAgICAgICBsYXN0ICAgICAgICA9IHRhYmJhYmxlc1t0YWJiYWJsZXMubGVuZ3RoIC0gMV07XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIF9jaGVja0ZvY3VzKGV2ZW50KSB7XG4gICAgICAgICAgICAgICAgLy8gSWYgaXQgaXMgVEFCXG4gICAgICAgICAgICAgICAgaWYgKGV2ZW50LndoaWNoID09PSA5ICYmIHBseXIuaXNGdWxsc2NyZWVuKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChldmVudC50YXJnZXQgPT09IGxhc3QgJiYgIWV2ZW50LnNoaWZ0S2V5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBNb3ZlIGZvY3VzIHRvIGZpcnN0IGVsZW1lbnQgdGhhdCBjYW4gYmUgdGFiYmVkIGlmIFNoaWZ0IGlzbid0IHVzZWRcbiAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBmaXJzdC5mb2N1cygpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGV2ZW50LnRhcmdldCA9PT0gZmlyc3QgJiYgZXZlbnQuc2hpZnRLZXkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIE1vdmUgZm9jdXMgdG8gbGFzdCBlbGVtZW50IHRoYXQgY2FuIGJlIHRhYmJlZCBpZiBTaGlmdCBpcyB1c2VkXG4gICAgICAgICAgICAgICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbGFzdC5mb2N1cygpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBCaW5kIHRoZSBoYW5kbGVyXG4gICAgICAgICAgICBfb24ocGx5ci5jb250YWluZXIsICdrZXlkb3duJywgX2NoZWNrRm9jdXMpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQWRkIGVsZW1lbnRzIHRvIEhUTUw1IG1lZGlhIChzb3VyY2UsIHRyYWNrcywgZXRjKVxuICAgICAgICBmdW5jdGlvbiBfaW5zZXJ0Q2hpbGRFbGVtZW50cyh0eXBlLCBhdHRyaWJ1dGVzKSB7XG4gICAgICAgICAgICBpZiAoX2lzLnN0cmluZyhhdHRyaWJ1dGVzKSkge1xuICAgICAgICAgICAgICAgX2luc2VydEVsZW1lbnQodHlwZSwgcGx5ci5tZWRpYSwgeyBzcmM6IGF0dHJpYnV0ZXMgfSk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGF0dHJpYnV0ZXMuY29uc3RydWN0b3IgPT09IEFycmF5KSB7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IGF0dHJpYnV0ZXMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgICAgICAgICAgICAgICAgX2luc2VydEVsZW1lbnQodHlwZSwgcGx5ci5tZWRpYSwgYXR0cmlidXRlc1tpXSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gSW5zZXJ0IGNvbnRyb2xzXG4gICAgICAgIGZ1bmN0aW9uIF9pbmplY3RDb250cm9scygpIHtcbiAgICAgICAgICAgIC8vIFNwcml0ZVxuICAgICAgICAgICAgaWYgKGNvbmZpZy5sb2FkU3ByaXRlKSB7XG4gICAgICAgICAgICAgICAgdmFyIGljb25VcmwgPSBfZ2V0SWNvblVybCgpO1xuXG4gICAgICAgICAgICAgICAgLy8gT25seSBsb2FkIGV4dGVybmFsIHNwcml0ZSB1c2luZyBBSkFYXG4gICAgICAgICAgICAgICAgaWYgKGljb25VcmwuYWJzb2x1dGUpIHtcbiAgICAgICAgICAgICAgICAgICAgX2xvZygnQUpBWCBsb2FkaW5nIGFic29sdXRlIFNWRyBzcHJpdGUnICsgKHBseXIuYnJvd3Nlci5pc0lFID8gJyAoZHVlIHRvIElFKScgOiAnJykpO1xuICAgICAgICAgICAgICAgICAgICBsb2FkU3ByaXRlKGljb25VcmwudXJsLCBcInNwcml0ZS1wbHlyXCIpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIF9sb2coJ1Nwcml0ZSB3aWxsIGJlIHVzZWQgYXMgZXh0ZXJuYWwgcmVzb3VyY2UgZGlyZWN0bHknKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIE1ha2UgYSBjb3B5IG9mIHRoZSBodG1sXG4gICAgICAgICAgICB2YXIgaHRtbCA9IGNvbmZpZy5odG1sO1xuXG4gICAgICAgICAgICAvLyBJbnNlcnQgY3VzdG9tIHZpZGVvIGNvbnRyb2xzXG4gICAgICAgICAgICBfbG9nKCdJbmplY3RpbmcgY3VzdG9tIGNvbnRyb2xzJyk7XG5cbiAgICAgICAgICAgIC8vIElmIG5vIGNvbnRyb2xzIGFyZSBzcGVjaWZpZWQsIGNyZWF0ZSBkZWZhdWx0XG4gICAgICAgICAgICBpZiAoIWh0bWwpIHtcbiAgICAgICAgICAgICAgICBodG1sID0gX2J1aWxkQ29udHJvbHMoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gUmVwbGFjZSBzZWVrIHRpbWUgaW5zdGFuY2VzXG4gICAgICAgICAgICBodG1sID0gX3JlcGxhY2VBbGwoaHRtbCwgJ3tzZWVrdGltZX0nLCBjb25maWcuc2Vla1RpbWUpO1xuXG4gICAgICAgICAgICAvLyBSZXBsYWNlIGFsbCBpZCByZWZlcmVuY2VzIHdpdGggcmFuZG9tIG51bWJlcnNcbiAgICAgICAgICAgIGh0bWwgPSBfcmVwbGFjZUFsbChodG1sLCAne2lkfScsIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqICgxMDAwMCkpKTtcblxuICAgICAgICAgICAgLy8gQ29udHJvbHMgY29udGFpbmVyXG4gICAgICAgICAgICB2YXIgdGFyZ2V0O1xuXG4gICAgICAgICAgICAvLyBJbmplY3QgdG8gY3VzdG9tIGxvY2F0aW9uXG4gICAgICAgICAgICBpZiAoX2lzLnN0cmluZyhjb25maWcuc2VsZWN0b3JzLmNvbnRyb2xzLmNvbnRhaW5lcikpIHtcbiAgICAgICAgICAgICAgICB0YXJnZXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNvbmZpZy5zZWxlY3RvcnMuY29udHJvbHMuY29udGFpbmVyKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gSW5qZWN0IGludG8gdGhlIGNvbnRhaW5lciBieSBkZWZhdWx0XG4gICAgICAgICAgICBpZiAoIV9pcy5odG1sRWxlbWVudCh0YXJnZXQpKSB7XG4gICAgICAgICAgICAgICAgdGFyZ2V0ID0gcGx5ci5jb250YWluZXJcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gSW5qZWN0IGNvbnRyb2xzIEhUTUxcbiAgICAgICAgICAgIHRhcmdldC5pbnNlcnRBZGphY2VudEhUTUwoJ2JlZm9yZWVuZCcsIGh0bWwpO1xuXG4gICAgICAgICAgICAvLyBTZXR1cCB0b29sdGlwc1xuICAgICAgICAgICAgaWYgKGNvbmZpZy50b29sdGlwcy5jb250cm9scykge1xuICAgICAgICAgICAgICAgIHZhciBsYWJlbHMgPSBfZ2V0RWxlbWVudHMoW2NvbmZpZy5zZWxlY3RvcnMuY29udHJvbHMud3JhcHBlciwgJyAnLCBjb25maWcuc2VsZWN0b3JzLmxhYmVscywgJyAuJywgY29uZmlnLmNsYXNzZXMuaGlkZGVuXS5qb2luKCcnKSk7XG5cbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gbGFiZWxzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBsYWJlbCA9IGxhYmVsc1tpXTtcblxuICAgICAgICAgICAgICAgICAgICBfdG9nZ2xlQ2xhc3MobGFiZWwsIGNvbmZpZy5jbGFzc2VzLmhpZGRlbiwgZmFsc2UpO1xuICAgICAgICAgICAgICAgICAgICBfdG9nZ2xlQ2xhc3MobGFiZWwsIGNvbmZpZy5jbGFzc2VzLnRvb2x0aXAsIHRydWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEZpbmQgdGhlIFVJIGNvbnRyb2xzIGFuZCBzdG9yZSByZWZlcmVuY2VzXG4gICAgICAgIGZ1bmN0aW9uIF9maW5kRWxlbWVudHMoKSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIHBseXIuY29udHJvbHMgICAgICAgICAgICAgICAgID0gX2dldEVsZW1lbnQoY29uZmlnLnNlbGVjdG9ycy5jb250cm9scy53cmFwcGVyKTtcblxuICAgICAgICAgICAgICAgIC8vIEJ1dHRvbnNcbiAgICAgICAgICAgICAgICBwbHlyLmJ1dHRvbnMgPSB7fTtcbiAgICAgICAgICAgICAgICBwbHlyLmJ1dHRvbnMuc2VlayAgICAgICAgICAgICA9IF9nZXRFbGVtZW50KGNvbmZpZy5zZWxlY3RvcnMuYnV0dG9ucy5zZWVrKTtcbiAgICAgICAgICAgICAgICBwbHlyLmJ1dHRvbnMucGxheSAgICAgICAgICAgICA9IF9nZXRFbGVtZW50cyhjb25maWcuc2VsZWN0b3JzLmJ1dHRvbnMucGxheSk7XG4gICAgICAgICAgICAgICAgcGx5ci5idXR0b25zLnBhdXNlICAgICAgICAgICAgPSBfZ2V0RWxlbWVudChjb25maWcuc2VsZWN0b3JzLmJ1dHRvbnMucGF1c2UpO1xuICAgICAgICAgICAgICAgIHBseXIuYnV0dG9ucy5yZXN0YXJ0ICAgICAgICAgID0gX2dldEVsZW1lbnQoY29uZmlnLnNlbGVjdG9ycy5idXR0b25zLnJlc3RhcnQpO1xuICAgICAgICAgICAgICAgIHBseXIuYnV0dG9ucy5yZXdpbmQgICAgICAgICAgID0gX2dldEVsZW1lbnQoY29uZmlnLnNlbGVjdG9ycy5idXR0b25zLnJld2luZCk7XG4gICAgICAgICAgICAgICAgcGx5ci5idXR0b25zLmZvcndhcmQgICAgICAgICAgPSBfZ2V0RWxlbWVudChjb25maWcuc2VsZWN0b3JzLmJ1dHRvbnMuZm9yd2FyZCk7XG4gICAgICAgICAgICAgICAgcGx5ci5idXR0b25zLmZ1bGxzY3JlZW4gICAgICAgPSBfZ2V0RWxlbWVudChjb25maWcuc2VsZWN0b3JzLmJ1dHRvbnMuZnVsbHNjcmVlbik7XG5cbiAgICAgICAgICAgICAgICAvLyBJbnB1dHNcbiAgICAgICAgICAgICAgICBwbHlyLmJ1dHRvbnMubXV0ZSAgICAgICAgICAgICA9IF9nZXRFbGVtZW50KGNvbmZpZy5zZWxlY3RvcnMuYnV0dG9ucy5tdXRlKTtcbiAgICAgICAgICAgICAgICBwbHlyLmJ1dHRvbnMuY2FwdGlvbnMgICAgICAgICA9IF9nZXRFbGVtZW50KGNvbmZpZy5zZWxlY3RvcnMuYnV0dG9ucy5jYXB0aW9ucyk7XG5cbiAgICAgICAgICAgICAgICAvLyBQcm9ncmVzc1xuICAgICAgICAgICAgICAgIHBseXIucHJvZ3Jlc3MgPSB7fTtcbiAgICAgICAgICAgICAgICBwbHlyLnByb2dyZXNzLmNvbnRhaW5lciAgICAgICA9IF9nZXRFbGVtZW50KGNvbmZpZy5zZWxlY3RvcnMucHJvZ3Jlc3MuY29udGFpbmVyKTtcblxuICAgICAgICAgICAgICAgIC8vIFByb2dyZXNzIC0gQnVmZmVyaW5nXG4gICAgICAgICAgICAgICAgcGx5ci5wcm9ncmVzcy5idWZmZXIgICAgICAgICAgPSB7fTtcbiAgICAgICAgICAgICAgICBwbHlyLnByb2dyZXNzLmJ1ZmZlci5iYXIgICAgICA9IF9nZXRFbGVtZW50KGNvbmZpZy5zZWxlY3RvcnMucHJvZ3Jlc3MuYnVmZmVyKTtcbiAgICAgICAgICAgICAgICBwbHlyLnByb2dyZXNzLmJ1ZmZlci50ZXh0ICAgICA9IHBseXIucHJvZ3Jlc3MuYnVmZmVyLmJhciAmJiBwbHlyLnByb2dyZXNzLmJ1ZmZlci5iYXIuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ3NwYW4nKVswXTtcblxuICAgICAgICAgICAgICAgIC8vIFByb2dyZXNzIC0gUGxheWVkXG4gICAgICAgICAgICAgICAgcGx5ci5wcm9ncmVzcy5wbGF5ZWQgICAgICAgICAgPSBfZ2V0RWxlbWVudChjb25maWcuc2VsZWN0b3JzLnByb2dyZXNzLnBsYXllZCk7XG5cbiAgICAgICAgICAgICAgICAvLyBTZWVrIHRvb2x0aXBcbiAgICAgICAgICAgICAgICBwbHlyLnByb2dyZXNzLnRvb2x0aXAgICAgICAgICA9IHBseXIucHJvZ3Jlc3MuY29udGFpbmVyICYmIHBseXIucHJvZ3Jlc3MuY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJy4nICsgY29uZmlnLmNsYXNzZXMudG9vbHRpcCk7XG5cbiAgICAgICAgICAgICAgICAvLyBWb2x1bWVcbiAgICAgICAgICAgICAgICBwbHlyLnZvbHVtZSAgICAgICAgICAgICAgICAgICA9IHt9O1xuICAgICAgICAgICAgICAgIHBseXIudm9sdW1lLmlucHV0ICAgICAgICAgICAgID0gX2dldEVsZW1lbnQoY29uZmlnLnNlbGVjdG9ycy52b2x1bWUuaW5wdXQpO1xuICAgICAgICAgICAgICAgIHBseXIudm9sdW1lLmRpc3BsYXkgICAgICAgICAgID0gX2dldEVsZW1lbnQoY29uZmlnLnNlbGVjdG9ycy52b2x1bWUuZGlzcGxheSk7XG5cbiAgICAgICAgICAgICAgICAvLyBUaW1pbmdcbiAgICAgICAgICAgICAgICBwbHlyLmR1cmF0aW9uICAgICAgICAgICAgICAgICA9IF9nZXRFbGVtZW50KGNvbmZpZy5zZWxlY3RvcnMuZHVyYXRpb24pO1xuICAgICAgICAgICAgICAgIHBseXIuY3VycmVudFRpbWUgICAgICAgICAgICAgID0gX2dldEVsZW1lbnQoY29uZmlnLnNlbGVjdG9ycy5jdXJyZW50VGltZSk7XG4gICAgICAgICAgICAgICAgcGx5ci5zZWVrVGltZSAgICAgICAgICAgICAgICAgPSBfZ2V0RWxlbWVudHMoY29uZmlnLnNlbGVjdG9ycy5zZWVrVGltZSk7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoKGUpIHtcbiAgICAgICAgICAgICAgICBfd2FybignSXQgbG9va3MgbGlrZSB0aGVyZSBpcyBhIHByb2JsZW0gd2l0aCB5b3VyIGNvbnRyb2xzIEhUTUwnKTtcblxuICAgICAgICAgICAgICAgIC8vIFJlc3RvcmUgbmF0aXZlIHZpZGVvIGNvbnRyb2xzXG4gICAgICAgICAgICAgICAgX3RvZ2dsZU5hdGl2ZUNvbnRyb2xzKHRydWUpO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gVG9nZ2xlIHN0eWxlIGhvb2tcbiAgICAgICAgZnVuY3Rpb24gX3RvZ2dsZVN0eWxlSG9vaygpIHtcbiAgICAgICAgICAgIF90b2dnbGVDbGFzcyhwbHlyLmNvbnRhaW5lciwgY29uZmlnLnNlbGVjdG9ycy5jb250YWluZXIucmVwbGFjZSgnLicsICcnKSwgcGx5ci5zdXBwb3J0ZWQuZnVsbCk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBUb2dnbGUgbmF0aXZlIGNvbnRyb2xzXG4gICAgICAgIGZ1bmN0aW9uIF90b2dnbGVOYXRpdmVDb250cm9scyh0b2dnbGUpIHtcbiAgICAgICAgICAgIGlmICh0b2dnbGUgJiYgX2luQXJyYXkoY29uZmlnLnR5cGVzLmh0bWw1LCBwbHlyLnR5cGUpKSB7XG4gICAgICAgICAgICAgICAgcGx5ci5tZWRpYS5zZXRBdHRyaWJ1dGUoJ2NvbnRyb2xzJywgJycpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBwbHlyLm1lZGlhLnJlbW92ZUF0dHJpYnV0ZSgnY29udHJvbHMnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFNldHVwIGFyaWEgYXR0cmlidXRlIGZvciBwbGF5IGFuZCBpZnJhbWUgdGl0bGVcbiAgICAgICAgZnVuY3Rpb24gX3NldFRpdGxlKGlmcmFtZSkge1xuICAgICAgICAgICAgLy8gRmluZCB0aGUgY3VycmVudCB0ZXh0XG4gICAgICAgICAgICB2YXIgbGFiZWwgPSBjb25maWcuaTE4bi5wbGF5O1xuXG4gICAgICAgICAgICAvLyBJZiB0aGVyZSdzIGEgbWVkaWEgdGl0bGUgc2V0LCB1c2UgdGhhdCBmb3IgdGhlIGxhYmVsXG4gICAgICAgICAgICBpZiAoX2lzLnN0cmluZyhjb25maWcudGl0bGUpICYmIGNvbmZpZy50aXRsZS5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICBsYWJlbCArPSAnLCAnICsgY29uZmlnLnRpdGxlO1xuXG4gICAgICAgICAgICAgICAgLy8gU2V0IGNvbnRhaW5lciBsYWJlbFxuICAgICAgICAgICAgICAgIHBseXIuY29udGFpbmVyLnNldEF0dHJpYnV0ZSgnYXJpYS1sYWJlbCcsIGNvbmZpZy50aXRsZSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIElmIHRoZXJlJ3MgYSBwbGF5IGJ1dHRvbiwgc2V0IGxhYmVsXG4gICAgICAgICAgICBpZiAocGx5ci5zdXBwb3J0ZWQuZnVsbCAmJiBwbHlyLmJ1dHRvbnMucGxheSkge1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSBwbHlyLmJ1dHRvbnMucGxheS5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xuICAgICAgICAgICAgICAgICAgICBwbHlyLmJ1dHRvbnMucGxheVtpXS5zZXRBdHRyaWJ1dGUoJ2FyaWEtbGFiZWwnLCBsYWJlbCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBTZXQgaWZyYW1lIHRpdGxlXG4gICAgICAgICAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vU2Vsei9wbHlyL2lzc3Vlcy8xMjRcbiAgICAgICAgICAgIGlmIChfaXMuaHRtbEVsZW1lbnQoaWZyYW1lKSkge1xuICAgICAgICAgICAgICAgIGlmcmFtZS5zZXRBdHRyaWJ1dGUoJ3RpdGxlJywgY29uZmlnLmkxOG4uZnJhbWVUaXRsZS5yZXBsYWNlKCd7dGl0bGV9JywgY29uZmlnLnRpdGxlKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyBTZXR1cCBsb2NhbFN0b3JhZ2VcbiAgICAgICAgZnVuY3Rpb24gX3NldHVwU3RvcmFnZSgpIHtcbiAgICAgICAgICAgIHZhciB2YWx1ZSA9IG51bGw7XG4gICAgICAgICAgICBwbHlyLnN0b3JhZ2UgPSB7fTtcblxuICAgICAgICAgICAgLy8gQmFpbCBpZiB3ZSBkb24ndCBoYXZlIGxvY2FsU3RvcmFnZSBzdXBwb3J0IG9yIGl0J3MgZGlzYWJsZWRcbiAgICAgICAgICAgIGlmICghX3N0b3JhZ2Uuc3VwcG9ydGVkIHx8ICFjb25maWcuc3RvcmFnZS5lbmFibGVkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBDbGVhbiB1cCBvbGQgdm9sdW1lXG4gICAgICAgICAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vU2Vsei9wbHlyL2lzc3Vlcy8xNzFcbiAgICAgICAgICAgIHdpbmRvdy5sb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbSgncGx5ci12b2x1bWUnKTtcblxuICAgICAgICAgICAgLy8gbG9hZCB2YWx1ZSBmcm9tIHRoZSBjdXJyZW50IGtleVxuICAgICAgICAgICAgdmFsdWUgPSB3aW5kb3cubG9jYWxTdG9yYWdlLmdldEl0ZW0oY29uZmlnLnN0b3JhZ2Uua2V5KTtcblxuICAgICAgICAgICAgaWYgKCF2YWx1ZSkge1xuICAgICAgICAgICAgICAgIC8vIEtleSB3YXNuJ3Qgc2V0IChvciBoYWQgYmVlbiBjbGVhcmVkKSwgbW92ZSBhbG9uZ1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoL15cXGQrKFxcLlxcZCspPyQvLnRlc3QodmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgLy8gSWYgdmFsdWUgaXMgYSBudW1iZXIsIGl0J3MgcHJvYmFibHkgdm9sdW1lIGZyb20gYW4gb2xkZXJcbiAgICAgICAgICAgICAgICAvLyB2ZXJzaW9uIG9mIHBseXIuIFNlZTogaHR0cHM6Ly9naXRodWIuY29tL1NlbHovcGx5ci9wdWxsLzMxM1xuICAgICAgICAgICAgICAgIC8vIFVwZGF0ZSB0aGUga2V5IHRvIGJlIEpTT05cbiAgICAgICAgICAgICAgICBfdXBkYXRlU3RvcmFnZSh7dm9sdW1lOiBwYXJzZUZsb2F0KHZhbHVlKX0pO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyBBc3N1bWUgaXQncyBKU09OIGZyb20gdGhpcyBvciBhIGxhdGVyIHZlcnNpb24gb2YgcGx5clxuICAgICAgICAgICAgICAgIHBseXIuc3RvcmFnZSA9IEpTT04ucGFyc2UodmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gU2F2ZSBhIHZhbHVlIGJhY2sgdG8gbG9jYWwgc3RvcmFnZVxuICAgICAgICBmdW5jdGlvbiBfdXBkYXRlU3RvcmFnZSh2YWx1ZSkge1xuICAgICAgICAgICAgLy8gQmFpbCBpZiB3ZSBkb24ndCBoYXZlIGxvY2FsU3RvcmFnZSBzdXBwb3J0IG9yIGl0J3MgZGlzYWJsZWRcbiAgICAgICAgICAgIGlmICghX3N0b3JhZ2Uuc3VwcG9ydGVkIHx8ICFjb25maWcuc3RvcmFnZS5lbmFibGVkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBVcGRhdGUgdGhlIHdvcmtpbmcgY29weSBvZiB0aGUgdmFsdWVzXG4gICAgICAgICAgICBfZXh0ZW5kKHBseXIuc3RvcmFnZSwgdmFsdWUpO1xuXG4gICAgICAgICAgICAvLyBVcGRhdGUgc3RvcmFnZVxuICAgICAgICAgICAgd2luZG93LmxvY2FsU3RvcmFnZS5zZXRJdGVtKGNvbmZpZy5zdG9yYWdlLmtleSwgSlNPTi5zdHJpbmdpZnkocGx5ci5zdG9yYWdlKSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBTZXR1cCBtZWRpYVxuICAgICAgICBmdW5jdGlvbiBfc2V0dXBNZWRpYSgpIHtcbiAgICAgICAgICAgIC8vIElmIHRoZXJlJ3Mgbm8gbWVkaWEsIGJhaWxcbiAgICAgICAgICAgIGlmICghcGx5ci5tZWRpYSkge1xuICAgICAgICAgICAgICAgIF93YXJuKCdObyBtZWRpYSBlbGVtZW50IGZvdW5kIScpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHBseXIuc3VwcG9ydGVkLmZ1bGwpIHtcbiAgICAgICAgICAgICAgICAvLyBBZGQgdHlwZSBjbGFzc1xuICAgICAgICAgICAgICAgIF90b2dnbGVDbGFzcyhwbHlyLmNvbnRhaW5lciwgY29uZmlnLmNsYXNzZXMudHlwZS5yZXBsYWNlKCd7MH0nLCBwbHlyLnR5cGUpLCB0cnVlKTtcblxuICAgICAgICAgICAgICAgIC8vIEFkZCB2aWRlbyBjbGFzcyBmb3IgZW1iZWRzXG4gICAgICAgICAgICAgICAgLy8gVGhpcyB3aWxsIHJlcXVpcmUgY2hhbmdlcyBpZiBhdWRpbyBlbWJlZHMgYXJlIGFkZGVkXG4gICAgICAgICAgICAgICAgaWYgKF9pbkFycmF5KGNvbmZpZy50eXBlcy5lbWJlZCwgcGx5ci50eXBlKSkge1xuICAgICAgICAgICAgICAgICAgICBfdG9nZ2xlQ2xhc3MocGx5ci5jb250YWluZXIsIGNvbmZpZy5jbGFzc2VzLnR5cGUucmVwbGFjZSgnezB9JywgJ3ZpZGVvJyksIHRydWUpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIElmIHRoZXJlJ3Mgbm8gYXV0b3BsYXkgYXR0cmlidXRlLCBhc3N1bWUgdGhlIHZpZGVvIGlzIHN0b3BwZWQgYW5kIGFkZCBzdGF0ZSBjbGFzc1xuICAgICAgICAgICAgICAgIF90b2dnbGVDbGFzcyhwbHlyLmNvbnRhaW5lciwgY29uZmlnLmNsYXNzZXMuc3RvcHBlZCwgY29uZmlnLmF1dG9wbGF5KTtcblxuICAgICAgICAgICAgICAgIC8vIEFkZCBpT1MgY2xhc3NcbiAgICAgICAgICAgICAgICBfdG9nZ2xlQ2xhc3MocGx5ci5vbnRhaW5lciwgY29uZmlnLmNsYXNzZXMuaXNJb3MsIHBseXIuYnJvd3Nlci5pc0lvcyk7XG5cbiAgICAgICAgICAgICAgICAvLyBBZGQgdG91Y2ggY2xhc3NcbiAgICAgICAgICAgICAgICBfdG9nZ2xlQ2xhc3MocGx5ci5jb250YWluZXIsIGNvbmZpZy5jbGFzc2VzLmlzVG91Y2gsIHBseXIuYnJvd3Nlci5pc1RvdWNoKTtcblxuICAgICAgICAgICAgICAgIC8vIEluamVjdCB0aGUgcGxheWVyIHdyYXBwZXJcbiAgICAgICAgICAgICAgICBpZiAocGx5ci50eXBlID09PSAndmlkZW8nKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIENyZWF0ZSB0aGUgd3JhcHBlciBkaXZcbiAgICAgICAgICAgICAgICAgICAgdmFyIHdyYXBwZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgICAgICAgICAgICAgd3JhcHBlci5zZXRBdHRyaWJ1dGUoJ2NsYXNzJywgY29uZmlnLmNsYXNzZXMudmlkZW9XcmFwcGVyKTtcblxuICAgICAgICAgICAgICAgICAgICAvLyBXcmFwIHRoZSB2aWRlbyBpbiBhIGNvbnRhaW5lclxuICAgICAgICAgICAgICAgICAgICBfd3JhcChwbHlyLm1lZGlhLCB3cmFwcGVyKTtcblxuICAgICAgICAgICAgICAgICAgICAvLyBDYWNoZSB0aGUgY29udGFpbmVyXG4gICAgICAgICAgICAgICAgICAgIHBseXIudmlkZW9Db250YWluZXIgPSB3cmFwcGVyO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gRW1iZWRzXG4gICAgICAgICAgICBpZiAoX2luQXJyYXkoY29uZmlnLnR5cGVzLmVtYmVkLCBwbHlyLnR5cGUpKSB7XG4gICAgICAgICAgICAgICAgX3NldHVwRW1iZWQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFNldHVwIFlvdVR1YmUvVmltZW9cbiAgICAgICAgZnVuY3Rpb24gX3NldHVwRW1iZWQoKSB7XG4gICAgICAgICAgICB2YXIgY29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JyksXG4gICAgICAgICAgICAgICAgbWVkaWFJZCxcbiAgICAgICAgICAgICAgICBpZCA9IHBseXIudHlwZSArICctJyArIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqICgxMDAwMCkpO1xuXG4gICAgICAgICAgICAvLyBQYXJzZSBJRHMgZnJvbSBVUkxzIGlmIHN1cHBsaWVkXG4gICAgICAgICAgICBzd2l0Y2ggKHBseXIudHlwZSkge1xuICAgICAgICAgICAgICAgIGNhc2UgJ3lvdXR1YmUnOlxuICAgICAgICAgICAgICAgICAgICBtZWRpYUlkID0gX3BhcnNlWW91VHViZUlkKHBseXIuZW1iZWRJZCk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgY2FzZSAndmltZW8nOlxuICAgICAgICAgICAgICAgICAgICBtZWRpYUlkID0gX3BhcnNlVmltZW9JZChwbHlyLmVtYmVkSWQpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgIG1lZGlhSWQgPSBwbHlyLmVtYmVkSWQ7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIFJlbW92ZSBvbGQgY29udGFpbmVyc1xuICAgICAgICAgICAgdmFyIGNvbnRhaW5lcnMgPSBfZ2V0RWxlbWVudHMoJ1tpZF49XCInICsgcGx5ci50eXBlICsgJy1cIl0nKTtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSBjb250YWluZXJzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgICAgICAgICAgICAgX3JlbW92ZShjb250YWluZXJzW2ldKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gQWRkIGVtYmVkIGNsYXNzIGZvciByZXNwb25zaXZlXG4gICAgICAgICAgICBfdG9nZ2xlQ2xhc3MocGx5ci5tZWRpYSwgY29uZmlnLmNsYXNzZXMudmlkZW9XcmFwcGVyLCB0cnVlKTtcbiAgICAgICAgICAgIF90b2dnbGVDbGFzcyhwbHlyLm1lZGlhLCBjb25maWcuY2xhc3Nlcy5lbWJlZFdyYXBwZXIsIHRydWUpO1xuXG4gICAgICAgICAgICBpZiAocGx5ci50eXBlID09PSAneW91dHViZScpIHtcbiAgICAgICAgICAgICAgICAvLyBDcmVhdGUgdGhlIFlvdVR1YmUgY29udGFpbmVyXG4gICAgICAgICAgICAgICAgcGx5ci5tZWRpYS5hcHBlbmRDaGlsZChjb250YWluZXIpO1xuXG4gICAgICAgICAgICAgICAgLy8gU2V0IElEXG4gICAgICAgICAgICAgICAgY29udGFpbmVyLnNldEF0dHJpYnV0ZSgnaWQnLCBpZCk7XG5cbiAgICAgICAgICAgICAgICAvLyBTZXR1cCBBUElcbiAgICAgICAgICAgICAgICBpZiAoX2lzLm9iamVjdCh3aW5kb3cuWVQpKSB7XG4gICAgICAgICAgICAgICAgICAgIF95b3VUdWJlUmVhZHkobWVkaWFJZCwgY29udGFpbmVyKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAvLyBMb2FkIHRoZSBBUElcbiAgICAgICAgICAgICAgICAgICAgX2luamVjdFNjcmlwdChjb25maWcudXJscy55b3V0dWJlLmFwaSk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gU2V0dXAgY2FsbGJhY2sgZm9yIHRoZSBBUElcbiAgICAgICAgICAgICAgICAgICAgd2luZG93Lm9uWW91VHViZVJlYWR5Q2FsbGJhY2tzID0gd2luZG93Lm9uWW91VHViZVJlYWR5Q2FsbGJhY2tzIHx8IFtdO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIEFkZCB0byBxdWV1ZVxuICAgICAgICAgICAgICAgICAgICB3aW5kb3cub25Zb3VUdWJlUmVhZHlDYWxsYmFja3MucHVzaChmdW5jdGlvbigpIHsgX3lvdVR1YmVSZWFkeShtZWRpYUlkLCBjb250YWluZXIpOyB9KTtcblxuICAgICAgICAgICAgICAgICAgICAvLyBTZXQgY2FsbGJhY2sgdG8gcHJvY2VzcyBxdWV1ZVxuICAgICAgICAgICAgICAgICAgICB3aW5kb3cub25Zb3VUdWJlSWZyYW1lQVBJUmVhZHkgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cub25Zb3VUdWJlUmVhZHlDYWxsYmFja3MuZm9yRWFjaChmdW5jdGlvbihjYWxsYmFjaykgeyBjYWxsYmFjaygpOyB9KTtcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHBseXIudHlwZSA9PT0gJ3ZpbWVvJykge1xuICAgICAgICAgICAgICAgIC8vIFZpbWVvIG5lZWRzIGFuIGV4dHJhIGRpdiB0byBoaWRlIGNvbnRyb2xzIG9uIGRlc2t0b3AgKHdoaWNoIGhhcyBmdWxsIHN1cHBvcnQpXG4gICAgICAgICAgICAgICAgaWYgKHBseXIuc3VwcG9ydGVkLmZ1bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgcGx5ci5tZWRpYS5hcHBlbmRDaGlsZChjb250YWluZXIpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRhaW5lciA9IHBseXIubWVkaWE7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gU2V0IElEXG4gICAgICAgICAgICAgICAgY29udGFpbmVyLnNldEF0dHJpYnV0ZSgnaWQnLCBpZCk7XG5cbiAgICAgICAgICAgICAgICAvLyBMb2FkIHRoZSBBUEkgaWYgbm90IGFscmVhZHlcbiAgICAgICAgICAgICAgICBpZiAoIV9pcy5vYmplY3Qod2luZG93LlZpbWVvKSkge1xuICAgICAgICAgICAgICAgICAgICBfaW5qZWN0U2NyaXB0KGNvbmZpZy51cmxzLnZpbWVvLmFwaSk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gV2FpdCBmb3IgZnJhZ2Fsb29wIGxvYWRcbiAgICAgICAgICAgICAgICAgICAgdmFyIHZpbWVvVGltZXIgPSB3aW5kb3cuc2V0SW50ZXJ2YWwoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoX2lzLm9iamVjdCh3aW5kb3cuVmltZW8pKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LmNsZWFySW50ZXJ2YWwodmltZW9UaW1lcik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX3ZpbWVvUmVhZHkobWVkaWFJZCwgY29udGFpbmVyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSwgNTApO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIF92aW1lb1JlYWR5KG1lZGlhSWQsIGNvbnRhaW5lcik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIGlmIChwbHlyLnR5cGUgPT09ICdzb3VuZGNsb3VkJykge1xuICAgICAgICAgICAgICAgIC8vIFRPRE86IEN1cnJlbnRseSB1bnN1cHBvcnRlZCBhbmQgdW5kb2N1bWVudGVkXG4gICAgICAgICAgICAgICAgLy8gSW5qZWN0IHRoZSBpZnJhbWVcbiAgICAgICAgICAgICAgICB2YXIgc291bmRDbG91ZCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lmcmFtZScpO1xuXG4gICAgICAgICAgICAgICAgLy8gV2F0Y2ggZm9yIGlmcmFtZSBsb2FkXG4gICAgICAgICAgICAgICAgc291bmRDbG91ZC5sb2FkZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBfb24oc291bmRDbG91ZCwgJ2xvYWQnLCBmdW5jdGlvbigpIHsgc291bmRDbG91ZC5sb2FkZWQgPSB0cnVlOyB9KTtcblxuICAgICAgICAgICAgICAgIF9zZXRBdHRyaWJ1dGVzKHNvdW5kQ2xvdWQsIHtcbiAgICAgICAgICAgICAgICAgICAgJ3NyYyc6ICAnaHR0cHM6Ly93LnNvdW5kY2xvdWQuY29tL3BsYXllci8/dXJsPWh0dHBzOi8vYXBpLnNvdW5kY2xvdWQuY29tL3RyYWNrcy8nICsgbWVkaWFJZCxcbiAgICAgICAgICAgICAgICAgICAgJ2lkJzogICBpZFxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgY29udGFpbmVyLmFwcGVuZENoaWxkKHNvdW5kQ2xvdWQpO1xuICAgICAgICAgICAgICAgIHBseXIubWVkaWEuYXBwZW5kQ2hpbGQoY29udGFpbmVyKTtcblxuICAgICAgICAgICAgICAgIC8vIExvYWQgdGhlIEFQSSBpZiBub3QgYWxyZWFkeVxuICAgICAgICAgICAgICAgIGlmICghd2luZG93LlNDKSB7XG4gICAgICAgICAgICAgICAgICAgIF9pbmplY3RTY3JpcHQoY29uZmlnLnVybHMuc291bmRjbG91ZC5hcGkpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIFdhaXQgZm9yIFNDIGxvYWRcbiAgICAgICAgICAgICAgICB2YXIgc291bmRDbG91ZFRpbWVyID0gd2luZG93LnNldEludGVydmFsKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAod2luZG93LlNDICYmIHNvdW5kQ2xvdWQubG9hZGVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cuY2xlYXJJbnRlcnZhbChzb3VuZENsb3VkVGltZXIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgX3NvdW5kY2xvdWRSZWFkeS5jYWxsKHNvdW5kQ2xvdWQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSwgNTApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gV2hlbiBlbWJlZHMgYXJlIHJlYWR5XG4gICAgICAgIGZ1bmN0aW9uIF9lbWJlZFJlYWR5KCkge1xuICAgICAgICAgICAgLy8gU2V0dXAgdGhlIFVJIGFuZCBjYWxsIHJlYWR5IGlmIGZ1bGwgc3VwcG9ydFxuICAgICAgICAgICAgaWYgKHBseXIuc3VwcG9ydGVkLmZ1bGwpIHtcbiAgICAgICAgICAgICAgICBfc2V0dXBJbnRlcmZhY2UoKTtcbiAgICAgICAgICAgICAgICBfcmVhZHkoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gU2V0IHRpdGxlXG4gICAgICAgICAgICBfc2V0VGl0bGUoX2dldEVsZW1lbnQoJ2lmcmFtZScpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEhhbmRsZSBZb3VUdWJlIEFQSSByZWFkeVxuICAgICAgICBmdW5jdGlvbiBfeW91VHViZVJlYWR5KHZpZGVvSWQsIGNvbnRhaW5lcikge1xuICAgICAgICAgICAgLy8gU2V0dXAgaW5zdGFuY2VcbiAgICAgICAgICAgIC8vIGh0dHBzOi8vZGV2ZWxvcGVycy5nb29nbGUuY29tL3lvdXR1YmUvaWZyYW1lX2FwaV9yZWZlcmVuY2VcbiAgICAgICAgICAgIHBseXIuZW1iZWQgPSBuZXcgd2luZG93LllULlBsYXllcihjb250YWluZXIuaWQsIHtcbiAgICAgICAgICAgICAgICB2aWRlb0lkOiB2aWRlb0lkLFxuICAgICAgICAgICAgICAgIHBsYXllclZhcnM6IHtcbiAgICAgICAgICAgICAgICAgICAgYXV0b3BsYXk6ICAgICAgIChjb25maWcuYXV0b3BsYXkgPyAxIDogMCksXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xzOiAgICAgICAocGx5ci5zdXBwb3J0ZWQuZnVsbCA/IDAgOiAxKSxcbiAgICAgICAgICAgICAgICAgICAgcmVsOiAgICAgICAgICAgIDAsXG4gICAgICAgICAgICAgICAgICAgIHNob3dpbmZvOiAgICAgICAwLFxuICAgICAgICAgICAgICAgICAgICBpdl9sb2FkX3BvbGljeTogMyxcbiAgICAgICAgICAgICAgICAgICAgY2NfbG9hZF9wb2xpY3k6IChjb25maWcuY2FwdGlvbnMuZGVmYXVsdEFjdGl2ZSA/IDEgOiAwKSxcbiAgICAgICAgICAgICAgICAgICAgY2NfbGFuZ19wcmVmOiAgICdlbicsXG4gICAgICAgICAgICAgICAgICAgIHdtb2RlOiAgICAgICAgICAndHJhbnNwYXJlbnQnLFxuICAgICAgICAgICAgICAgICAgICBtb2Rlc3RicmFuZGluZzogMSxcbiAgICAgICAgICAgICAgICAgICAgZGlzYWJsZWtiOiAgICAgIDEsXG4gICAgICAgICAgICAgICAgICAgIG9yaWdpbjogICAgICAgICAnKicgLy8gaHR0cHM6Ly9jb2RlLmdvb2dsZS5jb20vcC9nZGF0YS1pc3N1ZXMvaXNzdWVzL2RldGFpbD9pZD01Nzg4I2M0NVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgZXZlbnRzOiB7XG4gICAgICAgICAgICAgICAgICAgICdvbkVycm9yJzogZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIF90cmlnZ2VyRXZlbnQocGx5ci5jb250YWluZXIsICdlcnJvcicsIHRydWUsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2RlOiAgIGV2ZW50LmRhdGEsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZW1iZWQ6ICBldmVudC50YXJnZXRcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAnb25SZWFkeSc6IGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBHZXQgdGhlIGluc3RhbmNlXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaW5zdGFuY2UgPSBldmVudC50YXJnZXQ7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIENyZWF0ZSBhIGZhdXggSFRNTDUgQVBJIHVzaW5nIHRoZSBZb3VUdWJlIEFQSVxuICAgICAgICAgICAgICAgICAgICAgICAgcGx5ci5tZWRpYS5wbGF5ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5zdGFuY2UucGxheVZpZGVvKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGx5ci5tZWRpYS5wYXVzZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICBwbHlyLm1lZGlhLnBhdXNlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5zdGFuY2UucGF1c2VWaWRlbygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBseXIubWVkaWEucGF1c2VkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICBwbHlyLm1lZGlhLnN0b3AgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnN0YW5jZS5zdG9wVmlkZW8oKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbHlyLm1lZGlhLnBhdXNlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgcGx5ci5tZWRpYS5kdXJhdGlvbiA9IGluc3RhbmNlLmdldER1cmF0aW9uKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBwbHlyLm1lZGlhLnBhdXNlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICBwbHlyLm1lZGlhLmN1cnJlbnRUaW1lID0gMDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBseXIubWVkaWEubXV0ZWQgPSBpbnN0YW5jZS5pc011dGVkKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFNldCB0aXRsZVxuICAgICAgICAgICAgICAgICAgICAgICAgY29uZmlnLnRpdGxlID0gaW5zdGFuY2UuZ2V0VmlkZW9EYXRhKCkudGl0bGU7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFNldCB0aGUgdGFiaW5kZXhcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwbHlyLnN1cHBvcnRlZC5mdWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGx5ci5tZWRpYS5xdWVyeVNlbGVjdG9yKCdpZnJhbWUnKS5zZXRBdHRyaWJ1dGUoJ3RhYmluZGV4JywgJy0xJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFVwZGF0ZSBVSVxuICAgICAgICAgICAgICAgICAgICAgICAgX2VtYmVkUmVhZHkoKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gVHJpZ2dlciB0aW1ldXBkYXRlXG4gICAgICAgICAgICAgICAgICAgICAgICBfdHJpZ2dlckV2ZW50KHBseXIubWVkaWEsICd0aW1ldXBkYXRlJyk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRyaWdnZXIgdGltZXVwZGF0ZVxuICAgICAgICAgICAgICAgICAgICAgICAgX3RyaWdnZXJFdmVudChwbHlyLm1lZGlhLCAnZHVyYXRpb25jaGFuZ2UnKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gUmVzZXQgdGltZXJcbiAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5jbGVhckludGVydmFsKHRpbWVycy5idWZmZXJpbmcpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBTZXR1cCBidWZmZXJpbmdcbiAgICAgICAgICAgICAgICAgICAgICAgIHRpbWVycy5idWZmZXJpbmcgPSB3aW5kb3cuc2V0SW50ZXJ2YWwoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gR2V0IGxvYWRlZCAlIGZyb20gWW91VHViZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBseXIubWVkaWEuYnVmZmVyZWQgPSBpbnN0YW5jZS5nZXRWaWRlb0xvYWRlZEZyYWN0aW9uKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBUcmlnZ2VyIHByb2dyZXNzIG9ubHkgd2hlbiB3ZSBhY3R1YWxseSBidWZmZXIgc29tZXRoaW5nXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBseXIubWVkaWEubGFzdEJ1ZmZlcmVkID09PSBudWxsIHx8IHBseXIubWVkaWEubGFzdEJ1ZmZlcmVkIDwgcGx5ci5tZWRpYS5idWZmZXJlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdHJpZ2dlckV2ZW50KHBseXIubWVkaWEsICdwcm9ncmVzcycpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFNldCBsYXN0IGJ1ZmZlciBwb2ludFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBseXIubWVkaWEubGFzdEJ1ZmZlcmVkID0gcGx5ci5tZWRpYS5idWZmZXJlZDtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEJhaWwgaWYgd2UncmUgYXQgMTAwJVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwbHlyLm1lZGlhLmJ1ZmZlcmVkID09PSAxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5jbGVhckludGVydmFsKHRpbWVycy5idWZmZXJpbmcpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRyaWdnZXIgZXZlbnRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RyaWdnZXJFdmVudChwbHlyLm1lZGlhLCAnY2FucGxheXRocm91Z2gnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9LCAyMDApO1xuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAnb25TdGF0ZUNoYW5nZSc6IGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBHZXQgdGhlIGluc3RhbmNlXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaW5zdGFuY2UgPSBldmVudC50YXJnZXQ7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFJlc2V0IHRpbWVyXG4gICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cuY2xlYXJJbnRlcnZhbCh0aW1lcnMucGxheWluZyk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEhhbmRsZSBldmVudHNcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIC0xICAgVW5zdGFydGVkXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyAwICAgIEVuZGVkXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyAxICAgIFBsYXlpbmdcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIDIgICAgUGF1c2VkXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyAzICAgIEJ1ZmZlcmluZ1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gNSAgICBWaWRlbyBjdWVkXG4gICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKGV2ZW50LmRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBseXIubWVkaWEucGF1c2VkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RyaWdnZXJFdmVudChwbHlyLm1lZGlhLCAnZW5kZWQnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBseXIubWVkaWEucGF1c2VkID0gZmFsc2U7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gSWYgd2Ugd2VyZSBzZWVraW5nLCBmaXJlIHNlZWtlZCBldmVudFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocGx5ci5tZWRpYS5zZWVraW5nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdHJpZ2dlckV2ZW50KHBseXIubWVkaWEsICdzZWVrZWQnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBseXIubWVkaWEuc2Vla2luZyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdHJpZ2dlckV2ZW50KHBseXIubWVkaWEsICdwbGF5Jyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90cmlnZ2VyRXZlbnQocGx5ci5tZWRpYSwgJ3BsYXlpbmcnKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBQb2xsIHRvIGdldCBwbGF5YmFjayBwcm9ncmVzc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aW1lcnMucGxheWluZyA9IHdpbmRvdy5zZXRJbnRlcnZhbChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFNldCB0aGUgY3VycmVudCB0aW1lXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbHlyLm1lZGlhLmN1cnJlbnRUaW1lID0gaW5zdGFuY2UuZ2V0Q3VycmVudFRpbWUoKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gVHJpZ2dlciB0aW1ldXBkYXRlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdHJpZ2dlckV2ZW50KHBseXIubWVkaWEsICd0aW1ldXBkYXRlJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIDEwMCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ2hlY2sgZHVyYXRpb24gYWdhaW4gZHVlIHRvIFlvdVR1YmUgYnVnXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9TZWx6L3BseXIvaXNzdWVzLzM3NFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBodHRwczovL2NvZGUuZ29vZ2xlLmNvbS9wL2dkYXRhLWlzc3Vlcy9pc3N1ZXMvZGV0YWlsP2lkPTg2OTBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBseXIubWVkaWEuZHVyYXRpb24gIT09IGluc3RhbmNlLmdldER1cmF0aW9uKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBseXIubWVkaWEuZHVyYXRpb24gPSBpbnN0YW5jZS5nZXREdXJhdGlvbigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RyaWdnZXJFdmVudChwbHlyLm1lZGlhLCAnZHVyYXRpb25jaGFuZ2UnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbHlyLm1lZGlhLnBhdXNlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90cmlnZ2VyRXZlbnQocGx5ci5tZWRpYSwgJ3BhdXNlJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICBfdHJpZ2dlckV2ZW50KHBseXIuY29udGFpbmVyLCAnc3RhdGVjaGFuZ2UnLCBmYWxzZSwge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvZGU6IGV2ZW50LmRhdGFcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBWaW1lbyByZWFkeVxuICAgICAgICBmdW5jdGlvbiBfdmltZW9SZWFkeShtZWRpYUlkLCBjb250YWluZXIpIHtcbiAgICAgICAgICAgIC8vIFNldHVwIGluc3RhbmNlXG4gICAgICAgICAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vdmltZW8vcGxheWVyLmpzXG4gICAgICAgICAgICBwbHlyLmVtYmVkID0gbmV3IHdpbmRvdy5WaW1lby5QbGF5ZXIoY29udGFpbmVyLCB7XG4gICAgICAgICAgICAgICAgaWQ6ICAgICAgICAgcGFyc2VJbnQobWVkaWFJZCksXG4gICAgICAgICAgICAgICAgbG9vcDogICAgICAgY29uZmlnLmxvb3AsXG4gICAgICAgICAgICAgICAgYXV0b3BsYXk6ICAgY29uZmlnLmF1dG9wbGF5LFxuICAgICAgICAgICAgICAgIGJ5bGluZTogICAgIGZhbHNlLFxuICAgICAgICAgICAgICAgIHBvcnRyYWl0OiAgIGZhbHNlLFxuICAgICAgICAgICAgICAgIHRpdGxlOiAgICAgIGZhbHNlXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgLy8gQ3JlYXRlIGEgZmF1eCBIVE1MNSBBUEkgdXNpbmcgdGhlIFZpbWVvIEFQSVxuICAgICAgICAgICAgcGx5ci5tZWRpYS5wbGF5ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgcGx5ci5lbWJlZC5wbGF5KCk7XG4gICAgICAgICAgICAgICAgcGx5ci5tZWRpYS5wYXVzZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBwbHlyLm1lZGlhLnBhdXNlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgcGx5ci5lbWJlZC5wYXVzZSgpO1xuICAgICAgICAgICAgICAgIHBseXIubWVkaWEucGF1c2VkID0gdHJ1ZTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBwbHlyLm1lZGlhLnN0b3AgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICBwbHlyLmVtYmVkLnN0b3AoKTtcbiAgICAgICAgICAgICAgICBwbHlyLm1lZGlhLnBhdXNlZCA9IHRydWU7XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBwbHlyLm1lZGlhLnBhdXNlZCA9IHRydWU7XG4gICAgICAgICAgICBwbHlyLm1lZGlhLmN1cnJlbnRUaW1lID0gMDtcblxuICAgICAgICAgICAgLy8gVXBkYXRlIFVJXG4gICAgICAgICAgICBfZW1iZWRSZWFkeSgpO1xuXG4gICAgICAgICAgICBwbHlyLmVtYmVkLmdldEN1cnJlbnRUaW1lKCkudGhlbihmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgICAgICAgICAgIHBseXIubWVkaWEuY3VycmVudFRpbWUgPSB2YWx1ZTtcblxuICAgICAgICAgICAgICAgIC8vIFRyaWdnZXIgdGltZXVwZGF0ZVxuICAgICAgICAgICAgICAgIF90cmlnZ2VyRXZlbnQocGx5ci5tZWRpYSwgJ3RpbWV1cGRhdGUnKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBwbHlyLmVtYmVkLmdldER1cmF0aW9uKCkudGhlbihmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgICAgICAgICAgIHBseXIubWVkaWEuZHVyYXRpb24gPSB2YWx1ZTtcblxuICAgICAgICAgICAgICAgIC8vIFRyaWdnZXIgdGltZXVwZGF0ZVxuICAgICAgICAgICAgICAgIF90cmlnZ2VyRXZlbnQocGx5ci5tZWRpYSwgJ2R1cmF0aW9uY2hhbmdlJyk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgLy8gVE9ETzogQ2FwdGlvbnNcbiAgICAgICAgICAgIC8qaWYgKGNvbmZpZy5jYXB0aW9ucy5kZWZhdWx0QWN0aXZlKSB7XG4gICAgICAgICAgICAgICAgcGx5ci5lbWJlZC5lbmFibGVUZXh0VHJhY2soJ2VuJyk7XG4gICAgICAgICAgICB9Ki9cblxuICAgICAgICAgICAgcGx5ci5lbWJlZC5vbignbG9hZGVkJywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgLy8gRml4IGtleWJvYXJkIGZvY3VzIGlzc3Vlc1xuICAgICAgICAgICAgICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9TZWx6L3BseXIvaXNzdWVzLzMxN1xuICAgICAgICAgICAgICAgIGlmIChfaXMuaHRtbEVsZW1lbnQocGx5ci5lbWJlZC5lbGVtZW50KSAmJiBwbHlyLnN1cHBvcnRlZC5mdWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIHBseXIuZW1iZWQuZWxlbWVudC5zZXRBdHRyaWJ1dGUoJ3RhYmluZGV4JywgJy0xJyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIHBseXIuZW1iZWQub24oJ3BsYXknLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICBwbHlyLm1lZGlhLnBhdXNlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIF90cmlnZ2VyRXZlbnQocGx5ci5tZWRpYSwgJ3BsYXknKTtcbiAgICAgICAgICAgICAgICBfdHJpZ2dlckV2ZW50KHBseXIubWVkaWEsICdwbGF5aW5nJyk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgcGx5ci5lbWJlZC5vbigncGF1c2UnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICBwbHlyLm1lZGlhLnBhdXNlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgX3RyaWdnZXJFdmVudChwbHlyLm1lZGlhLCAncGF1c2UnKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBwbHlyLmVtYmVkLm9uKCd0aW1ldXBkYXRlJywgZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgICAgIHBseXIubWVkaWEuc2Vla2luZyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHBseXIubWVkaWEuY3VycmVudFRpbWUgPSBkYXRhLnNlY29uZHM7XG4gICAgICAgICAgICAgICAgX3RyaWdnZXJFdmVudChwbHlyLm1lZGlhLCAndGltZXVwZGF0ZScpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIHBseXIuZW1iZWQub24oJ3Byb2dyZXNzJywgZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgICAgIHBseXIubWVkaWEuYnVmZmVyZWQgPSBkYXRhLnBlcmNlbnQ7XG4gICAgICAgICAgICAgICAgX3RyaWdnZXJFdmVudChwbHlyLm1lZGlhLCAncHJvZ3Jlc3MnKTtcblxuICAgICAgICAgICAgICAgIGlmIChwYXJzZUludChkYXRhLnBlcmNlbnQpID09PSAxKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFRyaWdnZXIgZXZlbnRcbiAgICAgICAgICAgICAgICAgICAgX3RyaWdnZXJFdmVudChwbHlyLm1lZGlhLCAnY2FucGxheXRocm91Z2gnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgcGx5ci5lbWJlZC5vbignc2Vla2VkJywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgcGx5ci5tZWRpYS5zZWVraW5nID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgX3RyaWdnZXJFdmVudChwbHlyLm1lZGlhLCAnc2Vla2VkJyk7XG4gICAgICAgICAgICAgICAgX3RyaWdnZXJFdmVudChwbHlyLm1lZGlhLCAncGxheScpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIHBseXIuZW1iZWQub24oJ2VuZGVkJywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgcGx5ci5tZWRpYS5wYXVzZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIF90cmlnZ2VyRXZlbnQocGx5ci5tZWRpYSwgJ2VuZGVkJyk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFNvdW5kY2xvdWQgcmVhZHlcbiAgICAgICAgZnVuY3Rpb24gX3NvdW5kY2xvdWRSZWFkeSgpIHtcbiAgICAgICAgICAgIC8qIGpzaGludCB2YWxpZHRoaXM6IHRydWUgKi9cbiAgICAgICAgICAgIHBseXIuZW1iZWQgPSB3aW5kb3cuU0MuV2lkZ2V0KHRoaXMpO1xuXG4gICAgICAgICAgICAvLyBTZXR1cCBvbiByZWFkeVxuICAgICAgICAgICAgcGx5ci5lbWJlZC5iaW5kKHdpbmRvdy5TQy5XaWRnZXQuRXZlbnRzLlJFQURZLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAvLyBDcmVhdGUgYSBmYXV4IEhUTUw1IEFQSSB1c2luZyB0aGUgU291bmRjbG91ZCBBUElcbiAgICAgICAgICAgICAgICBwbHlyLm1lZGlhLnBsYXkgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgcGx5ci5lbWJlZC5wbGF5KCk7XG4gICAgICAgICAgICAgICAgICAgIHBseXIubWVkaWEucGF1c2VkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBwbHlyLm1lZGlhLnBhdXNlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIHBseXIuZW1iZWQucGF1c2UoKTtcbiAgICAgICAgICAgICAgICAgICAgcGx5ci5tZWRpYS5wYXVzZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgcGx5ci5tZWRpYS5zdG9wID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIHBseXIuZW1iZWQuc2Vla1RvKDApO1xuICAgICAgICAgICAgICAgICAgICBwbHlyLmVtYmVkLnBhdXNlKCk7XG4gICAgICAgICAgICAgICAgICAgIHBseXIubWVkaWEucGF1c2VkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgcGx5ci5tZWRpYS5wYXVzZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHBseXIubWVkaWEuY3VycmVudFRpbWUgPSAwO1xuXG4gICAgICAgICAgICAgICAgcGx5ci5lbWJlZC5nZXREdXJhdGlvbihmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICBwbHlyLm1lZGlhLmR1cmF0aW9uID0gdmFsdWUvMTAwMDtcblxuICAgICAgICAgICAgICAgICAgICAvLyBVcGRhdGUgVUlcbiAgICAgICAgICAgICAgICAgICAgX2VtYmVkUmVhZHkoKTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHBseXIuZW1iZWQuZ2V0UG9zaXRpb24oZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgcGx5ci5tZWRpYS5jdXJyZW50VGltZSA9IHZhbHVlO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIFRyaWdnZXIgdGltZXVwZGF0ZVxuICAgICAgICAgICAgICAgICAgICBfdHJpZ2dlckV2ZW50KHBseXIubWVkaWEsICd0aW1ldXBkYXRlJyk7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBwbHlyLmVtYmVkLmJpbmQod2luZG93LlNDLldpZGdldC5FdmVudHMuUExBWSwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIHBseXIubWVkaWEucGF1c2VkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIF90cmlnZ2VyRXZlbnQocGx5ci5tZWRpYSwgJ3BsYXknKTtcbiAgICAgICAgICAgICAgICAgICAgX3RyaWdnZXJFdmVudChwbHlyLm1lZGlhLCAncGxheWluZycpO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgcGx5ci5lbWJlZC5iaW5kKHdpbmRvdy5TQy5XaWRnZXQuRXZlbnRzLlBBVVNFLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgcGx5ci5tZWRpYS5wYXVzZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBfdHJpZ2dlckV2ZW50KHBseXIubWVkaWEsICdwYXVzZScpO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgcGx5ci5lbWJlZC5iaW5kKHdpbmRvdy5TQy5XaWRnZXQuRXZlbnRzLlBMQVlfUFJPR1JFU1MsIGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgcGx5ci5tZWRpYS5zZWVraW5nID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIHBseXIubWVkaWEuY3VycmVudFRpbWUgPSBkYXRhLmN1cnJlbnRQb3NpdGlvbi8xMDAwO1xuICAgICAgICAgICAgICAgICAgICBfdHJpZ2dlckV2ZW50KHBseXIubWVkaWEsICd0aW1ldXBkYXRlJyk7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBwbHlyLmVtYmVkLmJpbmQod2luZG93LlNDLldpZGdldC5FdmVudHMuTE9BRF9QUk9HUkVTUywgZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICBwbHlyLm1lZGlhLmJ1ZmZlcmVkID0gZGF0YS5sb2FkUHJvZ3Jlc3M7XG4gICAgICAgICAgICAgICAgICAgIF90cmlnZ2VyRXZlbnQocGx5ci5tZWRpYSwgJ3Byb2dyZXNzJyk7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKHBhcnNlSW50KGRhdGEubG9hZFByb2dyZXNzKSA9PT0gMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gVHJpZ2dlciBldmVudFxuICAgICAgICAgICAgICAgICAgICAgICAgX3RyaWdnZXJFdmVudChwbHlyLm1lZGlhLCAnY2FucGxheXRocm91Z2gnKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgcGx5ci5lbWJlZC5iaW5kKHdpbmRvdy5TQy5XaWRnZXQuRXZlbnRzLkZJTklTSCwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIHBseXIubWVkaWEucGF1c2VkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgX3RyaWdnZXJFdmVudChwbHlyLm1lZGlhLCAnZW5kZWQnKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gUGxheSBtZWRpYVxuICAgICAgICBmdW5jdGlvbiBfcGxheSgpIHtcbiAgICAgICAgICAgIGlmICgncGxheScgaW4gcGx5ci5tZWRpYSkge1xuICAgICAgICAgICAgICAgIHBseXIubWVkaWEucGxheSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gUGF1c2UgbWVkaWFcbiAgICAgICAgZnVuY3Rpb24gX3BhdXNlKCkge1xuICAgICAgICAgICAgaWYgKCdwYXVzZScgaW4gcGx5ci5tZWRpYSkge1xuICAgICAgICAgICAgICAgIHBseXIubWVkaWEucGF1c2UoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFRvZ2dsZSBwbGF5YmFja1xuICAgICAgICBmdW5jdGlvbiBfdG9nZ2xlUGxheSh0b2dnbGUpIHtcbiAgICAgICAgICAgIC8vIFRydWUgdG9nZ2xlXG4gICAgICAgICAgICBpZiAoIV9pcy5ib29sZWFuKHRvZ2dsZSkpIHtcbiAgICAgICAgICAgICAgICB0b2dnbGUgPSBwbHlyLm1lZGlhLnBhdXNlZDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHRvZ2dsZSkge1xuICAgICAgICAgICAgICAgIF9wbGF5KCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIF9wYXVzZSgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gdG9nZ2xlO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gUmV3aW5kXG4gICAgICAgIGZ1bmN0aW9uIF9yZXdpbmQoc2Vla1RpbWUpIHtcbiAgICAgICAgICAgIC8vIFVzZSBkZWZhdWx0IGlmIG5lZWRlZFxuICAgICAgICAgICAgaWYgKCFfaXMubnVtYmVyKHNlZWtUaW1lKSkge1xuICAgICAgICAgICAgICAgIHNlZWtUaW1lID0gY29uZmlnLnNlZWtUaW1lO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgX3NlZWsocGx5ci5tZWRpYS5jdXJyZW50VGltZSAtIHNlZWtUaW1lKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEZhc3QgZm9yd2FyZFxuICAgICAgICBmdW5jdGlvbiBfZm9yd2FyZChzZWVrVGltZSkge1xuICAgICAgICAgICAgLy8gVXNlIGRlZmF1bHQgaWYgbmVlZGVkXG4gICAgICAgICAgICBpZiAoIV9pcy5udW1iZXIoc2Vla1RpbWUpKSB7XG4gICAgICAgICAgICAgICAgc2Vla1RpbWUgPSBjb25maWcuc2Vla1RpbWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBfc2VlayhwbHlyLm1lZGlhLmN1cnJlbnRUaW1lICsgc2Vla1RpbWUpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gU2VlayB0byB0aW1lXG4gICAgICAgIC8vIFRoZSBpbnB1dCBwYXJhbWV0ZXIgY2FuIGJlIGFuIGV2ZW50IG9yIGEgbnVtYmVyXG4gICAgICAgIGZ1bmN0aW9uIF9zZWVrKGlucHV0KSB7XG4gICAgICAgICAgICB2YXIgdGFyZ2V0VGltZSAgPSAwLFxuICAgICAgICAgICAgICAgIHBhdXNlZCAgICAgID0gcGx5ci5tZWRpYS5wYXVzZWQsXG4gICAgICAgICAgICAgICAgZHVyYXRpb24gICAgPSBfZ2V0RHVyYXRpb24oKTtcblxuICAgICAgICAgICAgaWYgKF9pcy5udW1iZXIoaW5wdXQpKSB7XG4gICAgICAgICAgICAgICAgdGFyZ2V0VGltZSA9IGlucHV0O1xuICAgICAgICAgICAgfSBlbHNlIGlmIChfaXMub2JqZWN0KGlucHV0KSAmJiBfaW5BcnJheShbJ2lucHV0JywgJ2NoYW5nZSddLCBpbnB1dC50eXBlKSkge1xuICAgICAgICAgICAgICAgIC8vIEl0J3MgdGhlIHNlZWsgc2xpZGVyXG4gICAgICAgICAgICAgICAgLy8gU2VlayB0byB0aGUgc2VsZWN0ZWQgdGltZVxuICAgICAgICAgICAgICAgIHRhcmdldFRpbWUgPSAoKGlucHV0LnRhcmdldC52YWx1ZSAvIGlucHV0LnRhcmdldC5tYXgpICogZHVyYXRpb24pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBOb3JtYWxpc2UgdGFyZ2V0VGltZVxuICAgICAgICAgICAgaWYgKHRhcmdldFRpbWUgPCAwKSB7XG4gICAgICAgICAgICAgICAgdGFyZ2V0VGltZSA9IDA7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHRhcmdldFRpbWUgPiBkdXJhdGlvbikge1xuICAgICAgICAgICAgICAgIHRhcmdldFRpbWUgPSBkdXJhdGlvbjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gVXBkYXRlIHNlZWsgcmFuZ2UgYW5kIHByb2dyZXNzXG4gICAgICAgICAgICBfdXBkYXRlU2Vla0Rpc3BsYXkodGFyZ2V0VGltZSk7XG5cbiAgICAgICAgICAgIC8vIFNldCB0aGUgY3VycmVudCB0aW1lXG4gICAgICAgICAgICAvLyBUcnkvY2F0Y2ggaW5jYXNlIHRoZSBtZWRpYSBpc24ndCBzZXQgYW5kIHdlJ3JlIGNhbGxpbmcgc2VlaygpIGZyb20gc291cmNlKCkgYW5kIElFIG1vYW5zXG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIHBseXIubWVkaWEuY3VycmVudFRpbWUgPSB0YXJnZXRUaW1lLnRvRml4ZWQoNCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaChlKSB7fVxuXG4gICAgICAgICAgICAvLyBFbWJlZHNcbiAgICAgICAgICAgIGlmIChfaW5BcnJheShjb25maWcudHlwZXMuZW1iZWQsIHBseXIudHlwZSkpIHtcbiAgICAgICAgICAgICAgICBzd2l0Y2gocGx5ci50eXBlKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ3lvdXR1YmUnOlxuICAgICAgICAgICAgICAgICAgICAgICAgcGx5ci5lbWJlZC5zZWVrVG8odGFyZ2V0VGltZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgICAgICBjYXNlICd2aW1lbyc6XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBSb3VuZCB0byBuZWFyZXN0IHNlY29uZCBmb3IgdmltZW9cbiAgICAgICAgICAgICAgICAgICAgICAgIHBseXIuZW1iZWQuc2V0Q3VycmVudFRpbWUodGFyZ2V0VGltZS50b0ZpeGVkKDApKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ3NvdW5kY2xvdWQnOlxuICAgICAgICAgICAgICAgICAgICAgICAgcGx5ci5lbWJlZC5zZWVrVG8odGFyZ2V0VGltZSAqIDEwMDApO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKHBhdXNlZCkge1xuICAgICAgICAgICAgICAgICAgICBfcGF1c2UoKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBUcmlnZ2VyIHRpbWV1cGRhdGVcbiAgICAgICAgICAgICAgICBfdHJpZ2dlckV2ZW50KHBseXIubWVkaWEsICd0aW1ldXBkYXRlJyk7XG5cbiAgICAgICAgICAgICAgICAvLyBTZXQgc2Vla2luZyBmbGFnXG4gICAgICAgICAgICAgICAgcGx5ci5tZWRpYS5zZWVraW5nID0gdHJ1ZTtcblxuICAgICAgICAgICAgICAgIC8vIFRyaWdnZXIgc2Vla2luZ1xuICAgICAgICAgICAgICAgIF90cmlnZ2VyRXZlbnQocGx5ci5tZWRpYSwgJ3NlZWtpbmcnKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gTG9nZ2luZ1xuICAgICAgICAgICAgX2xvZygnU2Vla2luZyB0byAnICsgcGx5ci5tZWRpYS5jdXJyZW50VGltZSArICcgc2Vjb25kcycpO1xuXG4gICAgICAgICAgICAvLyBTcGVjaWFsIGhhbmRsaW5nIGZvciAnbWFudWFsJyBjYXB0aW9uc1xuICAgICAgICAgICAgX3NlZWtNYW51YWxDYXB0aW9ucyh0YXJnZXRUaW1lKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEdldCB0aGUgZHVyYXRpb24gKG9yIGN1c3RvbSBpZiBzZXQpXG4gICAgICAgIGZ1bmN0aW9uIF9nZXREdXJhdGlvbigpIHtcbiAgICAgICAgICAgIC8vIEl0IHNob3VsZCBiZSBhIG51bWJlciwgYnV0IHBhcnNlIGl0IGp1c3QgaW5jYXNlXG4gICAgICAgICAgICB2YXIgZHVyYXRpb24gPSBwYXJzZUludChjb25maWcuZHVyYXRpb24pLFxuXG4gICAgICAgICAgICAvLyBUcnVlIGR1cmF0aW9uXG4gICAgICAgICAgICBtZWRpYUR1cmF0aW9uID0gMDtcblxuICAgICAgICAgICAgLy8gT25seSBpZiBkdXJhdGlvbiBhdmFpbGFibGVcbiAgICAgICAgICAgIGlmIChwbHlyLm1lZGlhLmR1cmF0aW9uICE9PSBudWxsICYmICFpc05hTihwbHlyLm1lZGlhLmR1cmF0aW9uKSkge1xuICAgICAgICAgICAgICAgIG1lZGlhRHVyYXRpb24gPSBwbHlyLm1lZGlhLmR1cmF0aW9uO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBJZiBjdXN0b20gZHVyYXRpb24gaXMgZnVua3ksIHVzZSByZWd1bGFyIGR1cmF0aW9uXG4gICAgICAgICAgICByZXR1cm4gKGlzTmFOKGR1cmF0aW9uKSA/IG1lZGlhRHVyYXRpb24gOiBkdXJhdGlvbik7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBDaGVjayBwbGF5aW5nIHN0YXRlXG4gICAgICAgIGZ1bmN0aW9uIF9jaGVja1BsYXlpbmcoKSB7XG4gICAgICAgICAgICBfdG9nZ2xlQ2xhc3MocGx5ci5jb250YWluZXIsIGNvbmZpZy5jbGFzc2VzLnBsYXlpbmcsICFwbHlyLm1lZGlhLnBhdXNlZCk7XG5cbiAgICAgICAgICAgIF90b2dnbGVDbGFzcyhwbHlyLmNvbnRhaW5lciwgY29uZmlnLmNsYXNzZXMuc3RvcHBlZCwgcGx5ci5tZWRpYS5wYXVzZWQpO1xuXG4gICAgICAgICAgICBfdG9nZ2xlQ29udHJvbHMocGx5ci5tZWRpYS5wYXVzZWQpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gU2F2ZSBzY3JvbGwgcG9zaXRpb25cbiAgICAgICAgZnVuY3Rpb24gX3NhdmVTY3JvbGxQb3NpdGlvbigpIHtcbiAgICAgICAgICAgIHNjcm9sbCA9IHtcbiAgICAgICAgICAgICAgICB4OiB3aW5kb3cucGFnZVhPZmZzZXQgfHwgMCxcbiAgICAgICAgICAgICAgICB5OiB3aW5kb3cucGFnZVlPZmZzZXQgfHwgMFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFJlc3RvcmUgc2Nyb2xsIHBvc2l0aW9uXG4gICAgICAgIGZ1bmN0aW9uIF9yZXN0b3JlU2Nyb2xsUG9zaXRpb24oKSB7XG4gICAgICAgICAgICB3aW5kb3cuc2Nyb2xsVG8oc2Nyb2xsLngsIHNjcm9sbC55KTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFRvZ2dsZSBmdWxsc2NyZWVuXG4gICAgICAgIGZ1bmN0aW9uIF90b2dnbGVGdWxsc2NyZWVuKGV2ZW50KSB7XG4gICAgICAgICAgICAvLyBDaGVjayBmb3IgbmF0aXZlIHN1cHBvcnRcbiAgICAgICAgICAgIHZhciBuYXRpdmVTdXBwb3J0ID0gZnVsbHNjcmVlbi5zdXBwb3J0c0Z1bGxTY3JlZW47XG5cbiAgICAgICAgICAgIGlmIChuYXRpdmVTdXBwb3J0KSB7XG4gICAgICAgICAgICAgICAgLy8gSWYgaXQncyBhIGZ1bGxzY3JlZW4gY2hhbmdlIGV2ZW50LCB1cGRhdGUgdGhlIFVJXG4gICAgICAgICAgICAgICAgaWYgKGV2ZW50ICYmIGV2ZW50LnR5cGUgPT09IGZ1bGxzY3JlZW4uZnVsbFNjcmVlbkV2ZW50TmFtZSkge1xuICAgICAgICAgICAgICAgICAgICBwbHlyLmlzRnVsbHNjcmVlbiA9IGZ1bGxzY3JlZW4uaXNGdWxsU2NyZWVuKHBseXIuY29udGFpbmVyKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAvLyBFbHNlIGl0J3MgYSB1c2VyIHJlcXVlc3QgdG8gZW50ZXIgb3IgZXhpdFxuICAgICAgICAgICAgICAgICAgICBpZiAoIWZ1bGxzY3JlZW4uaXNGdWxsU2NyZWVuKHBseXIuY29udGFpbmVyKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gU2F2ZSBzY3JvbGwgcG9zaXRpb25cbiAgICAgICAgICAgICAgICAgICAgICAgIF9zYXZlU2Nyb2xsUG9zaXRpb24oKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gUmVxdWVzdCBmdWxsIHNjcmVlblxuICAgICAgICAgICAgICAgICAgICAgICAgZnVsbHNjcmVlbi5yZXF1ZXN0RnVsbFNjcmVlbihwbHlyLmNvbnRhaW5lcik7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBCYWlsIGZyb20gZnVsbHNjcmVlblxuICAgICAgICAgICAgICAgICAgICAgICAgZnVsbHNjcmVlbi5jYW5jZWxGdWxsU2NyZWVuKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAvLyBDaGVjayBpZiB3ZSdyZSBhY3R1YWxseSBmdWxsIHNjcmVlbiAoaXQgY291bGQgZmFpbClcbiAgICAgICAgICAgICAgICAgICAgcGx5ci5pc0Z1bGxzY3JlZW4gPSBmdWxsc2NyZWVuLmlzRnVsbFNjcmVlbihwbHlyLmNvbnRhaW5lcik7XG5cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gT3RoZXJ3aXNlLCBpdCdzIGEgc2ltcGxlIHRvZ2dsZVxuICAgICAgICAgICAgICAgIHBseXIuaXNGdWxsc2NyZWVuID0gIXBseXIuaXNGdWxsc2NyZWVuO1xuXG4gICAgICAgICAgICAgICAgLy8gQmluZC91bmJpbmQgZXNjYXBlIGtleVxuICAgICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuc3R5bGUub3ZlcmZsb3cgPSBwbHlyLmlzRnVsbHNjcmVlbiA/ICdoaWRkZW4nIDogJyc7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIFNldCBjbGFzcyBob29rXG4gICAgICAgICAgICBfdG9nZ2xlQ2xhc3MocGx5ci5jb250YWluZXIsIGNvbmZpZy5jbGFzc2VzLmZ1bGxzY3JlZW4uYWN0aXZlLCBwbHlyLmlzRnVsbHNjcmVlbik7XG5cbiAgICAgICAgICAgIC8vIFRyYXAgZm9jdXNcbiAgICAgICAgICAgIF9mb2N1c1RyYXAocGx5ci5pc0Z1bGxzY3JlZW4pO1xuXG4gICAgICAgICAgICAvLyBTZXQgYnV0dG9uIHN0YXRlXG4gICAgICAgICAgICBpZiAocGx5ci5idXR0b25zICYmIHBseXIuYnV0dG9ucy5mdWxsc2NyZWVuKSB7XG4gICAgICAgICAgICAgICAgX3RvZ2dsZVN0YXRlKHBseXIuYnV0dG9ucy5mdWxsc2NyZWVuLCBwbHlyLmlzRnVsbHNjcmVlbik7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIFRyaWdnZXIgYW4gZXZlbnRcbiAgICAgICAgICAgIF90cmlnZ2VyRXZlbnQocGx5ci5jb250YWluZXIsIHBseXIuaXNGdWxsc2NyZWVuID8gJ2VudGVyZnVsbHNjcmVlbicgOiAnZXhpdGZ1bGxzY3JlZW4nLCB0cnVlKTtcblxuICAgICAgICAgICAgLy8gUmVzdG9yZSBzY3JvbGwgcG9zaXRpb25cbiAgICAgICAgICAgIGlmICghcGx5ci5pc0Z1bGxzY3JlZW4gJiYgbmF0aXZlU3VwcG9ydCkge1xuICAgICAgICAgICAgICAgIF9yZXN0b3JlU2Nyb2xsUG9zaXRpb24oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIE11dGVcbiAgICAgICAgZnVuY3Rpb24gX3RvZ2dsZU11dGUobXV0ZWQpIHtcbiAgICAgICAgICAgIC8vIElmIHRoZSBtZXRob2QgaXMgY2FsbGVkIHdpdGhvdXQgcGFyYW1ldGVyLCB0b2dnbGUgYmFzZWQgb24gY3VycmVudCB2YWx1ZVxuICAgICAgICAgICAgaWYgKCFfaXMuYm9vbGVhbihtdXRlZCkpIHtcbiAgICAgICAgICAgICAgICBtdXRlZCA9ICFwbHlyLm1lZGlhLm11dGVkO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBTZXQgYnV0dG9uIHN0YXRlXG4gICAgICAgICAgICBfdG9nZ2xlU3RhdGUocGx5ci5idXR0b25zLm11dGUsIG11dGVkKTtcblxuICAgICAgICAgICAgLy8gU2V0IG11dGUgb24gdGhlIHBsYXllclxuICAgICAgICAgICAgcGx5ci5tZWRpYS5tdXRlZCA9IG11dGVkO1xuXG4gICAgICAgICAgICAvLyBJZiB2b2x1bWUgaXMgMCBhZnRlciB1bm11dGluZywgc2V0IHRvIGRlZmF1bHRcbiAgICAgICAgICAgIGlmIChwbHlyLm1lZGlhLnZvbHVtZSA9PT0gMCkge1xuICAgICAgICAgICAgICAgIF9zZXRWb2x1bWUoY29uZmlnLnZvbHVtZSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIEVtYmVkc1xuICAgICAgICAgICAgaWYgKF9pbkFycmF5KGNvbmZpZy50eXBlcy5lbWJlZCwgcGx5ci50eXBlKSkge1xuICAgICAgICAgICAgICAgIC8vIFlvdVR1YmVcbiAgICAgICAgICAgICAgICBzd2l0Y2gocGx5ci50eXBlKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ3lvdXR1YmUnOlxuICAgICAgICAgICAgICAgICAgICAgICAgcGx5ci5lbWJlZFtwbHlyLm1lZGlhLm11dGVkID8gJ211dGUnIDogJ3VuTXV0ZSddKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgICAgICBjYXNlICd2aW1lbyc6XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ3NvdW5kY2xvdWQnOlxuICAgICAgICAgICAgICAgICAgICAgICAgcGx5ci5lbWJlZC5zZXRWb2x1bWUocGx5ci5tZWRpYS5tdXRlZCA/IDAgOiBwYXJzZUZsb2F0KGNvbmZpZy52b2x1bWUgLyBjb25maWcudm9sdW1lTWF4KSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBUcmlnZ2VyIHZvbHVtZWNoYW5nZSBmb3IgZW1iZWRzXG4gICAgICAgICAgICAgICAgX3RyaWdnZXJFdmVudChwbHlyLm1lZGlhLCAndm9sdW1lY2hhbmdlJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyBTZXQgdm9sdW1lXG4gICAgICAgIGZ1bmN0aW9uIF9zZXRWb2x1bWUodm9sdW1lKSB7XG4gICAgICAgICAgICB2YXIgbWF4ID0gY29uZmlnLnZvbHVtZU1heCxcbiAgICAgICAgICAgICAgICBtaW4gPSBjb25maWcudm9sdW1lTWluO1xuXG4gICAgICAgICAgICAvLyBMb2FkIHZvbHVtZSBmcm9tIHN0b3JhZ2UgaWYgbm8gdmFsdWUgc3BlY2lmaWVkXG4gICAgICAgICAgICBpZiAoX2lzLnVuZGVmaW5lZCh2b2x1bWUpKSB7XG4gICAgICAgICAgICAgICAgdm9sdW1lID0gcGx5ci5zdG9yYWdlLnZvbHVtZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gVXNlIGNvbmZpZyBpZiBhbGwgZWxzZSBmYWlsc1xuICAgICAgICAgICAgaWYgKHZvbHVtZSA9PT0gbnVsbCB8fCBpc05hTih2b2x1bWUpKSB7XG4gICAgICAgICAgICAgICAgdm9sdW1lID0gY29uZmlnLnZvbHVtZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gTWF4aW11bSBpcyB2b2x1bWVNYXhcbiAgICAgICAgICAgIGlmICh2b2x1bWUgPiBtYXgpIHtcbiAgICAgICAgICAgICAgICB2b2x1bWUgPSBtYXg7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBNaW5pbXVtIGlzIHZvbHVtZU1pblxuICAgICAgICAgICAgaWYgKHZvbHVtZSA8IG1pbikge1xuICAgICAgICAgICAgICAgIHZvbHVtZSA9IG1pbjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gU2V0IHRoZSBwbGF5ZXIgdm9sdW1lXG4gICAgICAgICAgICBwbHlyLm1lZGlhLnZvbHVtZSA9IHBhcnNlRmxvYXQodm9sdW1lIC8gbWF4KTtcblxuICAgICAgICAgICAgLy8gU2V0IHRoZSBkaXNwbGF5XG4gICAgICAgICAgICBpZiAocGx5ci52b2x1bWUuZGlzcGxheSkge1xuICAgICAgICAgICAgICAgIHBseXIudm9sdW1lLmRpc3BsYXkudmFsdWUgPSB2b2x1bWU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIEVtYmVkc1xuICAgICAgICAgICAgaWYgKF9pbkFycmF5KGNvbmZpZy50eXBlcy5lbWJlZCwgcGx5ci50eXBlKSkge1xuICAgICAgICAgICAgICAgIHN3aXRjaChwbHlyLnR5cGUpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAneW91dHViZSc6XG4gICAgICAgICAgICAgICAgICAgICAgICBwbHlyLmVtYmVkLnNldFZvbHVtZShwbHlyLm1lZGlhLnZvbHVtZSAqIDEwMCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgICAgICBjYXNlICd2aW1lbyc6XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ3NvdW5kY2xvdWQnOlxuICAgICAgICAgICAgICAgICAgICAgICAgcGx5ci5lbWJlZC5zZXRWb2x1bWUocGx5ci5tZWRpYS52b2x1bWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gVHJpZ2dlciB2b2x1bWVjaGFuZ2UgZm9yIGVtYmVkc1xuICAgICAgICAgICAgICAgIF90cmlnZ2VyRXZlbnQocGx5ci5tZWRpYSwgJ3ZvbHVtZWNoYW5nZScpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBUb2dnbGUgbXV0ZWQgc3RhdGVcbiAgICAgICAgICAgIGlmICh2b2x1bWUgPT09IDApIHtcbiAgICAgICAgICAgICAgICBwbHlyLm1lZGlhLm11dGVkID0gdHJ1ZTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAocGx5ci5tZWRpYS5tdXRlZCAmJiB2b2x1bWUgPiAwKSB7XG4gICAgICAgICAgICAgICAgX3RvZ2dsZU11dGUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEluY3JlYXNlIHZvbHVtZVxuICAgICAgICBmdW5jdGlvbiBfaW5jcmVhc2VWb2x1bWUoc3RlcCkge1xuICAgICAgICAgICAgdmFyIHZvbHVtZSA9IHBseXIubWVkaWEubXV0ZWQgPyAwIDogKHBseXIubWVkaWEudm9sdW1lICogY29uZmlnLnZvbHVtZU1heCk7XG5cbiAgICAgICAgICAgIGlmICghX2lzLm51bWJlcihzdGVwKSkge1xuICAgICAgICAgICAgICAgIHN0ZXAgPSBjb25maWcudm9sdW1lU3RlcDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgX3NldFZvbHVtZSh2b2x1bWUgKyBzdGVwKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIERlY3JlYXNlIHZvbHVtZVxuICAgICAgICBmdW5jdGlvbiBfZGVjcmVhc2VWb2x1bWUoc3RlcCkge1xuICAgICAgICAgICAgdmFyIHZvbHVtZSA9IHBseXIubWVkaWEubXV0ZWQgPyAwIDogKHBseXIubWVkaWEudm9sdW1lICogY29uZmlnLnZvbHVtZU1heCk7XG5cbiAgICAgICAgICAgIGlmICghX2lzLm51bWJlcihzdGVwKSkge1xuICAgICAgICAgICAgICAgIHN0ZXAgPSBjb25maWcudm9sdW1lU3RlcDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgX3NldFZvbHVtZSh2b2x1bWUgLSBzdGVwKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFVwZGF0ZSB2b2x1bWUgVUkgYW5kIHN0b3JhZ2VcbiAgICAgICAgZnVuY3Rpb24gX3VwZGF0ZVZvbHVtZSgpIHtcbiAgICAgICAgICAgIC8vIEdldCB0aGUgY3VycmVudCB2b2x1bWVcbiAgICAgICAgICAgIHZhciB2b2x1bWUgPSBwbHlyLm1lZGlhLm11dGVkID8gMCA6IChwbHlyLm1lZGlhLnZvbHVtZSAqIGNvbmZpZy52b2x1bWVNYXgpO1xuXG4gICAgICAgICAgICAvLyBVcGRhdGUgdGhlIDxpbnB1dCB0eXBlPVwicmFuZ2VcIj4gaWYgcHJlc2VudFxuICAgICAgICAgICAgaWYgKHBseXIuc3VwcG9ydGVkLmZ1bGwpIHtcbiAgICAgICAgICAgICAgICBpZiAocGx5ci52b2x1bWUuaW5wdXQpIHtcbiAgICAgICAgICAgICAgICAgICAgcGx5ci52b2x1bWUuaW5wdXQudmFsdWUgPSB2b2x1bWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChwbHlyLnZvbHVtZS5kaXNwbGF5KSB7XG4gICAgICAgICAgICAgICAgICAgIHBseXIudm9sdW1lLmRpc3BsYXkudmFsdWUgPSB2b2x1bWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBVcGRhdGUgdGhlIHZvbHVtZSBpbiBzdG9yYWdlXG4gICAgICAgICAgICBfdXBkYXRlU3RvcmFnZSh7dm9sdW1lOiB2b2x1bWV9KTtcblxuICAgICAgICAgICAgLy8gVG9nZ2xlIGNsYXNzIGlmIG11dGVkXG4gICAgICAgICAgICBfdG9nZ2xlQ2xhc3MocGx5ci5jb250YWluZXIsIGNvbmZpZy5jbGFzc2VzLm11dGVkLCAodm9sdW1lID09PSAwKSk7XG5cbiAgICAgICAgICAgIC8vIFVwZGF0ZSBjaGVja2JveCBmb3IgbXV0ZSBzdGF0ZVxuICAgICAgICAgICAgaWYgKHBseXIuc3VwcG9ydGVkLmZ1bGwgJiYgcGx5ci5idXR0b25zLm11dGUpIHtcbiAgICAgICAgICAgICAgICBfdG9nZ2xlU3RhdGUocGx5ci5idXR0b25zLm11dGUsICh2b2x1bWUgPT09IDApKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFRvZ2dsZSBjYXB0aW9uc1xuICAgICAgICBmdW5jdGlvbiBfdG9nZ2xlQ2FwdGlvbnMoc2hvdykge1xuICAgICAgICAgICAgLy8gSWYgdGhlcmUncyBubyBmdWxsIHN1cHBvcnQsIG9yIHRoZXJlJ3Mgbm8gY2FwdGlvbiB0b2dnbGVcbiAgICAgICAgICAgIGlmICghcGx5ci5zdXBwb3J0ZWQuZnVsbCB8fCAhcGx5ci5idXR0b25zLmNhcHRpb25zKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBJZiB0aGUgbWV0aG9kIGlzIGNhbGxlZCB3aXRob3V0IHBhcmFtZXRlciwgdG9nZ2xlIGJhc2VkIG9uIGN1cnJlbnQgdmFsdWVcbiAgICAgICAgICAgIGlmICghX2lzLmJvb2xlYW4oc2hvdykpIHtcbiAgICAgICAgICAgICAgICBzaG93ID0gKHBseXIuY29udGFpbmVyLmNsYXNzTmFtZS5pbmRleE9mKGNvbmZpZy5jbGFzc2VzLmNhcHRpb25zLmFjdGl2ZSkgPT09IC0xKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gU2V0IGdsb2JhbFxuICAgICAgICAgICAgcGx5ci5jYXB0aW9uc0VuYWJsZWQgPSBzaG93O1xuXG4gICAgICAgICAgICAvLyBUb2dnbGUgc3RhdGVcbiAgICAgICAgICAgIF90b2dnbGVTdGF0ZShwbHlyLmJ1dHRvbnMuY2FwdGlvbnMsIHBseXIuY2FwdGlvbnNFbmFibGVkKTtcblxuICAgICAgICAgICAgLy8gQWRkIGNsYXNzIGhvb2tcbiAgICAgICAgICAgIF90b2dnbGVDbGFzcyhwbHlyLmNvbnRhaW5lciwgY29uZmlnLmNsYXNzZXMuY2FwdGlvbnMuYWN0aXZlLCBwbHlyLmNhcHRpb25zRW5hYmxlZCk7XG5cbiAgICAgICAgICAgIC8vIFRyaWdnZXIgYW4gZXZlbnRcbiAgICAgICAgICAgIF90cmlnZ2VyRXZlbnQocGx5ci5jb250YWluZXIsIHBseXIuY2FwdGlvbnNFbmFibGVkID8gJ2NhcHRpb25zZW5hYmxlZCcgOiAnY2FwdGlvbnNkaXNhYmxlZCcsIHRydWUpO1xuXG4gICAgICAgICAgICAvLyBTYXZlIGNhcHRpb25zIHN0YXRlIHRvIGxvY2FsU3RvcmFnZVxuICAgICAgICAgICAgX3VwZGF0ZVN0b3JhZ2Uoe2NhcHRpb25zRW5hYmxlZDogcGx5ci5jYXB0aW9uc0VuYWJsZWR9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIENoZWNrIGlmIG1lZGlhIGlzIGxvYWRpbmdcbiAgICAgICAgZnVuY3Rpb24gX2NoZWNrTG9hZGluZyhldmVudCkge1xuICAgICAgICAgICAgdmFyIGxvYWRpbmcgPSAoZXZlbnQudHlwZSA9PT0gJ3dhaXRpbmcnKTtcblxuICAgICAgICAgICAgLy8gQ2xlYXIgdGltZXJcbiAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aW1lcnMubG9hZGluZyk7XG5cbiAgICAgICAgICAgIC8vIFRpbWVyIHRvIHByZXZlbnQgZmxpY2tlciB3aGVuIHNlZWtpbmdcbiAgICAgICAgICAgIHRpbWVycy5sb2FkaW5nID0gc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAvLyBUb2dnbGUgY29udGFpbmVyIGNsYXNzIGhvb2tcbiAgICAgICAgICAgICAgICBfdG9nZ2xlQ2xhc3MocGx5ci5jb250YWluZXIsIGNvbmZpZy5jbGFzc2VzLmxvYWRpbmcsIGxvYWRpbmcpO1xuXG4gICAgICAgICAgICAgICAgLy8gU2hvdyBjb250cm9scyBpZiBsb2FkaW5nLCBoaWRlIGlmIGRvbmVcbiAgICAgICAgICAgICAgICBfdG9nZ2xlQ29udHJvbHMobG9hZGluZyk7XG4gICAgICAgICAgICB9LCAobG9hZGluZyA/IDI1MCA6IDApKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFVwZGF0ZSA8cHJvZ3Jlc3M+IGVsZW1lbnRzXG4gICAgICAgIGZ1bmN0aW9uIF91cGRhdGVQcm9ncmVzcyhldmVudCkge1xuICAgICAgICAgICAgaWYgKCFwbHlyLnN1cHBvcnRlZC5mdWxsKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgcHJvZ3Jlc3MgICAgPSBwbHlyLnByb2dyZXNzLnBsYXllZCxcbiAgICAgICAgICAgICAgICB2YWx1ZSAgICAgICA9IDAsXG4gICAgICAgICAgICAgICAgZHVyYXRpb24gICAgPSBfZ2V0RHVyYXRpb24oKTtcblxuICAgICAgICAgICAgaWYgKGV2ZW50KSB7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChldmVudC50eXBlKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFZpZGVvIHBsYXlpbmdcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAndGltZXVwZGF0ZSc6XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ3NlZWtpbmcnOlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBseXIuY29udHJvbHMucHJlc3NlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSBfZ2V0UGVyY2VudGFnZShwbHlyLm1lZGlhLmN1cnJlbnRUaW1lLCBkdXJhdGlvbik7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFNldCBzZWVrIHJhbmdlIHZhbHVlIG9ubHkgaWYgaXQncyBhICduYXR1cmFsJyB0aW1lIGV2ZW50XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXZlbnQudHlwZSA9PT0gJ3RpbWV1cGRhdGUnICYmIHBseXIuYnV0dG9ucy5zZWVrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGx5ci5idXR0b25zLnNlZWsudmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gQ2hlY2sgYnVmZmVyIHN0YXR1c1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdwbGF5aW5nJzpcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAncHJvZ3Jlc3MnOlxuICAgICAgICAgICAgICAgICAgICAgICAgcHJvZ3Jlc3MgICAgPSBwbHlyLnByb2dyZXNzLmJ1ZmZlcjtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlICAgICAgID0gKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBidWZmZXJlZCA9IHBseXIubWVkaWEuYnVmZmVyZWQ7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYnVmZmVyZWQgJiYgYnVmZmVyZWQubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEhUTUw1XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfZ2V0UGVyY2VudGFnZShidWZmZXJlZC5lbmQoMCksIGR1cmF0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKF9pcy5udW1iZXIoYnVmZmVyZWQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFlvdVR1YmUgcmV0dXJucyBiZXR3ZWVuIDAgYW5kIDFcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChidWZmZXJlZCAqIDEwMCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KSgpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIFNldCB2YWx1ZXNcbiAgICAgICAgICAgIF9zZXRQcm9ncmVzcyhwcm9ncmVzcywgdmFsdWUpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gU2V0IDxwcm9ncmVzcz4gdmFsdWVcbiAgICAgICAgZnVuY3Rpb24gX3NldFByb2dyZXNzKHByb2dyZXNzLCB2YWx1ZSkge1xuICAgICAgICAgICAgaWYgKCFwbHlyLnN1cHBvcnRlZC5mdWxsKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBEZWZhdWx0IHRvIDBcbiAgICAgICAgICAgIGlmIChfaXMudW5kZWZpbmVkKHZhbHVlKSkge1xuICAgICAgICAgICAgICAgIHZhbHVlID0gMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIERlZmF1bHQgdG8gYnVmZmVyIG9yIGJhaWxcbiAgICAgICAgICAgIGlmIChfaXMudW5kZWZpbmVkKHByb2dyZXNzKSkge1xuICAgICAgICAgICAgICAgIGlmIChwbHlyLnByb2dyZXNzICYmIHBseXIucHJvZ3Jlc3MuYnVmZmVyKSB7XG4gICAgICAgICAgICAgICAgICAgIHByb2dyZXNzID0gcGx5ci5wcm9ncmVzcy5idWZmZXI7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gT25lIHByb2dyZXNzIGVsZW1lbnQgcGFzc2VkXG4gICAgICAgICAgICBpZiAoX2lzLmh0bWxFbGVtZW50KHByb2dyZXNzKSkge1xuICAgICAgICAgICAgICAgIHByb2dyZXNzLnZhbHVlID0gdmFsdWU7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHByb2dyZXNzKSB7XG4gICAgICAgICAgICAgICAgLy8gT2JqZWN0IG9mIHByb2dyZXNzICsgdGV4dCBlbGVtZW50XG4gICAgICAgICAgICAgICAgaWYgKHByb2dyZXNzLmJhcikge1xuICAgICAgICAgICAgICAgICAgICBwcm9ncmVzcy5iYXIudmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHByb2dyZXNzLnRleHQpIHtcbiAgICAgICAgICAgICAgICAgICAgcHJvZ3Jlc3MudGV4dC5pbm5lckhUTUwgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyBVcGRhdGUgdGhlIGRpc3BsYXllZCB0aW1lXG4gICAgICAgIGZ1bmN0aW9uIF91cGRhdGVUaW1lRGlzcGxheSh0aW1lLCBlbGVtZW50KSB7XG4gICAgICAgICAgICAvLyBCYWlsIGlmIHRoZXJlJ3Mgbm8gZHVyYXRpb24gZGlzcGxheVxuICAgICAgICAgICAgaWYgKCFlbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBGYWxsYmFjayB0byAwXG4gICAgICAgICAgICBpZiAoaXNOYU4odGltZSkpIHtcbiAgICAgICAgICAgICAgICB0aW1lID0gMDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcGx5ci5zZWNzID0gcGFyc2VJbnQodGltZSAlIDYwKTtcbiAgICAgICAgICAgIHBseXIubWlucyA9IHBhcnNlSW50KCh0aW1lIC8gNjApICUgNjApO1xuICAgICAgICAgICAgcGx5ci5ob3VycyA9IHBhcnNlSW50KCgodGltZSAvIDYwKSAvIDYwKSAlIDYwKTtcblxuICAgICAgICAgICAgLy8gRG8gd2UgbmVlZCB0byBkaXNwbGF5IGhvdXJzP1xuICAgICAgICAgICAgdmFyIGRpc3BsYXlIb3VycyA9IChwYXJzZUludCgoKF9nZXREdXJhdGlvbigpIC8gNjApIC8gNjApICUgNjApID4gMCk7XG5cbiAgICAgICAgICAgIC8vIEVuc3VyZSBpdCdzIHR3byBkaWdpdHMuIEZvciBleGFtcGxlLCAwMyByYXRoZXIgdGhhbiAzLlxuICAgICAgICAgICAgcGx5ci5zZWNzID0gKCcwJyArIHBseXIuc2Vjcykuc2xpY2UoLTIpO1xuICAgICAgICAgICAgcGx5ci5taW5zID0gKCcwJyArIHBseXIubWlucykuc2xpY2UoLTIpO1xuXG4gICAgICAgICAgICAvLyBSZW5kZXJcbiAgICAgICAgICAgIGVsZW1lbnQuaW5uZXJIVE1MID0gKGRpc3BsYXlIb3VycyA/IHBseXIuaG91cnMgKyAnOicgOiAnJykgKyBwbHlyLm1pbnMgKyAnOicgKyBwbHlyLnNlY3M7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBTaG93IHRoZSBkdXJhdGlvbiBvbiBtZXRhZGF0YWxvYWRlZFxuICAgICAgICBmdW5jdGlvbiBfZGlzcGxheUR1cmF0aW9uKCkge1xuICAgICAgICAgICAgaWYgKCFwbHlyLnN1cHBvcnRlZC5mdWxsKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBEZXRlcm1pbmUgZHVyYXRpb25cbiAgICAgICAgICAgIHZhciBkdXJhdGlvbiA9IF9nZXREdXJhdGlvbigpIHx8IDA7XG5cbiAgICAgICAgICAgIC8vIElmIHRoZXJlJ3Mgb25seSBvbmUgdGltZSBkaXNwbGF5LCBkaXNwbGF5IGR1cmF0aW9uIHRoZXJlXG4gICAgICAgICAgICBpZiAoIXBseXIuZHVyYXRpb24gJiYgY29uZmlnLmRpc3BsYXlEdXJhdGlvbiAmJiBwbHlyLm1lZGlhLnBhdXNlZCkge1xuICAgICAgICAgICAgICAgIF91cGRhdGVUaW1lRGlzcGxheShkdXJhdGlvbiwgcGx5ci5jdXJyZW50VGltZSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIElmIHRoZXJlJ3MgYSBkdXJhdGlvbiBlbGVtZW50LCB1cGRhdGUgY29udGVudFxuICAgICAgICAgICAgaWYgKHBseXIuZHVyYXRpb24pIHtcbiAgICAgICAgICAgICAgICBfdXBkYXRlVGltZURpc3BsYXkoZHVyYXRpb24sIHBseXIuZHVyYXRpb24pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBVcGRhdGUgdGhlIHRvb2x0aXAgKGlmIHZpc2libGUpXG4gICAgICAgICAgICBfdXBkYXRlU2Vla1Rvb2x0aXAoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEhhbmRsZSB0aW1lIGNoYW5nZSBldmVudFxuICAgICAgICBmdW5jdGlvbiBfdGltZVVwZGF0ZShldmVudCkge1xuICAgICAgICAgICAgLy8gRHVyYXRpb25cbiAgICAgICAgICAgIF91cGRhdGVUaW1lRGlzcGxheShwbHlyLm1lZGlhLmN1cnJlbnRUaW1lLCBwbHlyLmN1cnJlbnRUaW1lKTtcblxuICAgICAgICAgICAgLy8gSWdub3JlIHVwZGF0ZXMgd2hpbGUgc2Vla2luZ1xuICAgICAgICAgICAgaWYgKGV2ZW50ICYmIGV2ZW50LnR5cGUgPT09ICd0aW1ldXBkYXRlJyAmJiBwbHlyLm1lZGlhLnNlZWtpbmcpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIFBsYXlpbmcgcHJvZ3Jlc3NcbiAgICAgICAgICAgIF91cGRhdGVQcm9ncmVzcyhldmVudCk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBVcGRhdGUgc2VlayByYW5nZSBhbmQgcHJvZ3Jlc3NcbiAgICAgICAgZnVuY3Rpb24gX3VwZGF0ZVNlZWtEaXNwbGF5KHRpbWUpIHtcbiAgICAgICAgICAgIC8vIERlZmF1bHQgdG8gMFxuICAgICAgICAgICAgaWYgKCFfaXMubnVtYmVyKHRpbWUpKSB7XG4gICAgICAgICAgICAgICAgdGltZSA9IDA7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBkdXJhdGlvbiAgICA9IF9nZXREdXJhdGlvbigpLFxuICAgICAgICAgICAgICAgIHZhbHVlICAgICAgID0gX2dldFBlcmNlbnRhZ2UodGltZSwgZHVyYXRpb24pO1xuXG4gICAgICAgICAgICAvLyBVcGRhdGUgcHJvZ3Jlc3NcbiAgICAgICAgICAgIGlmIChwbHlyLnByb2dyZXNzICYmIHBseXIucHJvZ3Jlc3MucGxheWVkKSB7XG4gICAgICAgICAgICAgICAgcGx5ci5wcm9ncmVzcy5wbGF5ZWQudmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gVXBkYXRlIHNlZWsgcmFuZ2UgaW5wdXRcbiAgICAgICAgICAgIGlmIChwbHlyLmJ1dHRvbnMgJiYgcGx5ci5idXR0b25zLnNlZWspIHtcbiAgICAgICAgICAgICAgICBwbHlyLmJ1dHRvbnMuc2Vlay52YWx1ZSA9IHZhbHVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gVXBkYXRlIGhvdmVyIHRvb2x0aXAgZm9yIHNlZWtpbmdcbiAgICAgICAgZnVuY3Rpb24gX3VwZGF0ZVNlZWtUb29sdGlwKGV2ZW50KSB7XG4gICAgICAgICAgICB2YXIgZHVyYXRpb24gPSBfZ2V0RHVyYXRpb24oKTtcblxuICAgICAgICAgICAgLy8gQmFpbCBpZiBzZXR0aW5nIG5vdCB0cnVlXG4gICAgICAgICAgICBpZiAoIWNvbmZpZy50b29sdGlwcy5zZWVrIHx8ICFwbHlyLnByb2dyZXNzLmNvbnRhaW5lciB8fCBkdXJhdGlvbiA9PT0gMCkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gQ2FsY3VsYXRlIHBlcmNlbnRhZ2VcbiAgICAgICAgICAgIHZhciBjbGllbnRSZWN0ICA9IHBseXIucHJvZ3Jlc3MuY29udGFpbmVyLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLFxuICAgICAgICAgICAgICAgIHBlcmNlbnQgICAgID0gMCxcbiAgICAgICAgICAgICAgICB2aXNpYmxlICAgICA9IGNvbmZpZy5jbGFzc2VzLnRvb2x0aXAgKyAnLS12aXNpYmxlJztcblxuICAgICAgICAgICAgLy8gRGV0ZXJtaW5lIHBlcmNlbnRhZ2UsIGlmIGFscmVhZHkgdmlzaWJsZVxuICAgICAgICAgICAgaWYgKCFldmVudCkge1xuICAgICAgICAgICAgICAgIGlmIChfaGFzQ2xhc3MocGx5ci5wcm9ncmVzcy50b29sdGlwLCB2aXNpYmxlKSkge1xuICAgICAgICAgICAgICAgICAgICBwZXJjZW50ID0gcGx5ci5wcm9ncmVzcy50b29sdGlwLnN0eWxlLmxlZnQucmVwbGFjZSgnJScsICcnKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBwZXJjZW50ID0gKCgxMDAgLyBjbGllbnRSZWN0LndpZHRoKSAqIChldmVudC5wYWdlWCAtIGNsaWVudFJlY3QubGVmdCkpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBTZXQgYm91bmRzXG4gICAgICAgICAgICBpZiAocGVyY2VudCA8IDApIHtcbiAgICAgICAgICAgICAgICBwZXJjZW50ID0gMDtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAocGVyY2VudCA+IDEwMCkge1xuICAgICAgICAgICAgICAgIHBlcmNlbnQgPSAxMDA7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIERpc3BsYXkgdGhlIHRpbWUgYSBjbGljayB3b3VsZCBzZWVrIHRvXG4gICAgICAgICAgICBfdXBkYXRlVGltZURpc3BsYXkoKChkdXJhdGlvbiAvIDEwMCkgKiBwZXJjZW50KSwgcGx5ci5wcm9ncmVzcy50b29sdGlwKTtcblxuICAgICAgICAgICAgLy8gU2V0IHBvc2l0aW9uXG4gICAgICAgICAgICBwbHlyLnByb2dyZXNzLnRvb2x0aXAuc3R5bGUubGVmdCA9IHBlcmNlbnQgKyBcIiVcIjtcblxuICAgICAgICAgICAgLy8gU2hvdy9oaWRlIHRoZSB0b29sdGlwXG4gICAgICAgICAgICAvLyBJZiB0aGUgZXZlbnQgaXMgYSBtb3VlcyBpbi9vdXQgYW5kIHBlcmNlbnRhZ2UgaXMgaW5zaWRlIGJvdW5kc1xuICAgICAgICAgICAgaWYgKGV2ZW50ICYmIF9pbkFycmF5KFsnbW91c2VlbnRlcicsICdtb3VzZWxlYXZlJ10sIGV2ZW50LnR5cGUpKSB7XG4gICAgICAgICAgICAgICAgX3RvZ2dsZUNsYXNzKHBseXIucHJvZ3Jlc3MudG9vbHRpcCwgdmlzaWJsZSwgKGV2ZW50LnR5cGUgPT09ICdtb3VzZWVudGVyJykpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gU2hvdyB0aGUgcGxheWVyIGNvbnRyb2xzIGluIGZ1bGxzY3JlZW4gbW9kZVxuICAgICAgICBmdW5jdGlvbiBfdG9nZ2xlQ29udHJvbHModG9nZ2xlKSB7XG4gICAgICAgICAgICAvLyBEb24ndCBoaWRlIGlmIGNvbmZpZyBzYXlzIG5vdCB0bywgaXQncyBhdWRpbywgb3Igbm90IHJlYWR5IG9yIGxvYWRpbmdcbiAgICAgICAgICAgIGlmICghY29uZmlnLmhpZGVDb250cm9scyB8fCBwbHlyLnR5cGUgPT09ICdhdWRpbycpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBkZWxheSA9IDAsXG4gICAgICAgICAgICAgICAgaXNFbnRlckZ1bGxzY3JlZW4gPSBmYWxzZSxcbiAgICAgICAgICAgICAgICBzaG93ID0gdG9nZ2xlLFxuICAgICAgICAgICAgICAgIGxvYWRpbmcgPSBfaGFzQ2xhc3MocGx5ci5jb250YWluZXIsIGNvbmZpZy5jbGFzc2VzLmxvYWRpbmcpO1xuXG4gICAgICAgICAgICAvLyBEZWZhdWx0IHRvIGZhbHNlIGlmIG5vIGJvb2xlYW5cbiAgICAgICAgICAgIGlmICghX2lzLmJvb2xlYW4odG9nZ2xlKSkge1xuICAgICAgICAgICAgICAgIGlmICh0b2dnbGUgJiYgdG9nZ2xlLnR5cGUpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gSXMgdGhlIGVudGVyIGZ1bGxzY3JlZW4gZXZlbnRcbiAgICAgICAgICAgICAgICAgICAgaXNFbnRlckZ1bGxzY3JlZW4gPSAodG9nZ2xlLnR5cGUgPT09ICdlbnRlcmZ1bGxzY3JlZW4nKTtcblxuICAgICAgICAgICAgICAgICAgICAvLyBXaGV0aGVyIHRvIHNob3cgY29udHJvbHNcbiAgICAgICAgICAgICAgICAgICAgc2hvdyA9IF9pbkFycmF5KFsnbW91c2Vtb3ZlJywgJ3RvdWNoc3RhcnQnLCAnbW91c2VlbnRlcicsICdmb2N1cyddLCB0b2dnbGUudHlwZSk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gRGVsYXkgaGlkaW5nIG9uIG1vdmUgZXZlbnRzXG4gICAgICAgICAgICAgICAgICAgIGlmIChfaW5BcnJheShbJ21vdXNlbW92ZScsICd0b3VjaG1vdmUnXSwgdG9nZ2xlLnR5cGUpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkZWxheSA9IDIwMDA7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAvLyBEZWxheSBhIGxpdHRsZSBtb3JlIGZvciBrZXlib2FyZCB1c2Vyc1xuICAgICAgICAgICAgICAgICAgICBpZiAodG9nZ2xlLnR5cGUgPT09ICdmb2N1cycpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlbGF5ID0gMzAwMDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHNob3cgPSBfaGFzQ2xhc3MocGx5ci5jb250YWluZXIsIGNvbmZpZy5jbGFzc2VzLmhpZGVDb250cm9scyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBDbGVhciB0aW1lciBldmVyeSBtb3ZlbWVudFxuICAgICAgICAgICAgd2luZG93LmNsZWFyVGltZW91dCh0aW1lcnMuaG92ZXIpO1xuXG4gICAgICAgICAgICAvLyBJZiB0aGUgbW91c2UgaXMgbm90IG92ZXIgdGhlIGNvbnRyb2xzLCBzZXQgYSB0aW1lb3V0IHRvIGhpZGUgdGhlbVxuICAgICAgICAgICAgaWYgKHNob3cgfHwgcGx5ci5tZWRpYS5wYXVzZWQgfHwgbG9hZGluZykge1xuICAgICAgICAgICAgICAgIF90b2dnbGVDbGFzcyhwbHlyLmNvbnRhaW5lciwgY29uZmlnLmNsYXNzZXMuaGlkZUNvbnRyb2xzLCBmYWxzZSk7XG5cbiAgICAgICAgICAgICAgICAvLyBBbHdheXMgc2hvdyBjb250cm9scyB3aGVuIHBhdXNlZCBvciBpZiB0b3VjaFxuICAgICAgICAgICAgICAgIGlmIChwbHlyLm1lZGlhLnBhdXNlZCB8fCBsb2FkaW5nKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBEZWxheSBmb3IgaGlkaW5nIG9uIHRvdWNoXG4gICAgICAgICAgICAgICAgaWYgKHBseXIuYnJvd3Nlci5pc1RvdWNoKSB7XG4gICAgICAgICAgICAgICAgICAgIGRlbGF5ID0gMzAwMDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIElmIHRvZ2dsZSBpcyBmYWxzZSBvciBpZiB3ZSdyZSBwbGF5aW5nIChyZWdhcmRsZXNzIG9mIHRvZ2dsZSksXG4gICAgICAgICAgICAvLyB0aGVuIHNldCB0aGUgdGltZXIgdG8gaGlkZSB0aGUgY29udHJvbHNcbiAgICAgICAgICAgIGlmICghc2hvdyB8fCAhcGx5ci5tZWRpYS5wYXVzZWQpIHtcbiAgICAgICAgICAgICAgICB0aW1lcnMuaG92ZXIgPSB3aW5kb3cuc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gSWYgdGhlIG1vdXNlIGlzIG92ZXIgdGhlIGNvbnRyb2xzIChhbmQgbm90IGVudGVyaW5nIGZ1bGxzY3JlZW4pLCBiYWlsXG4gICAgICAgICAgICAgICAgICAgIGlmICgocGx5ci5jb250cm9scy5wcmVzc2VkIHx8IHBseXIuY29udHJvbHMuaG92ZXIpICYmICFpc0VudGVyRnVsbHNjcmVlbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgX3RvZ2dsZUNsYXNzKHBseXIuY29udGFpbmVyLCBjb25maWcuY2xhc3Nlcy5oaWRlQ29udHJvbHMsIHRydWUpO1xuICAgICAgICAgICAgICAgIH0sIGRlbGF5KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEFkZCBjb21tb24gZnVuY3Rpb24gdG8gcmV0cmlldmUgbWVkaWEgc291cmNlXG4gICAgICAgIGZ1bmN0aW9uIF9zb3VyY2Uoc291cmNlKSB7XG4gICAgICAgICAgICAvLyBJZiBub3QgbnVsbCBvciB1bmRlZmluZWQsIHBhcnNlIGl0XG4gICAgICAgICAgICBpZiAoIV9pcy51bmRlZmluZWQoc291cmNlKSkge1xuICAgICAgICAgICAgICAgIF91cGRhdGVTb3VyY2Uoc291cmNlKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIFJldHVybiB0aGUgY3VycmVudCBzb3VyY2VcbiAgICAgICAgICAgIHZhciB1cmw7XG4gICAgICAgICAgICBzd2l0Y2gocGx5ci50eXBlKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAneW91dHViZSc6XG4gICAgICAgICAgICAgICAgICAgIHVybCA9IHBseXIuZW1iZWQuZ2V0VmlkZW9VcmwoKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICBjYXNlICd2aW1lbyc6XG4gICAgICAgICAgICAgICAgICAgIHBseXIuZW1iZWQuZ2V0VmlkZW9VcmwudGhlbihmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHVybCA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICBjYXNlICdzb3VuZGNsb3VkJzpcbiAgICAgICAgICAgICAgICAgICAgcGx5ci5lbWJlZC5nZXRDdXJyZW50U291bmQoZnVuY3Rpb24ob2JqZWN0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB1cmwgPSBvYmplY3QucGVybWFsaW5rX3VybDtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgdXJsID0gcGx5ci5tZWRpYS5jdXJyZW50U3JjO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIHVybCB8fCAnJztcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFVwZGF0ZSBzb3VyY2VcbiAgICAgICAgLy8gU291cmNlcyBhcmUgbm90IGNoZWNrZWQgZm9yIHN1cHBvcnQgc28gYmUgY2FyZWZ1bFxuICAgICAgICBmdW5jdGlvbiBfdXBkYXRlU291cmNlKHNvdXJjZSkge1xuICAgICAgICAgICAgaWYgKCFfaXMub2JqZWN0KHNvdXJjZSkgfHwgISgnc291cmNlcycgaW4gc291cmNlKSB8fCAhc291cmNlLnNvdXJjZXMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgX3dhcm4oJ0ludmFsaWQgc291cmNlIGZvcm1hdCcpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gUmVtb3ZlIHJlYWR5IGNsYXNzIGhvb2tcbiAgICAgICAgICAgIF90b2dnbGVDbGFzcyhwbHlyLmNvbnRhaW5lciwgY29uZmlnLmNsYXNzZXMucmVhZHksIGZhbHNlKTtcblxuICAgICAgICAgICAgLy8gUGF1c2UgcGxheWJhY2tcbiAgICAgICAgICAgIF9wYXVzZSgpO1xuXG4gICAgICAgICAgICAvLyBVcGRhdGUgc2VlayByYW5nZSBhbmQgcHJvZ3Jlc3NcbiAgICAgICAgICAgIF91cGRhdGVTZWVrRGlzcGxheSgpO1xuXG4gICAgICAgICAgICAvLyBSZXNldCBidWZmZXIgcHJvZ3Jlc3NcbiAgICAgICAgICAgIF9zZXRQcm9ncmVzcygpO1xuXG4gICAgICAgICAgICAvLyBDYW5jZWwgY3VycmVudCBuZXR3b3JrIHJlcXVlc3RzXG4gICAgICAgICAgICBfY2FuY2VsUmVxdWVzdHMoKTtcblxuICAgICAgICAgICAgLy8gU2V0dXAgbmV3IHNvdXJjZVxuICAgICAgICAgICAgZnVuY3Rpb24gc2V0dXAoKSB7XG4gICAgICAgICAgICAgICAgLy8gUmVtb3ZlIGVtYmVkIG9iamVjdFxuICAgICAgICAgICAgICAgIHBseXIuZW1iZWQgPSBudWxsO1xuXG4gICAgICAgICAgICAgICAgLy8gUmVtb3ZlIHRoZSBvbGQgbWVkaWFcbiAgICAgICAgICAgICAgICBfcmVtb3ZlKHBseXIubWVkaWEpO1xuXG4gICAgICAgICAgICAgICAgLy8gUmVtb3ZlIHZpZGVvIGNvbnRhaW5lclxuICAgICAgICAgICAgICAgIGlmIChwbHlyLnR5cGUgPT09ICd2aWRlbycgJiYgcGx5ci52aWRlb0NvbnRhaW5lcikge1xuICAgICAgICAgICAgICAgICAgICBfcmVtb3ZlKHBseXIudmlkZW9Db250YWluZXIpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIFJlc2V0IGNsYXNzIG5hbWVcbiAgICAgICAgICAgICAgICBpZiAocGx5ci5jb250YWluZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgcGx5ci5jb250YWluZXIucmVtb3ZlQXR0cmlidXRlKCdjbGFzcycpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIFNldCB0aGUgdHlwZVxuICAgICAgICAgICAgICAgIGlmICgndHlwZScgaW4gc291cmNlKSB7XG4gICAgICAgICAgICAgICAgICAgIHBseXIudHlwZSA9IHNvdXJjZS50eXBlO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIEdldCBjaGlsZCB0eXBlIGZvciB2aWRlbyAoaXQgbWlnaHQgYmUgYW4gZW1iZWQpXG4gICAgICAgICAgICAgICAgICAgIGlmIChwbHlyLnR5cGUgPT09ICd2aWRlbycpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmaXJzdFNvdXJjZSA9IHNvdXJjZS5zb3VyY2VzWzBdO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoJ3R5cGUnIGluIGZpcnN0U291cmNlICYmIF9pbkFycmF5KGNvbmZpZy50eXBlcy5lbWJlZCwgZmlyc3RTb3VyY2UudHlwZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbHlyLnR5cGUgPSBmaXJzdFNvdXJjZS50eXBlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gQ2hlY2sgZm9yIHN1cHBvcnRcbiAgICAgICAgICAgICAgICBwbHlyLnN1cHBvcnRlZCA9IHN1cHBvcnRlZChwbHlyLnR5cGUpO1xuXG4gICAgICAgICAgICAgICAgLy8gQ3JlYXRlIG5ldyBtYXJrdXBcbiAgICAgICAgICAgICAgICBzd2l0Y2gocGx5ci50eXBlKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ3ZpZGVvJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIHBseXIubWVkaWEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd2aWRlbycpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnYXVkaW8nOlxuICAgICAgICAgICAgICAgICAgICAgICAgcGx5ci5tZWRpYSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2F1ZGlvJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgICAgICBjYXNlICd5b3V0dWJlJzpcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAndmltZW8nOlxuICAgICAgICAgICAgICAgICAgICBjYXNlICdzb3VuZGNsb3VkJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIHBseXIubWVkaWEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBseXIuZW1iZWRJZCA9IHNvdXJjZS5zb3VyY2VzWzBdLnNyYztcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIEluamVjdCB0aGUgbmV3IGVsZW1lbnRcbiAgICAgICAgICAgICAgICBfcHJlcGVuZENoaWxkKHBseXIuY29udGFpbmVyLCBwbHlyLm1lZGlhKTtcblxuICAgICAgICAgICAgICAgIC8vIEF1dG9wbGF5IHRoZSBuZXcgc291cmNlP1xuICAgICAgICAgICAgICAgIGlmIChfaXMuYm9vbGVhbihzb3VyY2UuYXV0b3BsYXkpKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbmZpZy5hdXRvcGxheSA9IHNvdXJjZS5hdXRvcGxheTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBTZXQgYXR0cmlidXRlcyBmb3IgYXVkaW8gYW5kIHZpZGVvXG4gICAgICAgICAgICAgICAgaWYgKF9pbkFycmF5KGNvbmZpZy50eXBlcy5odG1sNSwgcGx5ci50eXBlKSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoY29uZmlnLmNyb3Nzb3JpZ2luKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwbHlyLm1lZGlhLnNldEF0dHJpYnV0ZSgnY3Jvc3NvcmlnaW4nLCAnJyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKGNvbmZpZy5hdXRvcGxheSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcGx5ci5tZWRpYS5zZXRBdHRyaWJ1dGUoJ2F1dG9wbGF5JywgJycpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmICgncG9zdGVyJyBpbiBzb3VyY2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBseXIubWVkaWEuc2V0QXR0cmlidXRlKCdwb3N0ZXInLCBzb3VyY2UucG9zdGVyKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoY29uZmlnLmxvb3ApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBseXIubWVkaWEuc2V0QXR0cmlidXRlKCdsb29wJywgJycpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gUmVzdG9yZSBjbGFzcyBob29rc1xuICAgICAgICAgICAgICAgIF90b2dnbGVDbGFzcyhwbHlyLmNvbnRhaW5lciwgY29uZmlnLmNsYXNzZXMuZnVsbHNjcmVlbi5hY3RpdmUsIHBseXIuaXNGdWxsc2NyZWVuKTtcbiAgICAgICAgICAgICAgICBfdG9nZ2xlQ2xhc3MocGx5ci5jb250YWluZXIsIGNvbmZpZy5jbGFzc2VzLmNhcHRpb25zLmFjdGl2ZSwgcGx5ci5jYXB0aW9uc0VuYWJsZWQpO1xuICAgICAgICAgICAgICAgIF90b2dnbGVTdHlsZUhvb2soKTtcblxuICAgICAgICAgICAgICAgIC8vIFNldCBuZXcgc291cmNlcyBmb3IgaHRtbDVcbiAgICAgICAgICAgICAgICBpZiAoX2luQXJyYXkoY29uZmlnLnR5cGVzLmh0bWw1LCBwbHlyLnR5cGUpKSB7XG4gICAgICAgICAgICAgICAgICAgIF9pbnNlcnRDaGlsZEVsZW1lbnRzKCdzb3VyY2UnLCBzb3VyY2Uuc291cmNlcyk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gU2V0IHVwIGZyb20gc2NyYXRjaFxuICAgICAgICAgICAgICAgIF9zZXR1cE1lZGlhKCk7XG5cbiAgICAgICAgICAgICAgICAvLyBIVE1MNSBzdHVmZlxuICAgICAgICAgICAgICAgIGlmIChfaW5BcnJheShjb25maWcudHlwZXMuaHRtbDUsIHBseXIudHlwZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gU2V0dXAgY2FwdGlvbnNcbiAgICAgICAgICAgICAgICAgICAgaWYgKCd0cmFja3MnIGluIHNvdXJjZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgX2luc2VydENoaWxkRWxlbWVudHMoJ3RyYWNrJywgc291cmNlLnRyYWNrcyk7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAvLyBMb2FkIEhUTUw1IHNvdXJjZXNcbiAgICAgICAgICAgICAgICAgICAgcGx5ci5tZWRpYS5sb2FkKCk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gSWYgSFRNTDUgb3IgZW1iZWQgYnV0IG5vdCBmdWxseSBzdXBwb3J0ZWQsIHNldHVwSW50ZXJmYWNlIGFuZCBjYWxsIHJlYWR5IG5vd1xuICAgICAgICAgICAgICAgIGlmIChfaW5BcnJheShjb25maWcudHlwZXMuaHRtbDUsIHBseXIudHlwZSkgfHwgKF9pbkFycmF5KGNvbmZpZy50eXBlcy5lbWJlZCwgcGx5ci50eXBlKSAmJiAhcGx5ci5zdXBwb3J0ZWQuZnVsbCkpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gU2V0dXAgaW50ZXJmYWNlXG4gICAgICAgICAgICAgICAgICAgIF9zZXR1cEludGVyZmFjZSgpO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIENhbGwgcmVhZHlcbiAgICAgICAgICAgICAgICAgICAgX3JlYWR5KCk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gU2V0IGFyaWEgdGl0bGUgYW5kIGlmcmFtZSB0aXRsZVxuICAgICAgICAgICAgICAgIGNvbmZpZy50aXRsZSA9IHNvdXJjZS50aXRsZTtcbiAgICAgICAgICAgICAgICBfc2V0VGl0bGUoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gRGVzdHJveSBpbnN0YW5jZSBhZG4gd2FpdCBmb3IgY2FsbGJhY2tcbiAgICAgICAgICAgIC8vIFZpbWVvIHRocm93cyBhIHdvYmJseSBpZiB5b3UgZG9uJ3Qgd2FpdFxuICAgICAgICAgICAgX2Rlc3Ryb3koc2V0dXAsIGZhbHNlKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFVwZGF0ZSBwb3N0ZXJcbiAgICAgICAgZnVuY3Rpb24gX3VwZGF0ZVBvc3Rlcihzb3VyY2UpIHtcbiAgICAgICAgICAgIGlmIChwbHlyLnR5cGUgPT09ICd2aWRlbycpIHtcbiAgICAgICAgICAgICAgICBwbHlyLm1lZGlhLnNldEF0dHJpYnV0ZSgncG9zdGVyJywgc291cmNlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIExpc3RlbiBmb3IgY29udHJvbCBldmVudHNcbiAgICAgICAgZnVuY3Rpb24gX2NvbnRyb2xMaXN0ZW5lcnMoKSB7XG4gICAgICAgICAgICAvLyBJRSBkb2Vzbid0IHN1cHBvcnQgaW5wdXQgZXZlbnQsIHNvIHdlIGZhbGxiYWNrIHRvIGNoYW5nZVxuICAgICAgICAgICAgdmFyIGlucHV0RXZlbnQgPSAocGx5ci5icm93c2VyLmlzSUUgPyAnY2hhbmdlJyA6ICdpbnB1dCcpO1xuXG4gICAgICAgICAgICAvLyBDbGljayBwbGF5L3BhdXNlIGhlbHBlclxuICAgICAgICAgICAgZnVuY3Rpb24gdG9nZ2xlUGxheSgpIHtcbiAgICAgICAgICAgICAgICB2YXIgcGxheSA9IF90b2dnbGVQbGF5KCk7XG5cbiAgICAgICAgICAgICAgICAvLyBEZXRlcm1pbmUgd2hpY2ggYnV0dG9uc1xuICAgICAgICAgICAgICAgIHZhciB0cmlnZ2VyID0gcGx5ci5idXR0b25zW3BsYXkgPyAncGxheScgOiAncGF1c2UnXSxcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0ID0gcGx5ci5idXR0b25zW3BsYXkgPyAncGF1c2UnIDogJ3BsYXknXTtcblxuICAgICAgICAgICAgICAgIC8vIEdldCB0aGUgbGFzdCBwbGF5IGJ1dHRvbiB0byBhY2NvdW50IGZvciB0aGUgbGFyZ2UgcGxheSBidXR0b25cbiAgICAgICAgICAgICAgICBpZiAodGFyZ2V0ICYmIHRhcmdldC5sZW5ndGggPiAxKSB7XG4gICAgICAgICAgICAgICAgICAgIHRhcmdldCA9IHRhcmdldFt0YXJnZXQubGVuZ3RoIC0gMV07XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0ID0gdGFyZ2V0WzBdO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIFNldHVwIGZvY3VzIGFuZCB0YWIgZm9jdXNcbiAgICAgICAgICAgICAgICBpZiAodGFyZ2V0KSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBoYWRUYWJGb2N1cyA9IF9oYXNDbGFzcyh0cmlnZ2VyLCBjb25maWcuY2xhc3Nlcy50YWJGb2N1cyk7XG5cbiAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldC5mb2N1cygpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaGFkVGFiRm9jdXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdG9nZ2xlQ2xhc3ModHJpZ2dlciwgY29uZmlnLmNsYXNzZXMudGFiRm9jdXMsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdG9nZ2xlQ2xhc3ModGFyZ2V0LCBjb25maWcuY2xhc3Nlcy50YWJGb2N1cywgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0sIDEwMCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBHZXQgdGhlIGZvY3VzZWQgZWxlbWVudFxuICAgICAgICAgICAgZnVuY3Rpb24gZ2V0Rm9jdXNFbGVtZW50KCkge1xuICAgICAgICAgICAgICAgIHZhciBmb2N1c2VkID0gZG9jdW1lbnQuYWN0aXZlRWxlbWVudDtcblxuICAgICAgICAgICAgICAgIGlmICghZm9jdXNlZCB8fCBmb2N1c2VkID09PSBkb2N1bWVudC5ib2R5KSB7XG4gICAgICAgICAgICAgICAgICAgIGZvY3VzZWQgPSBudWxsO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGZvY3VzZWQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCc6Zm9jdXMnKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gZm9jdXNlZDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gR2V0IHRoZSBrZXkgY29kZSBmb3IgYW4gZXZlbnRcbiAgICAgICAgICAgIGZ1bmN0aW9uIGdldEtleUNvZGUoZXZlbnQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZXZlbnQua2V5Q29kZSA/IGV2ZW50LmtleUNvZGUgOiBldmVudC53aGljaDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gRGV0ZWN0IHRhYiBmb2N1c1xuICAgICAgICAgICAgZnVuY3Rpb24gY2hlY2tUYWJGb2N1cyhmb2N1c2VkKSB7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgYnV0dG9uIGluIHBseXIuYnV0dG9ucykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZWxlbWVudCA9IHBseXIuYnV0dG9uc1tidXR0b25dO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmIChfaXMubm9kZUxpc3QoZWxlbWVudCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZWxlbWVudC5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90b2dnbGVDbGFzcyhlbGVtZW50W2ldLCBjb25maWcuY2xhc3Nlcy50YWJGb2N1cywgKGVsZW1lbnRbaV0gPT09IGZvY3VzZWQpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIF90b2dnbGVDbGFzcyhlbGVtZW50LCBjb25maWcuY2xhc3Nlcy50YWJGb2N1cywgKGVsZW1lbnQgPT09IGZvY3VzZWQpKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gS2V5Ym9hcmQgc2hvcnRjdXRzXG4gICAgICAgICAgICBpZiAoY29uZmlnLmtleWJvYXJkU2hvcmN1dHMuZm9jdXNlZCkge1xuICAgICAgICAgICAgICAgIHZhciBsYXN0ID0gbnVsbDtcblxuICAgICAgICAgICAgICAgIC8vIEhhbmRsZSBnbG9iYWwgcHJlc3Nlc1xuICAgICAgICAgICAgICAgIGlmIChjb25maWcua2V5Ym9hcmRTaG9yY3V0cy5nbG9iYWwpIHtcbiAgICAgICAgICAgICAgICAgICAgX29uKHdpbmRvdywgJ2tleWRvd24ga2V5dXAnLCBmdW5jdGlvbihldmVudCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNvZGUgPSBnZXRLZXlDb2RlKGV2ZW50KSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvY3VzZWQgPSBnZXRGb2N1c0VsZW1lbnQoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGFsbG93ZWQgPSBbNDgsNDksNTAsNTEsNTIsNTMsNTQsNTYsNTcsNzUsNzcsNzAsNjddLFxuICAgICAgICAgICAgICAgICAgICAgICAgY291bnQgICA9IGdldCgpLmxlbmd0aDtcblxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gT25seSBoYW5kbGUgZ2xvYmFsIGtleSBwcmVzcyBpZiB0aGVyZSdzIG9ubHkgb25lIHBsYXllclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gYW5kIHRoZSBrZXkgaXMgaW4gdGhlIGFsbG93ZWQga2V5c1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gYW5kIGlmIHRoZSBmb2N1c2VkIGVsZW1lbnQgaXMgbm90IGVkaXRhYmxlIChlLmcuIHRleHQgaW5wdXQpXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBhbmQgYW55IHRoYXQgYWNjZXB0IGtleSBpbnB1dCBodHRwOi8vd2ViYWltLm9yZy90ZWNobmlxdWVzL2tleWJvYXJkL1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvdW50ID09PSAxICYmIF9pbkFycmF5KGFsbG93ZWQsIGNvZGUpICYmICghX2lzLmh0bWxFbGVtZW50KGZvY3VzZWQpIHx8ICFfbWF0Y2hlcyhmb2N1c2VkLCBjb25maWcuc2VsZWN0b3JzLmVkaXRhYmxlKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoYW5kbGVLZXkoZXZlbnQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBIYW5kbGUgcHJlc3NlcyBvbiBmb2N1c2VkXG4gICAgICAgICAgICAgICAgX29uKHBseXIuY29udGFpbmVyLCAna2V5ZG93biBrZXl1cCcsIGhhbmRsZUtleSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGhhbmRsZUtleShldmVudCkge1xuICAgICAgICAgICAgICAgIHZhciBjb2RlID0gZ2V0S2V5Q29kZShldmVudCksXG4gICAgICAgICAgICAgICAgICAgIHByZXNzZWQgPSBldmVudC50eXBlID09PSAna2V5ZG93bicsXG4gICAgICAgICAgICAgICAgICAgIGhlbGQgPSBwcmVzc2VkICYmIGNvZGUgPT09IGxhc3Q7XG5cbiAgICAgICAgICAgICAgICAvLyBJZiB0aGUgZXZlbnQgaXMgYnViYmxlZCBmcm9tIHRoZSBtZWRpYSBlbGVtZW50XG4gICAgICAgICAgICAgICAgLy8gRmlyZWZveCBkb2Vzbid0IGdldCB0aGUga2V5Y29kZSBmb3Igd2hhdGV2ZXIgcmVhc29uXG4gICAgICAgICAgICAgICAgaWYgKCFfaXMubnVtYmVyKGNvZGUpKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBTZWVrIGJ5IHRoZSBudW1iZXIga2V5c1xuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHNlZWtCeUtleSgpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gR2V0IGN1cnJlbnQgZHVyYXRpb25cbiAgICAgICAgICAgICAgICAgICAgdmFyIGR1cmF0aW9uID0gcGx5ci5tZWRpYS5kdXJhdGlvbjtcblxuICAgICAgICAgICAgICAgICAgICAvLyBCYWlsIGlmIHdlIGhhdmUgbm8gZHVyYXRpb24gc2V0XG4gICAgICAgICAgICAgICAgICAgIGlmICghX2lzLm51bWJlcihkdXJhdGlvbikpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIC8vIERpdmlkZSB0aGUgbWF4IGR1cmF0aW9uIGludG8gMTB0aCdzIGFuZCB0aW1lcyBieSB0aGUgbnVtYmVyIHZhbHVlXG4gICAgICAgICAgICAgICAgICAgIF9zZWVrKChkdXJhdGlvbiAvIDEwKSAqIChjb2RlIC0gNDgpKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBIYW5kbGUgdGhlIGtleSBvbiBrZXlkb3duXG4gICAgICAgICAgICAgICAgLy8gUmVzZXQgb24ga2V5dXBcbiAgICAgICAgICAgICAgICBpZiAocHJlc3NlZCkge1xuICAgICAgICAgICAgICAgICAgICAvLyBXaGljaCBrZXljb2RlcyBzaG91bGQgd2UgcHJldmVudCBkZWZhdWx0XG4gICAgICAgICAgICAgICAgICAgIHZhciBwcmV2ZW50RGVmYXVsdCA9IFs0OCw0OSw1MCw1MSw1Miw1Myw1NCw1Niw1NywzMiw3NSwzOCw0MCw3NywzOSwzNyw3MCw2N107XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gSWYgdGhlIGNvZGUgaXMgZm91bmQgcHJldmVudCBkZWZhdWx0IChlLmcuIHByZXZlbnQgc2Nyb2xsaW5nIGZvciBhcnJvd3MpXG4gICAgICAgICAgICAgICAgICAgIGlmIChfaW5BcnJheShwcmV2ZW50RGVmYXVsdCwgY29kZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIHN3aXRjaChjb2RlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyAwLTlcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNDg6XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDQ5OlxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA1MDpcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNTE6XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDUyOlxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA1MzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNTQ6XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDU1OlxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA1NjpcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNTc6IGlmICghaGVsZCkgeyBzZWVrQnlLZXkoKTsgfSBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFNwYWNlIGFuZCBLIGtleVxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAzMjpcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNzU6IGlmICghaGVsZCkgeyBfdG9nZ2xlUGxheSgpOyB9IGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gQXJyb3cgdXBcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMzg6IF9pbmNyZWFzZVZvbHVtZSgpOyBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEFycm93IGRvd25cbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNDA6IF9kZWNyZWFzZVZvbHVtZSgpOyBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIE0ga2V5XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDc3OiBpZiAoIWhlbGQpIHsgX3RvZ2dsZU11dGUoKSB9IGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gQXJyb3cgZm9yd2FyZFxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAzOTogX2ZvcndhcmQoKTsgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBBcnJvdyBiYWNrXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDM3OiBfcmV3aW5kKCk7IGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gRiBrZXlcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNzA6IF90b2dnbGVGdWxsc2NyZWVuKCk7IGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gQyBrZXlcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNjc6IGlmICghaGVsZCkgeyBfdG9nZ2xlQ2FwdGlvbnMoKTsgfSBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIC8vIEVzY2FwZSBpcyBoYW5kbGUgbmF0aXZlbHkgd2hlbiBpbiBmdWxsIHNjcmVlblxuICAgICAgICAgICAgICAgICAgICAvLyBTbyB3ZSBvbmx5IG5lZWQgdG8gd29ycnkgYWJvdXQgbm9uIG5hdGl2ZVxuICAgICAgICAgICAgICAgICAgICBpZiAoIWZ1bGxzY3JlZW4uc3VwcG9ydHNGdWxsU2NyZWVuICYmIHBseXIuaXNGdWxsc2NyZWVuICYmIGNvZGUgPT09IDI3KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBfdG9nZ2xlRnVsbHNjcmVlbigpO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gU3RvcmUgbGFzdCBjb2RlIGZvciBuZXh0IGN5Y2xlXG4gICAgICAgICAgICAgICAgICAgIGxhc3QgPSBjb2RlO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGxhc3QgPSBudWxsO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gRm9jdXMvdGFiIG1hbmFnZW1lbnRcbiAgICAgICAgICAgIF9vbih3aW5kb3csICdrZXl1cCcsIGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICAgICAgICAgICAgdmFyIGNvZGUgPSBnZXRLZXlDb2RlKGV2ZW50KSxcbiAgICAgICAgICAgICAgICAgICAgZm9jdXNlZCA9IGdldEZvY3VzRWxlbWVudCgpO1xuXG4gICAgICAgICAgICAgICAgaWYgKGNvZGUgPT09IDkpIHtcbiAgICAgICAgICAgICAgICAgICAgY2hlY2tUYWJGb2N1cyhmb2N1c2VkKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIF9vbihkb2N1bWVudC5ib2R5LCAnY2xpY2snLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICBfdG9nZ2xlQ2xhc3MoX2dldEVsZW1lbnQoJy4nICsgY29uZmlnLmNsYXNzZXMudGFiRm9jdXMpLCBjb25maWcuY2xhc3Nlcy50YWJGb2N1cywgZmFsc2UpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBmb3IgKHZhciBidXR0b24gaW4gcGx5ci5idXR0b25zKSB7XG4gICAgICAgICAgICAgICAgdmFyIGVsZW1lbnQgPSBwbHlyLmJ1dHRvbnNbYnV0dG9uXTtcblxuICAgICAgICAgICAgICAgIF9vbihlbGVtZW50LCAnYmx1cicsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICBfdG9nZ2xlQ2xhc3MoZWxlbWVudCwgJ3RhYi1mb2N1cycsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gUGxheVxuICAgICAgICAgICAgX3Byb3h5TGlzdGVuZXIocGx5ci5idXR0b25zLnBsYXksICdjbGljaycsIGNvbmZpZy5saXN0ZW5lcnMucGxheSwgdG9nZ2xlUGxheSk7XG5cbiAgICAgICAgICAgIC8vIFBhdXNlXG4gICAgICAgICAgICBfcHJveHlMaXN0ZW5lcihwbHlyLmJ1dHRvbnMucGF1c2UsICdjbGljaycsIGNvbmZpZy5saXN0ZW5lcnMucGF1c2UsIHRvZ2dsZVBsYXkpO1xuXG4gICAgICAgICAgICAvLyBSZXN0YXJ0XG4gICAgICAgICAgICBfcHJveHlMaXN0ZW5lcihwbHlyLmJ1dHRvbnMucmVzdGFydCwgJ2NsaWNrJywgY29uZmlnLmxpc3RlbmVycy5yZXN0YXJ0LCBfc2Vlayk7XG5cbiAgICAgICAgICAgIC8vIFJld2luZFxuICAgICAgICAgICAgX3Byb3h5TGlzdGVuZXIocGx5ci5idXR0b25zLnJld2luZCwgJ2NsaWNrJywgY29uZmlnLmxpc3RlbmVycy5yZXdpbmQsIF9yZXdpbmQpO1xuXG4gICAgICAgICAgICAvLyBGYXN0IGZvcndhcmRcbiAgICAgICAgICAgIF9wcm94eUxpc3RlbmVyKHBseXIuYnV0dG9ucy5mb3J3YXJkLCAnY2xpY2snLCBjb25maWcubGlzdGVuZXJzLmZvcndhcmQsIF9mb3J3YXJkKTtcblxuICAgICAgICAgICAgLy8gU2Vla1xuICAgICAgICAgICAgX3Byb3h5TGlzdGVuZXIocGx5ci5idXR0b25zLnNlZWssIGlucHV0RXZlbnQsIGNvbmZpZy5saXN0ZW5lcnMuc2VlaywgX3NlZWspO1xuXG4gICAgICAgICAgICAvLyBTZXQgdm9sdW1lXG4gICAgICAgICAgICBfcHJveHlMaXN0ZW5lcihwbHlyLnZvbHVtZS5pbnB1dCwgaW5wdXRFdmVudCwgY29uZmlnLmxpc3RlbmVycy52b2x1bWUsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIF9zZXRWb2x1bWUocGx5ci52b2x1bWUuaW5wdXQudmFsdWUpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIC8vIE11dGVcbiAgICAgICAgICAgIF9wcm94eUxpc3RlbmVyKHBseXIuYnV0dG9ucy5tdXRlLCAnY2xpY2snLCBjb25maWcubGlzdGVuZXJzLm11dGUsIF90b2dnbGVNdXRlKTtcblxuICAgICAgICAgICAgLy8gRnVsbHNjcmVlblxuICAgICAgICAgICAgX3Byb3h5TGlzdGVuZXIocGx5ci5idXR0b25zLmZ1bGxzY3JlZW4sICdjbGljaycsIGNvbmZpZy5saXN0ZW5lcnMuZnVsbHNjcmVlbiwgX3RvZ2dsZUZ1bGxzY3JlZW4pO1xuXG4gICAgICAgICAgICAvLyBIYW5kbGUgdXNlciBleGl0aW5nIGZ1bGxzY3JlZW4gYnkgZXNjYXBpbmcgZXRjXG4gICAgICAgICAgICBpZiAoZnVsbHNjcmVlbi5zdXBwb3J0c0Z1bGxTY3JlZW4pIHtcbiAgICAgICAgICAgICAgICBfb24oZG9jdW1lbnQsIGZ1bGxzY3JlZW4uZnVsbFNjcmVlbkV2ZW50TmFtZSwgX3RvZ2dsZUZ1bGxzY3JlZW4pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBDYXB0aW9uc1xuICAgICAgICAgICAgX29uKHBseXIuYnV0dG9ucy5jYXB0aW9ucywgJ2NsaWNrJywgX3RvZ2dsZUNhcHRpb25zKTtcblxuICAgICAgICAgICAgLy8gU2VlayB0b29sdGlwXG4gICAgICAgICAgICBfb24ocGx5ci5wcm9ncmVzcy5jb250YWluZXIsICdtb3VzZWVudGVyIG1vdXNlbGVhdmUgbW91c2Vtb3ZlJywgX3VwZGF0ZVNlZWtUb29sdGlwKTtcblxuICAgICAgICAgICAgLy8gVG9nZ2xlIGNvbnRyb2xzIHZpc2liaWxpdHkgYmFzZWQgb24gbW91c2UgbW92ZW1lbnRcbiAgICAgICAgICAgIGlmIChjb25maWcuaGlkZUNvbnRyb2xzKSB7XG4gICAgICAgICAgICAgICAgLy8gVG9nZ2xlIGNvbnRyb2xzIG9uIG1vdXNlIGV2ZW50cyBhbmQgZW50ZXJpbmcgZnVsbHNjcmVlblxuICAgICAgICAgICAgICAgIF9vbihwbHlyLmNvbnRhaW5lciwgJ21vdXNlZW50ZXIgbW91c2VsZWF2ZSBtb3VzZW1vdmUgdG91Y2hzdGFydCB0b3VjaGVuZCB0b3VjaGNhbmNlbCB0b3VjaG1vdmUgZW50ZXJmdWxsc2NyZWVuJywgX3RvZ2dsZUNvbnRyb2xzKTtcblxuICAgICAgICAgICAgICAgIC8vIFdhdGNoIGZvciBjdXJzb3Igb3ZlciBjb250cm9scyBzbyB0aGV5IGRvbid0IGhpZGUgd2hlbiB0cnlpbmcgdG8gaW50ZXJhY3RcbiAgICAgICAgICAgICAgICBfb24ocGx5ci5jb250cm9scywgJ21vdXNlZW50ZXIgbW91c2VsZWF2ZScsIGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICAgICAgICAgICAgICAgIHBseXIuY29udHJvbHMuaG92ZXIgPSBldmVudC50eXBlID09PSAnbW91c2VlbnRlcic7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgLy8gV2F0Y2ggZm9yIGN1cnNvciBvdmVyIGNvbnRyb2xzIHNvIHRoZXkgZG9uJ3QgaGlkZSB3aGVuIHRyeWluZyB0byBpbnRlcmFjdFxuICAgICAgICAgICAgICAgIF9vbihwbHlyLmNvbnRyb2xzLCAnbW91c2Vkb3duIG1vdXNldXAgdG91Y2hzdGFydCB0b3VjaGVuZCB0b3VjaGNhbmNlbCcsIGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICAgICAgICAgICAgICAgIHBseXIuY29udHJvbHMucHJlc3NlZCA9IF9pbkFycmF5KFsnbW91c2Vkb3duJywgJ3RvdWNoc3RhcnQnXSwgZXZlbnQudHlwZSk7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAvLyBGb2N1cyBpbi9vdXQgb24gY29udHJvbHNcbiAgICAgICAgICAgICAgICBfb24ocGx5ci5jb250cm9scywgJ2ZvY3VzIGJsdXInLCBfdG9nZ2xlQ29udHJvbHMsIHRydWUpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBBZGp1c3Qgdm9sdW1lIG9uIHNjcm9sbFxuICAgICAgICAgICAgX29uKHBseXIudm9sdW1lLmlucHV0LCAnd2hlZWwnLCBmdW5jdGlvbihldmVudCkge1xuICAgICAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICAgICAgICAgICAgICAvLyBEZXRlY3QgXCJuYXR1cmFsXCIgc2Nyb2xsIC0gc3VwcG9yZWQgb24gT1MgWCBTYWZhcmkgb25seVxuICAgICAgICAgICAgICAgIC8vIE90aGVyIGJyb3dzZXJzIG9uIE9TIFggd2lsbCBiZSBpbnZlcnRlZCB1bnRpbCBzdXBwb3J0IGltcHJvdmVzXG4gICAgICAgICAgICAgICAgdmFyIGludmVydGVkID0gZXZlbnQud2Via2l0RGlyZWN0aW9uSW52ZXJ0ZWRGcm9tRGV2aWNlLFxuICAgICAgICAgICAgICAgICAgICBzdGVwID0gKGNvbmZpZy52b2x1bWVTdGVwIC8gNSk7XG5cbiAgICAgICAgICAgICAgICAvLyBTY3JvbGwgZG93biAob3IgdXAgb24gbmF0dXJhbCkgdG8gZGVjcmVhc2VcbiAgICAgICAgICAgICAgICBpZiAoZXZlbnQuZGVsdGFZIDwgMCB8fCBldmVudC5kZWx0YVggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChpbnZlcnRlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgX2RlY3JlYXNlVm9sdW1lKHN0ZXApO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgX2luY3JlYXNlVm9sdW1lKHN0ZXApO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gU2Nyb2xsIHVwIChvciBkb3duIG9uIG5hdHVyYWwpIHRvIGluY3JlYXNlXG4gICAgICAgICAgICAgICAgaWYgKGV2ZW50LmRlbHRhWSA+IDAgfHwgZXZlbnQuZGVsdGFYIDwgMCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoaW52ZXJ0ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9pbmNyZWFzZVZvbHVtZShzdGVwKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9kZWNyZWFzZVZvbHVtZShzdGVwKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gTGlzdGVuIGZvciBtZWRpYSBldmVudHNcbiAgICAgICAgZnVuY3Rpb24gX21lZGlhTGlzdGVuZXJzKCkge1xuICAgICAgICAgICAgLy8gVGltZSBjaGFuZ2Ugb24gbWVkaWFcbiAgICAgICAgICAgIF9vbihwbHlyLm1lZGlhLCAndGltZXVwZGF0ZSBzZWVraW5nJywgX3RpbWVVcGRhdGUpO1xuXG4gICAgICAgICAgICAvLyBVcGRhdGUgbWFudWFsIGNhcHRpb25zXG4gICAgICAgICAgICBfb24ocGx5ci5tZWRpYSwgJ3RpbWV1cGRhdGUnLCBfc2Vla01hbnVhbENhcHRpb25zKTtcblxuICAgICAgICAgICAgLy8gRGlzcGxheSBkdXJhdGlvblxuICAgICAgICAgICAgX29uKHBseXIubWVkaWEsICdkdXJhdGlvbmNoYW5nZSBsb2FkZWRtZXRhZGF0YScsIF9kaXNwbGF5RHVyYXRpb24pO1xuXG4gICAgICAgICAgICAvLyBIYW5kbGUgdGhlIG1lZGlhIGZpbmlzaGluZ1xuICAgICAgICAgICAgX29uKHBseXIubWVkaWEsICdlbmRlZCcsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIC8vIFNob3cgcG9zdGVyIG9uIGVuZFxuICAgICAgICAgICAgICAgIGlmIChwbHlyLnR5cGUgPT09ICd2aWRlbycgJiYgY29uZmlnLnNob3dQb3N0ZXJPbkVuZCkge1xuICAgICAgICAgICAgICAgICAgICAvLyBDbGVhclxuICAgICAgICAgICAgICAgICAgICBpZiAocGx5ci50eXBlID09PSAndmlkZW8nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBfc2V0Q2FwdGlvbigpO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gUmVzdGFydFxuICAgICAgICAgICAgICAgICAgICBfc2VlaygpO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIFJlLWxvYWQgbWVkaWFcbiAgICAgICAgICAgICAgICAgICAgcGx5ci5tZWRpYS5sb2FkKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIC8vIENoZWNrIGZvciBidWZmZXIgcHJvZ3Jlc3NcbiAgICAgICAgICAgIF9vbihwbHlyLm1lZGlhLCAncHJvZ3Jlc3MgcGxheWluZycsIF91cGRhdGVQcm9ncmVzcyk7XG5cbiAgICAgICAgICAgIC8vIEhhbmRsZSBuYXRpdmUgbXV0ZVxuICAgICAgICAgICAgX29uKHBseXIubWVkaWEsICd2b2x1bWVjaGFuZ2UnLCBfdXBkYXRlVm9sdW1lKTtcblxuICAgICAgICAgICAgLy8gSGFuZGxlIG5hdGl2ZSBwbGF5L3BhdXNlXG4gICAgICAgICAgICBfb24ocGx5ci5tZWRpYSwgJ3BsYXkgcGF1c2UgZW5kZWQnLCBfY2hlY2tQbGF5aW5nKTtcblxuICAgICAgICAgICAgLy8gTG9hZGluZ1xuICAgICAgICAgICAgX29uKHBseXIubWVkaWEsICd3YWl0aW5nIGNhbnBsYXkgc2Vla2VkJywgX2NoZWNrTG9hZGluZyk7XG5cbiAgICAgICAgICAgIC8vIENsaWNrIHZpZGVvXG4gICAgICAgICAgICBpZiAoY29uZmlnLmNsaWNrVG9QbGF5ICYmIHBseXIudHlwZSAhPT0gJ2F1ZGlvJykge1xuICAgICAgICAgICAgICAgIC8vIFJlLWZldGNoIHRoZSB3cmFwcGVyXG4gICAgICAgICAgICAgICAgdmFyIHdyYXBwZXIgPSBfZ2V0RWxlbWVudCgnLicgKyBjb25maWcuY2xhc3Nlcy52aWRlb1dyYXBwZXIpO1xuXG4gICAgICAgICAgICAgICAgLy8gQmFpbCBpZiB0aGVyZSdzIG5vIHdyYXBwZXIgKHRoaXMgc2hvdWxkIG5ldmVyIGhhcHBlbilcbiAgICAgICAgICAgICAgICBpZiAoIXdyYXBwZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIFNldCBjdXJzb3JcbiAgICAgICAgICAgICAgICB3cmFwcGVyLnN0eWxlLmN1cnNvciA9IFwicG9pbnRlclwiO1xuXG4gICAgICAgICAgICAgICAgLy8gT24gY2xpY2sgcGxheSwgcGF1c2Ugb3JlIHJlc3RhcnRcbiAgICAgICAgICAgICAgICBfb24od3JhcHBlciwgJ2NsaWNrJywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFRvdWNoIGRldmljZXMgd2lsbCBqdXN0IHNob3cgY29udHJvbHMgKGlmIHdlJ3JlIGhpZGluZyBjb250cm9scylcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNvbmZpZy5oaWRlQ29udHJvbHMgJiYgcGx5ci5icm93c2VyLmlzVG91Y2ggJiYgIXBseXIubWVkaWEucGF1c2VkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBpZiAocGx5ci5tZWRpYS5wYXVzZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9wbGF5KCk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocGx5ci5tZWRpYS5lbmRlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgX3NlZWsoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9wbGF5KCk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBfcGF1c2UoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBEaXNhYmxlIHJpZ2h0IGNsaWNrXG4gICAgICAgICAgICBpZiAoY29uZmlnLmRpc2FibGVDb250ZXh0TWVudSkge1xuICAgICAgICAgICAgICAgIF9vbihwbHlyLm1lZGlhLCAnY29udGV4dG1lbnUnLCBmdW5jdGlvbihldmVudCkgeyBldmVudC5wcmV2ZW50RGVmYXVsdCgpOyB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gUHJveHkgZXZlbnRzIHRvIGNvbnRhaW5lclxuICAgICAgICAgICAgLy8gQnViYmxlIHVwIGtleSBldmVudHMgZm9yIEVkZ2VcbiAgICAgICAgICAgIF9vbihwbHlyLm1lZGlhLCBjb25maWcuZXZlbnRzLmNvbmNhdChbJ2tleXVwJywgJ2tleWRvd24nXSkuam9pbignICcpLCBmdW5jdGlvbihldmVudCkge1xuICAgICAgICAgICAgICAgIF90cmlnZ2VyRXZlbnQocGx5ci5jb250YWluZXIsIGV2ZW50LnR5cGUsIHRydWUpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBDYW5jZWwgY3VycmVudCBuZXR3b3JrIHJlcXVlc3RzXG4gICAgICAgIC8vIFNlZSBodHRwczovL2dpdGh1Yi5jb20vU2Vsei9wbHlyL2lzc3Vlcy8xNzRcbiAgICAgICAgZnVuY3Rpb24gX2NhbmNlbFJlcXVlc3RzKCkge1xuICAgICAgICAgICAgaWYgKCFfaW5BcnJheShjb25maWcudHlwZXMuaHRtbDUsIHBseXIudHlwZSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIFJlbW92ZSBjaGlsZCBzb3VyY2VzXG4gICAgICAgICAgICB2YXIgc291cmNlcyA9IHBseXIubWVkaWEucXVlcnlTZWxlY3RvckFsbCgnc291cmNlJyk7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNvdXJjZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBfcmVtb3ZlKHNvdXJjZXNbaV0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBTZXQgYmxhbmsgdmlkZW8gc3JjIGF0dHJpYnV0ZVxuICAgICAgICAgICAgLy8gVGhpcyBpcyB0byBwcmV2ZW50IGEgTUVESUFfRVJSX1NSQ19OT1RfU1VQUE9SVEVEIGVycm9yXG4gICAgICAgICAgICAvLyBJbmZvOiBodHRwOi8vc3RhY2tvdmVyZmxvdy5jb20vcXVlc3Rpb25zLzMyMjMxNTc5L2hvdy10by1wcm9wZXJseS1kaXNwb3NlLW9mLWFuLWh0bWw1LXZpZGVvLWFuZC1jbG9zZS1zb2NrZXQtb3ItY29ubmVjdGlvblxuICAgICAgICAgICAgcGx5ci5tZWRpYS5zZXRBdHRyaWJ1dGUoJ3NyYycsICdodHRwczovL2Nkbi5zZWx6LmNvbS9wbHlyL2JsYW5rLm1wNCcpO1xuXG4gICAgICAgICAgICAvLyBMb2FkIHRoZSBuZXcgZW1wdHkgc291cmNlXG4gICAgICAgICAgICAvLyBUaGlzIHdpbGwgY2FuY2VsIGV4aXN0aW5nIHJlcXVlc3RzXG4gICAgICAgICAgICAvLyBTZWUgaHR0cHM6Ly9naXRodWIuY29tL1NlbHovcGx5ci9pc3N1ZXMvMTc0XG4gICAgICAgICAgICBwbHlyLm1lZGlhLmxvYWQoKTtcblxuICAgICAgICAgICAgLy8gRGVidWdnaW5nXG4gICAgICAgICAgICBfbG9nKCdDYW5jZWxsZWQgbmV0d29yayByZXF1ZXN0cycpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gRGVzdHJveSBhbiBpbnN0YW5jZVxuICAgICAgICAvLyBFdmVudCBsaXN0ZW5lcnMgYXJlIHJlbW92ZWQgd2hlbiBlbGVtZW50cyBhcmUgcmVtb3ZlZFxuICAgICAgICAvLyBodHRwOi8vc3RhY2tvdmVyZmxvdy5jb20vcXVlc3Rpb25zLzEyNTI4MDQ5L2lmLWEtZG9tLWVsZW1lbnQtaXMtcmVtb3ZlZC1hcmUtaXRzLWxpc3RlbmVycy1hbHNvLXJlbW92ZWQtZnJvbS1tZW1vcnlcbiAgICAgICAgZnVuY3Rpb24gX2Rlc3Ryb3koY2FsbGJhY2ssIHJlc3RvcmUpIHtcbiAgICAgICAgICAgIC8vIEJhaWwgaWYgdGhlIGVsZW1lbnQgaXMgbm90IGluaXRpYWxpemVkXG4gICAgICAgICAgICBpZiAoIXBseXIuaW5pdCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBUeXBlIHNwZWNpZmljIHN0dWZmXG4gICAgICAgICAgICBzd2l0Y2ggKHBseXIudHlwZSkge1xuICAgICAgICAgICAgICAgIGNhc2UgJ3lvdXR1YmUnOlxuICAgICAgICAgICAgICAgICAgICAvLyBDbGVhciB0aW1lcnNcbiAgICAgICAgICAgICAgICAgICAgd2luZG93LmNsZWFySW50ZXJ2YWwodGltZXJzLmJ1ZmZlcmluZyk7XG4gICAgICAgICAgICAgICAgICAgIHdpbmRvdy5jbGVhckludGVydmFsKHRpbWVycy5wbGF5aW5nKTtcblxuICAgICAgICAgICAgICAgICAgICAvLyBEZXN0cm95IFlvdVR1YmUgQVBJXG4gICAgICAgICAgICAgICAgICAgIHBseXIuZW1iZWQuZGVzdHJveSgpO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIENsZWFuIHVwXG4gICAgICAgICAgICAgICAgICAgIGNsZWFuVXAoKTtcblxuICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgIGNhc2UgJ3ZpbWVvJzpcbiAgICAgICAgICAgICAgICAgICAgLy8gRGVzdHJveSBWaW1lbyBBUElcbiAgICAgICAgICAgICAgICAgICAgLy8gdGhlbiBjbGVhbiB1cCAod2FpdCwgdG8gcHJldmVudCBwb3N0bWVzc2FnZSBlcnJvcnMpXG4gICAgICAgICAgICAgICAgICAgIHBseXIuZW1iZWQudW5sb2FkKCkudGhlbihjbGVhblVwKTtcblxuICAgICAgICAgICAgICAgICAgICAvLyBWaW1lbyBkb2VzIG5vdCBhbHdheXMgcmV0dXJuXG4gICAgICAgICAgICAgICAgICAgIHRpbWVycy5jbGVhblVwID0gd2luZG93LnNldFRpbWVvdXQoY2xlYW5VcCwgMjAwKTtcblxuICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgIGNhc2UgJ3ZpZGVvJzpcbiAgICAgICAgICAgICAgICBjYXNlICdhdWRpbyc6XG4gICAgICAgICAgICAgICAgICAgIC8vIFJlc3RvcmUgbmF0aXZlIHZpZGVvIGNvbnRyb2xzXG4gICAgICAgICAgICAgICAgICAgIF90b2dnbGVOYXRpdmVDb250cm9scyh0cnVlKTtcblxuICAgICAgICAgICAgICAgICAgICAvLyBDbGVhbiB1cFxuICAgICAgICAgICAgICAgICAgICBjbGVhblVwKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGNsZWFuVXAoKSB7XG4gICAgICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRpbWVycy5jbGVhblVwKTtcblxuICAgICAgICAgICAgICAgIC8vIERlZmF1bHQgdG8gcmVzdG9yZSBvcmlnaW5hbCBlbGVtZW50XG4gICAgICAgICAgICAgICAgaWYgKCFfaXMuYm9vbGVhbihyZXN0b3JlKSkge1xuICAgICAgICAgICAgICAgICAgICByZXN0b3JlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBDYWxsYmFja1xuICAgICAgICAgICAgICAgIGlmIChfaXMuZnVuY3Rpb24oY2FsbGJhY2spKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrLmNhbGwob3JpZ2luYWwpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIEJhaWwgaWYgd2UgZG9uJ3QgbmVlZCB0byByZXN0b3JlIHRoZSBvcmlnaW5hbCBlbGVtZW50XG4gICAgICAgICAgICAgICAgaWYgKCFyZXN0b3JlKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBSZW1vdmUgaW5pdCBmbGFnXG4gICAgICAgICAgICAgICAgcGx5ci5pbml0ID0gZmFsc2U7XG5cbiAgICAgICAgICAgICAgICAvLyBSZXBsYWNlIHRoZSBjb250YWluZXIgd2l0aCB0aGUgb3JpZ2luYWwgZWxlbWVudCBwcm92aWRlZFxuICAgICAgICAgICAgICAgIHBseXIuY29udGFpbmVyLnBhcmVudE5vZGUucmVwbGFjZUNoaWxkKG9yaWdpbmFsLCBwbHlyLmNvbnRhaW5lcik7XG5cbiAgICAgICAgICAgICAgICAvLyBBbGxvdyBvdmVyZmxvdyAoc2V0IG9uIGZ1bGxzY3JlZW4pXG4gICAgICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5zdHlsZS5vdmVyZmxvdyA9ICcnO1xuXG4gICAgICAgICAgICAgICAgLy8gRXZlbnRcbiAgICAgICAgICAgICAgICBfdHJpZ2dlckV2ZW50KG9yaWdpbmFsLCAnZGVzdHJveWVkJywgdHJ1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyBTZXR1cCBhIHBsYXllclxuICAgICAgICBmdW5jdGlvbiBfaW5pdCgpIHtcbiAgICAgICAgICAgIC8vIEJhaWwgaWYgdGhlIGVsZW1lbnQgaXMgaW5pdGlhbGl6ZWRcbiAgICAgICAgICAgIGlmIChwbHlyLmluaXQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gU2V0dXAgdGhlIGZ1bGxzY3JlZW4gYXBpXG4gICAgICAgICAgICBmdWxsc2NyZWVuID0gX2Z1bGxzY3JlZW4oKTtcblxuICAgICAgICAgICAgLy8gU25pZmYgb3V0IHRoZSBicm93c2VyXG4gICAgICAgICAgICBwbHlyLmJyb3dzZXIgPSBfYnJvd3NlclNuaWZmKCk7XG5cbiAgICAgICAgICAgIC8vIEJhaWwgaWYgbm90aGluZyB0byBzZXR1cFxuICAgICAgICAgICAgaWYgKCFfaXMuaHRtbEVsZW1lbnQocGx5ci5tZWRpYSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIExvYWQgc2F2ZWQgc2V0dGluZ3MgZnJvbSBsb2NhbFN0b3JhZ2VcbiAgICAgICAgICAgIF9zZXR1cFN0b3JhZ2UoKTtcblxuICAgICAgICAgICAgLy8gU2V0IG1lZGlhIHR5cGUgYmFzZWQgb24gdGFnIG9yIGRhdGEgYXR0cmlidXRlXG4gICAgICAgICAgICAvLyBTdXBwb3J0ZWQ6IHZpZGVvLCBhdWRpbywgdmltZW8sIHlvdXR1YmVcbiAgICAgICAgICAgIHZhciB0YWdOYW1lID0gbWVkaWEudGFnTmFtZS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICAgICAgaWYgKHRhZ05hbWUgPT09ICdkaXYnKSB7XG4gICAgICAgICAgICAgICAgcGx5ci50eXBlICAgICA9IG1lZGlhLmdldEF0dHJpYnV0ZSgnZGF0YS10eXBlJyk7XG4gICAgICAgICAgICAgICAgcGx5ci5lbWJlZElkICA9IG1lZGlhLmdldEF0dHJpYnV0ZSgnZGF0YS12aWRlby1pZCcpO1xuXG4gICAgICAgICAgICAgICAgLy8gQ2xlYW4gdXBcbiAgICAgICAgICAgICAgICBtZWRpYS5yZW1vdmVBdHRyaWJ1dGUoJ2RhdGEtdHlwZScpO1xuICAgICAgICAgICAgICAgIG1lZGlhLnJlbW92ZUF0dHJpYnV0ZSgnZGF0YS12aWRlby1pZCcpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBwbHlyLnR5cGUgICAgICAgICAgID0gdGFnTmFtZTtcbiAgICAgICAgICAgICAgICBjb25maWcuY3Jvc3NvcmlnaW4gID0gKG1lZGlhLmdldEF0dHJpYnV0ZSgnY3Jvc3NvcmlnaW4nKSAhPT0gbnVsbCk7XG4gICAgICAgICAgICAgICAgY29uZmlnLmF1dG9wbGF5ICAgICA9IChjb25maWcuYXV0b3BsYXkgfHwgKG1lZGlhLmdldEF0dHJpYnV0ZSgnYXV0b3BsYXknKSAhPT0gbnVsbCkpO1xuICAgICAgICAgICAgICAgIGNvbmZpZy5sb29wICAgICAgICAgPSAoY29uZmlnLmxvb3AgfHwgKG1lZGlhLmdldEF0dHJpYnV0ZSgnbG9vcCcpICE9PSBudWxsKSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIENoZWNrIGZvciBzdXBwb3J0XG4gICAgICAgICAgICBwbHlyLnN1cHBvcnRlZCA9IHN1cHBvcnRlZChwbHlyLnR5cGUpO1xuXG4gICAgICAgICAgICAvLyBJZiBubyBuYXRpdmUgc3VwcG9ydCwgYmFpbFxuICAgICAgICAgICAgaWYgKCFwbHlyLnN1cHBvcnRlZC5iYXNpYykge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gV3JhcCBtZWRpYVxuICAgICAgICAgICAgcGx5ci5jb250YWluZXIgPSBfd3JhcChtZWRpYSwgZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JykpO1xuXG4gICAgICAgICAgICAvLyBBbGxvdyBmb2N1cyB0byBiZSBjYXB0dXJlZFxuICAgICAgICAgICAgcGx5ci5jb250YWluZXIuc2V0QXR0cmlidXRlKCd0YWJpbmRleCcsIDApO1xuXG4gICAgICAgICAgICAvLyBBZGQgc3R5bGUgaG9va1xuICAgICAgICAgICAgX3RvZ2dsZVN0eWxlSG9vaygpO1xuXG4gICAgICAgICAgICAvLyBEZWJ1ZyBpbmZvXG4gICAgICAgICAgICBfbG9nKCcnICsgcGx5ci5icm93c2VyLm5hbWUgKyAnICcgKyBwbHlyLmJyb3dzZXIudmVyc2lvbik7XG5cbiAgICAgICAgICAgIC8vIFNldHVwIG1lZGlhXG4gICAgICAgICAgICBfc2V0dXBNZWRpYSgpO1xuXG4gICAgICAgICAgICAvLyBTZXR1cCBpbnRlcmZhY2VcbiAgICAgICAgICAgIC8vIElmIGVtYmVkIGJ1dCBub3QgZnVsbHkgc3VwcG9ydGVkLCBzZXR1cEludGVyZmFjZSAodG8gYXZvaWQgZmxhc2ggb2YgY29udHJvbHMpIGFuZCBjYWxsIHJlYWR5IG5vd1xuICAgICAgICAgICAgaWYgKF9pbkFycmF5KGNvbmZpZy50eXBlcy5odG1sNSwgcGx5ci50eXBlKSB8fCAoX2luQXJyYXkoY29uZmlnLnR5cGVzLmVtYmVkLCBwbHlyLnR5cGUpICYmICFwbHlyLnN1cHBvcnRlZC5mdWxsKSkge1xuICAgICAgICAgICAgICAgIC8vIFNldHVwIFVJXG4gICAgICAgICAgICAgICAgX3NldHVwSW50ZXJmYWNlKCk7XG5cbiAgICAgICAgICAgICAgICAvLyBDYWxsIHJlYWR5XG4gICAgICAgICAgICAgICAgX3JlYWR5KCk7XG5cbiAgICAgICAgICAgICAgICAvLyBTZXQgdGl0bGUgb24gYnV0dG9uIGFuZCBmcmFtZVxuICAgICAgICAgICAgICAgIF9zZXRUaXRsZSgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBTdWNjZXNzZnVsIHNldHVwXG4gICAgICAgICAgICBwbHlyLmluaXQgPSB0cnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gU2V0dXAgdGhlIFVJXG4gICAgICAgIGZ1bmN0aW9uIF9zZXR1cEludGVyZmFjZSgpIHtcbiAgICAgICAgICAgIC8vIERvbid0IHNldHVwIGludGVyZmFjZSBpZiBubyBzdXBwb3J0XG4gICAgICAgICAgICBpZiAoIXBseXIuc3VwcG9ydGVkLmZ1bGwpIHtcbiAgICAgICAgICAgICAgICBfd2FybignQmFzaWMgc3VwcG9ydCBvbmx5JywgcGx5ci50eXBlKTtcblxuICAgICAgICAgICAgICAgIC8vIFJlbW92ZSBjb250cm9sc1xuICAgICAgICAgICAgICAgIF9yZW1vdmUoX2dldEVsZW1lbnQoY29uZmlnLnNlbGVjdG9ycy5jb250cm9scy53cmFwcGVyKSk7XG5cbiAgICAgICAgICAgICAgICAvLyBSZW1vdmUgbGFyZ2UgcGxheVxuICAgICAgICAgICAgICAgIF9yZW1vdmUoX2dldEVsZW1lbnQoY29uZmlnLnNlbGVjdG9ycy5idXR0b25zLnBsYXkpKTtcblxuICAgICAgICAgICAgICAgIC8vIFJlc3RvcmUgbmF0aXZlIGNvbnRyb2xzXG4gICAgICAgICAgICAgICAgX3RvZ2dsZU5hdGl2ZUNvbnRyb2xzKHRydWUpO1xuXG4gICAgICAgICAgICAgICAgLy8gQmFpbFxuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gSW5qZWN0IGN1c3RvbSBjb250cm9scyBpZiBub3QgcHJlc2VudFxuICAgICAgICAgICAgdmFyIGNvbnRyb2xzTWlzc2luZyA9ICFfZ2V0RWxlbWVudHMoY29uZmlnLnNlbGVjdG9ycy5jb250cm9scy53cmFwcGVyKS5sZW5ndGg7XG4gICAgICAgICAgICBpZiAoY29udHJvbHNNaXNzaW5nKSB7XG4gICAgICAgICAgICAgICAgLy8gSW5qZWN0IGN1c3RvbSBjb250cm9sc1xuICAgICAgICAgICAgICAgIF9pbmplY3RDb250cm9scygpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBGaW5kIHRoZSBlbGVtZW50c1xuICAgICAgICAgICAgaWYgKCFfZmluZEVsZW1lbnRzKCkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIElmIHRoZSBjb250cm9scyBhcmUgaW5qZWN0ZWQsIHJlLWJpbmQgbGlzdGVuZXJzIGZvciBjb250cm9sc1xuICAgICAgICAgICAgaWYgKGNvbnRyb2xzTWlzc2luZykge1xuICAgICAgICAgICAgICAgIF9jb250cm9sTGlzdGVuZXJzKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIE1lZGlhIGVsZW1lbnQgbGlzdGVuZXJzXG4gICAgICAgICAgICBfbWVkaWFMaXN0ZW5lcnMoKTtcblxuICAgICAgICAgICAgLy8gUmVtb3ZlIG5hdGl2ZSBjb250cm9sc1xuICAgICAgICAgICAgX3RvZ2dsZU5hdGl2ZUNvbnRyb2xzKCk7XG5cbiAgICAgICAgICAgIC8vIFNldHVwIGZ1bGxzY3JlZW5cbiAgICAgICAgICAgIF9zZXR1cEZ1bGxzY3JlZW4oKTtcblxuICAgICAgICAgICAgLy8gQ2FwdGlvbnNcbiAgICAgICAgICAgIF9zZXR1cENhcHRpb25zKCk7XG5cbiAgICAgICAgICAgIC8vIFNldCB2b2x1bWVcbiAgICAgICAgICAgIF9zZXRWb2x1bWUoKTtcbiAgICAgICAgICAgIF91cGRhdGVWb2x1bWUoKTtcblxuICAgICAgICAgICAgLy8gUmVzZXQgdGltZSBkaXNwbGF5XG4gICAgICAgICAgICBfdGltZVVwZGF0ZSgpO1xuXG4gICAgICAgICAgICAvLyBVcGRhdGUgdGhlIFVJXG4gICAgICAgICAgICBfY2hlY2tQbGF5aW5nKCk7XG4gICAgICAgIH1cblxuICAgICAgICBhcGkgPSB7XG4gICAgICAgICAgICBnZXRPcmlnaW5hbDogICAgICAgIGZ1bmN0aW9uKCkgeyByZXR1cm4gb3JpZ2luYWw7IH0sXG4gICAgICAgICAgICBnZXRDb250YWluZXI6ICAgICAgIGZ1bmN0aW9uKCkgeyByZXR1cm4gcGx5ci5jb250YWluZXIgfSxcbiAgICAgICAgICAgIGdldEVtYmVkOiAgICAgICAgICAgZnVuY3Rpb24oKSB7IHJldHVybiBwbHlyLmVtYmVkOyB9LFxuICAgICAgICAgICAgZ2V0TWVkaWE6ICAgICAgICAgICBmdW5jdGlvbigpIHsgcmV0dXJuIHBseXIubWVkaWE7IH0sXG4gICAgICAgICAgICBnZXRUeXBlOiAgICAgICAgICAgIGZ1bmN0aW9uKCkgeyByZXR1cm4gcGx5ci50eXBlOyB9LFxuICAgICAgICAgICAgZ2V0RHVyYXRpb246ICAgICAgICBfZ2V0RHVyYXRpb24sXG4gICAgICAgICAgICBnZXRDdXJyZW50VGltZTogICAgIGZ1bmN0aW9uKCkgeyByZXR1cm4gcGx5ci5tZWRpYS5jdXJyZW50VGltZTsgfSxcbiAgICAgICAgICAgIGdldFZvbHVtZTogICAgICAgICAgZnVuY3Rpb24oKSB7IHJldHVybiBwbHlyLm1lZGlhLnZvbHVtZTsgfSxcbiAgICAgICAgICAgIGlzTXV0ZWQ6ICAgICAgICAgICAgZnVuY3Rpb24oKSB7IHJldHVybiBwbHlyLm1lZGlhLm11dGVkOyB9LFxuICAgICAgICAgICAgaXNSZWFkeTogICAgICAgICAgICBmdW5jdGlvbigpIHsgcmV0dXJuIF9oYXNDbGFzcyhwbHlyLmNvbnRhaW5lciwgY29uZmlnLmNsYXNzZXMucmVhZHkpOyB9LFxuICAgICAgICAgICAgaXNMb2FkaW5nOiAgICAgICAgICBmdW5jdGlvbigpIHsgcmV0dXJuIF9oYXNDbGFzcyhwbHlyLmNvbnRhaW5lciwgY29uZmlnLmNsYXNzZXMubG9hZGluZyk7IH0sXG4gICAgICAgICAgICBpc1BhdXNlZDogICAgICAgICAgIGZ1bmN0aW9uKCkgeyByZXR1cm4gcGx5ci5tZWRpYS5wYXVzZWQ7IH0sXG4gICAgICAgICAgICBvbjogICAgICAgICAgICAgICAgIGZ1bmN0aW9uKGV2ZW50LCBjYWxsYmFjaykgeyBfb24ocGx5ci5jb250YWluZXIsIGV2ZW50LCBjYWxsYmFjayk7IHJldHVybiB0aGlzOyB9LFxuICAgICAgICAgICAgcGxheTogICAgICAgICAgICAgICBfcGxheSxcbiAgICAgICAgICAgIHBhdXNlOiAgICAgICAgICAgICAgX3BhdXNlLFxuICAgICAgICAgICAgc3RvcDogICAgICAgICAgICAgICBmdW5jdGlvbigpIHsgX3BhdXNlKCk7IF9zZWVrKCk7IH0sXG4gICAgICAgICAgICByZXN0YXJ0OiAgICAgICAgICAgIF9zZWVrLFxuICAgICAgICAgICAgcmV3aW5kOiAgICAgICAgICAgICBfcmV3aW5kLFxuICAgICAgICAgICAgZm9yd2FyZDogICAgICAgICAgICBfZm9yd2FyZCxcbiAgICAgICAgICAgIHNlZWs6ICAgICAgICAgICAgICAgX3NlZWssXG4gICAgICAgICAgICBzb3VyY2U6ICAgICAgICAgICAgIF9zb3VyY2UsXG4gICAgICAgICAgICBwb3N0ZXI6ICAgICAgICAgICAgIF91cGRhdGVQb3N0ZXIsXG4gICAgICAgICAgICBzZXRWb2x1bWU6ICAgICAgICAgIF9zZXRWb2x1bWUsXG4gICAgICAgICAgICB0b2dnbGVQbGF5OiAgICAgICAgIF90b2dnbGVQbGF5LFxuICAgICAgICAgICAgdG9nZ2xlTXV0ZTogICAgICAgICBfdG9nZ2xlTXV0ZSxcbiAgICAgICAgICAgIHRvZ2dsZUNhcHRpb25zOiAgICAgX3RvZ2dsZUNhcHRpb25zLFxuICAgICAgICAgICAgdG9nZ2xlRnVsbHNjcmVlbjogICBfdG9nZ2xlRnVsbHNjcmVlbixcbiAgICAgICAgICAgIHRvZ2dsZUNvbnRyb2xzOiAgICAgX3RvZ2dsZUNvbnRyb2xzLFxuICAgICAgICAgICAgaXNGdWxsc2NyZWVuOiAgICAgICBmdW5jdGlvbigpIHsgcmV0dXJuIHBseXIuaXNGdWxsc2NyZWVuIHx8IGZhbHNlOyB9LFxuICAgICAgICAgICAgc3VwcG9ydDogICAgICAgICAgICBmdW5jdGlvbihtaW1lVHlwZSkgeyByZXR1cm4gX3N1cHBvcnRNaW1lKHBseXIsIG1pbWVUeXBlKTsgfSxcbiAgICAgICAgICAgIGRlc3Ryb3k6ICAgICAgICAgICAgX2Rlc3Ryb3lcbiAgICAgICAgfTtcblxuICAgICAgICAvLyBFdmVyeXRoaW5nIGRvbmVcbiAgICAgICAgZnVuY3Rpb24gX3JlYWR5KCkge1xuICAgICAgICAgICAgLy8gUmVhZHkgZXZlbnQgYXQgZW5kIG9mIGV4ZWN1dGlvbiBzdGFja1xuICAgICAgICAgICAgd2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgX3RyaWdnZXJFdmVudChwbHlyLm1lZGlhLCAncmVhZHknKTtcbiAgICAgICAgICAgIH0sIDApO1xuXG4gICAgICAgICAgICAvLyBTZXQgY2xhc3MgaG9vayBvbiBtZWRpYSBlbGVtZW50XG4gICAgICAgICAgICBfdG9nZ2xlQ2xhc3MocGx5ci5tZWRpYSwgZGVmYXVsdHMuY2xhc3Nlcy5zZXR1cCwgdHJ1ZSk7XG5cbiAgICAgICAgICAgIC8vIFNldCBjb250YWluZXIgY2xhc3MgZm9yIHJlYWR5XG4gICAgICAgICAgICBfdG9nZ2xlQ2xhc3MocGx5ci5jb250YWluZXIsIGNvbmZpZy5jbGFzc2VzLnJlYWR5LCB0cnVlKTtcblxuICAgICAgICAgICAgLy8gU3RvcmUgYSByZWZlcm5jZSB0byBpbnN0YW5jZVxuICAgICAgICAgICAgcGx5ci5tZWRpYS5wbHlyID0gYXBpO1xuXG4gICAgICAgICAgICAvLyBBdXRvcGxheVxuICAgICAgICAgICAgaWYgKGNvbmZpZy5hdXRvcGxheSkge1xuICAgICAgICAgICAgICAgIF9wbGF5KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyBJbml0aWFsaXplIGluc3RhbmNlXG4gICAgICAgIF9pbml0KCk7XG5cbiAgICAgICAgLy8gSWYgaW5pdCBmYWlsZWQsIHJldHVybiBudWxsXG4gICAgICAgIGlmICghcGx5ci5pbml0KSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBhcGk7XG4gICAgfVxuXG4gICAgLy8gTG9hZCBhIHNwcml0ZVxuICAgIGZ1bmN0aW9uIGxvYWRTcHJpdGUodXJsLCBpZCkge1xuICAgICAgICB2YXIgeCA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xuXG4gICAgICAgIC8vIElmIHRoZSBpZCBpcyBzZXQgYW5kIHNwcml0ZSBleGlzdHMsIGJhaWxcbiAgICAgICAgaWYgKF9pcy5zdHJpbmcoaWQpICYmIF9pcy5odG1sRWxlbWVudChkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjJyArIGlkKSkpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIENyZWF0ZSBwbGFjZWhvbGRlciAodG8gcHJldmVudCBsb2FkaW5nIHR3aWNlKVxuICAgICAgICB2YXIgY29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgIGNvbnRhaW5lci5zZXRBdHRyaWJ1dGUoJ2hpZGRlbicsICcnKTtcbiAgICAgICAgaWYgKF9pcy5zdHJpbmcoaWQpKSB7XG4gICAgICAgICAgICBjb250YWluZXIuc2V0QXR0cmlidXRlKCdpZCcsIGlkKTtcbiAgICAgICAgfVxuICAgICAgICBkb2N1bWVudC5ib2R5Lmluc2VydEJlZm9yZShjb250YWluZXIsIGRvY3VtZW50LmJvZHkuY2hpbGROb2Rlc1swXSk7XG5cbiAgICAgICAgLy8gQ2hlY2sgZm9yIENPUlMgc3VwcG9ydFxuICAgICAgICBpZiAoJ3dpdGhDcmVkZW50aWFscycgaW4geCkge1xuICAgICAgICAgICAgeC5vcGVuKCdHRVQnLCB1cmwsIHRydWUpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gSW5qZWN0IGhpZGRlbiBkaXYgd2l0aCBzcHJpdGUgb24gbG9hZFxuICAgICAgICB4Lm9ubG9hZCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgY29udGFpbmVyLmlubmVySFRNTCA9IHgucmVzcG9uc2VUZXh0O1xuICAgICAgICB9XG5cbiAgICAgICAgeC5zZW5kKCk7XG4gICAgfVxuXG4gICAgLy8gQ2hlY2sgZm9yIHN1cHBvcnRcbiAgICBmdW5jdGlvbiBzdXBwb3J0ZWQodHlwZSkge1xuICAgICAgICB2YXIgYnJvd3NlciAgICAgPSBfYnJvd3NlclNuaWZmKCksXG4gICAgICAgICAgICBpc09sZElFICAgICA9IChicm93c2VyLmlzSUUgJiYgYnJvd3Nlci52ZXJzaW9uIDw9IDkpLFxuICAgICAgICAgICAgaXNJb3MgICAgICAgPSBicm93c2VyLmlzSW9zLFxuICAgICAgICAgICAgaXNJcGhvbmUgICAgPSBicm93c2VyLmlzSXBob25lLFxuICAgICAgICAgICAgYXVkaW9TdXBwb3J0ID0gISFkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhdWRpbycpLmNhblBsYXlUeXBlLFxuICAgICAgICAgICAgdmlkZW9TdXBwb3J0ID0gISFkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd2aWRlbycpLmNhblBsYXlUeXBlLFxuICAgICAgICAgICAgYmFzaWMgICAgICAgPSBmYWxzZSxcbiAgICAgICAgICAgIGZ1bGwgICAgICAgID0gZmFsc2U7XG5cbiAgICAgICAgc3dpdGNoICh0eXBlKSB7XG4gICAgICAgICAgICBjYXNlICd2aWRlbyc6XG4gICAgICAgICAgICAgICAgYmFzaWMgPSB2aWRlb1N1cHBvcnQ7XG4gICAgICAgICAgICAgICAgZnVsbCAgPSAoYmFzaWMgJiYgKCFpc09sZElFICYmICFpc0lwaG9uZSkpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICBjYXNlICdhdWRpbyc6XG4gICAgICAgICAgICAgICAgYmFzaWMgPSBhdWRpb1N1cHBvcnQ7XG4gICAgICAgICAgICAgICAgZnVsbCAgPSAoYmFzaWMgJiYgIWlzT2xkSUUpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAvLyBWaW1lbyBkb2VzIG5vdCBzZWVtIHRvIGJlIHN1cHBvcnRlZCBvbiBpT1MgdmlhIEFQSVxuICAgICAgICAgICAgLy8gSXNzdWUgcmFpc2VkIGh0dHBzOi8vZ2l0aHViLmNvbS92aW1lby9wbGF5ZXIuanMvaXNzdWVzLzg3XG4gICAgICAgICAgICBjYXNlICd2aW1lbyc6XG4gICAgICAgICAgICAgICAgYmFzaWMgPSB0cnVlO1xuICAgICAgICAgICAgICAgIGZ1bGwgPSAoIWlzT2xkSUUgJiYgIWlzSW9zKTtcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgY2FzZSAneW91dHViZSc6XG4gICAgICAgICAgICAgICAgYmFzaWMgPSB0cnVlO1xuICAgICAgICAgICAgICAgIGZ1bGwgPSAoIWlzT2xkSUUgJiYgIWlzSW9zKTtcblxuICAgICAgICAgICAgICAgIC8vIFlvdVR1YmUgc2VlbXMgdG8gd29yayBvbiBpT1MgMTArIG9uIGlQYWRcbiAgICAgICAgICAgICAgICBpZiAoaXNJb3MgJiYgIWlzSXBob25lICYmIGJyb3dzZXIudmVyc2lvbiA+PSAxMCkge1xuICAgICAgICAgICAgICAgICAgICBmdWxsID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgY2FzZSAnc291bmRjbG91ZCc6XG4gICAgICAgICAgICAgICAgYmFzaWMgPSB0cnVlO1xuICAgICAgICAgICAgICAgIGZ1bGwgID0gKCFpc09sZElFICYmICFpc0lwaG9uZSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgYmFzaWMgPSAoYXVkaW9TdXBwb3J0ICYmIHZpZGVvU3VwcG9ydCk7XG4gICAgICAgICAgICAgICAgZnVsbCAgPSAoYmFzaWMgJiYgIWlzT2xkSUUpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGJhc2ljOiAgYmFzaWMsXG4gICAgICAgICAgICBmdWxsOiAgIGZ1bGxcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICAvLyBTZXR1cCBmdW5jdGlvblxuICAgIGZ1bmN0aW9uIHNldHVwKHRhcmdldHMsIG9wdGlvbnMpIHtcbiAgICAgICAgLy8gR2V0IHRoZSBwbGF5ZXJzXG4gICAgICAgIHZhciBwbGF5ZXJzICAgICA9IFtdLFxuICAgICAgICAgICAgaW5zdGFuY2VzICAgPSBbXSxcbiAgICAgICAgICAgIHNlbGVjdG9yICAgID0gW2RlZmF1bHRzLnNlbGVjdG9ycy5odG1sNSwgZGVmYXVsdHMuc2VsZWN0b3JzLmVtYmVkXS5qb2luKCcsJyk7XG5cbiAgICAgICAgLy8gU2VsZWN0IHRoZSBlbGVtZW50c1xuICAgICAgICBpZiAoX2lzLnN0cmluZyh0YXJnZXRzKSkge1xuICAgICAgICAgICAgLy8gU3RyaW5nIHNlbGVjdG9yIHBhc3NlZFxuICAgICAgICAgICAgdGFyZ2V0cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwodGFyZ2V0cyk7XG4gICAgICAgIH0gIGVsc2UgaWYgKF9pcy5odG1sRWxlbWVudCh0YXJnZXRzKSkge1xuICAgICAgICAgICAgLy8gU2luZ2xlIEhUTUxFbGVtZW50IHBhc3NlZFxuICAgICAgICAgICAgdGFyZ2V0cyA9IFt0YXJnZXRzXTtcbiAgICAgICAgfSAgZWxzZSBpZiAoIV9pcy5ub2RlTGlzdCh0YXJnZXRzKSAmJiAhX2lzLmFycmF5KHRhcmdldHMpICYmICFfaXMuc3RyaW5nKHRhcmdldHMpKSAge1xuICAgICAgICAgICAgLy8gTm8gc2VsZWN0b3IgcGFzc2VkLCBwb3NzaWJseSBvcHRpb25zIGFzIGZpcnN0IGFyZ3VtZW50XG4gICAgICAgICAgICAvLyBJZiBvcHRpb25zIGFyZSB0aGUgZmlyc3QgYXJndW1lbnRcbiAgICAgICAgICAgIGlmIChfaXMudW5kZWZpbmVkKG9wdGlvbnMpICYmIF9pcy5vYmplY3QodGFyZ2V0cykpIHtcbiAgICAgICAgICAgICAgICBvcHRpb25zID0gdGFyZ2V0cztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gVXNlIGRlZmF1bHQgc2VsZWN0b3JcbiAgICAgICAgICAgIHRhcmdldHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKHNlbGVjdG9yKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIENvbnZlcnQgTm9kZUxpc3QgdG8gYXJyYXlcbiAgICAgICAgaWYgKF9pcy5ub2RlTGlzdCh0YXJnZXRzKSkge1xuICAgICAgICAgICAgdGFyZ2V0cyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKHRhcmdldHMpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQmFpbCBpZiBkaXNhYmxlZCBvciBubyBiYXNpYyBzdXBwb3J0XG4gICAgICAgIC8vIFlvdSBtYXkgd2FudCB0byBkaXNhYmxlIGNlcnRhaW4gVUFzIGV0Y1xuICAgICAgICBpZiAoIXN1cHBvcnRlZCgpLmJhc2ljIHx8ICF0YXJnZXRzLmxlbmd0aCkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQWRkIHRvIGNvbnRhaW5lciBsaXN0XG4gICAgICAgIGZ1bmN0aW9uIGFkZCh0YXJnZXQsIG1lZGlhKSB7XG4gICAgICAgICAgICBpZiAoIV9oYXNDbGFzcyhtZWRpYSwgZGVmYXVsdHMuY2xhc3Nlcy5ob29rKSkge1xuICAgICAgICAgICAgICAgIHBsYXllcnMucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgIC8vIEFsd2F5cyB3cmFwIGluIGEgPGRpdj4gZm9yIHN0eWxpbmdcbiAgICAgICAgICAgICAgICAgICAgLy9jb250YWluZXI6ICBfd3JhcChtZWRpYSwgZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JykpLFxuICAgICAgICAgICAgICAgICAgICAvLyBDb3VsZCBiZSBhIGNvbnRhaW5lciBvciB0aGUgbWVkaWEgaXRzZWxmXG4gICAgICAgICAgICAgICAgICAgIHRhcmdldDogICAgIHRhcmdldCxcbiAgICAgICAgICAgICAgICAgICAgLy8gVGhpcyBzaG91bGQgYmUgdGhlIDx2aWRlbz4sIDxhdWRpbz4gb3IgPGRpdj4gKFlvdVR1YmUvVmltZW8pXG4gICAgICAgICAgICAgICAgICAgIG1lZGlhOiAgICAgIG1lZGlhXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyBDaGVjayBpZiB0aGUgdGFyZ2V0cyBoYXZlIG11bHRpcGxlIG1lZGlhIGVsZW1lbnRzXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGFyZ2V0cy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIHRhcmdldCA9IHRhcmdldHNbaV07XG5cbiAgICAgICAgICAgIC8vIEdldCBjaGlsZHJlblxuICAgICAgICAgICAgdmFyIGNoaWxkcmVuID0gdGFyZ2V0LnF1ZXJ5U2VsZWN0b3JBbGwoc2VsZWN0b3IpO1xuXG4gICAgICAgICAgICAvLyBJZiB0aGVyZSdzIG1vcmUgdGhhbiBvbmUgbWVkaWEgZWxlbWVudCBjaGlsZCwgd3JhcCB0aGVtXG4gICAgICAgICAgICBpZiAoY2hpbGRyZW4ubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgeCA9IDA7IHggPCBjaGlsZHJlbi5sZW5ndGg7IHgrKykge1xuICAgICAgICAgICAgICAgICAgICBhZGQodGFyZ2V0LCBjaGlsZHJlblt4XSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIGlmIChfbWF0Y2hlcyh0YXJnZXQsIHNlbGVjdG9yKSkge1xuICAgICAgICAgICAgICAgIC8vIFRhcmdldCBpcyBtZWRpYSBlbGVtZW50XG4gICAgICAgICAgICAgICAgYWRkKHRhcmdldCwgdGFyZ2V0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIENyZWF0ZSBhIHBsYXllciBpbnN0YW5jZSBmb3IgZWFjaCBlbGVtZW50XG4gICAgICAgIHBsYXllcnMuZm9yRWFjaChmdW5jdGlvbihwbGF5ZXIpIHtcbiAgICAgICAgICAgIHZhciBlbGVtZW50ICAgICA9IHBsYXllci50YXJnZXQsXG4gICAgICAgICAgICAgICAgbWVkaWEgICAgICAgPSBwbGF5ZXIubWVkaWEsXG4gICAgICAgICAgICAgICAgbWF0Y2ggICAgICAgPSBmYWxzZTtcblxuICAgICAgICAgICAgLy8gVGhlIHRhcmdldCBlbGVtZW50IGNhbiBhbHNvIGJlIHRoZSBtZWRpYSBlbGVtZW50XG4gICAgICAgICAgICBpZiAobWVkaWEgPT09IGVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICBtYXRjaCA9IHRydWU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIFNldHVwIGEgcGxheWVyIGluc3RhbmNlIGFuZCBhZGQgdG8gdGhlIGVsZW1lbnRcbiAgICAgICAgICAgIC8vIENyZWF0ZSBpbnN0YW5jZS1zcGVjaWZpYyBjb25maWdcbiAgICAgICAgICAgIHZhciBkYXRhID0ge307XG5cbiAgICAgICAgICAgIC8vIFRyeSBwYXJzaW5nIGRhdGEgYXR0cmlidXRlIGNvbmZpZ1xuICAgICAgICAgICAgdHJ5IHsgZGF0YSA9IEpTT04ucGFyc2UoZWxlbWVudC5nZXRBdHRyaWJ1dGUoJ2RhdGEtcGx5cicpKTsgfVxuICAgICAgICAgICAgY2F0Y2goZSkgeyB9XG5cbiAgICAgICAgICAgIHZhciBjb25maWcgPSBfZXh0ZW5kKHt9LCBkZWZhdWx0cywgb3B0aW9ucywgZGF0YSk7XG5cbiAgICAgICAgICAgIC8vIEJhaWwgaWYgbm90IGVuYWJsZWRcbiAgICAgICAgICAgIGlmICghY29uZmlnLmVuYWJsZWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gQ3JlYXRlIG5ldyBpbnN0YW5jZVxuICAgICAgICAgICAgdmFyIGluc3RhbmNlID0gbmV3IFBseXIobWVkaWEsIGNvbmZpZyk7XG5cbiAgICAgICAgICAgIC8vIEdvIHRvIG5leHQgaWYgc2V0dXAgZmFpbGVkXG4gICAgICAgICAgICBpZiAoIV9pcy5vYmplY3QoaW5zdGFuY2UpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBMaXN0ZW4gZm9yIGV2ZW50cyBpZiBkZWJ1Z2dpbmdcbiAgICAgICAgICAgIGlmIChjb25maWcuZGVidWcpIHtcbiAgICAgICAgICAgICAgICB2YXIgZXZlbnRzID0gY29uZmlnLmV2ZW50cy5jb25jYXQoWydzZXR1cCcsICdzdGF0ZWNoYW5nZScsICdlbnRlcmZ1bGxzY3JlZW4nLCAnZXhpdGZ1bGxzY3JlZW4nLCAnY2FwdGlvbnNlbmFibGVkJywgJ2NhcHRpb25zZGlzYWJsZWQnXSk7XG5cbiAgICAgICAgICAgICAgICBfb24oaW5zdGFuY2UuZ2V0Q29udGFpbmVyKCksIGV2ZW50cy5qb2luKCcgJyksIGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFtjb25maWcubG9nUHJlZml4LCAnZXZlbnQ6JywgZXZlbnQudHlwZV0uam9pbignICcpLCBldmVudC5kZXRhaWwucGx5cik7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIENhbGxiYWNrXG4gICAgICAgICAgICBfZXZlbnQoaW5zdGFuY2UuZ2V0Q29udGFpbmVyKCksICdzZXR1cCcsIHRydWUsIHtcbiAgICAgICAgICAgICAgICBwbHlyOiBpbnN0YW5jZVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIC8vIEFkZCB0byByZXR1cm4gYXJyYXkgZXZlbiBpZiBpdCdzIGFscmVhZHkgc2V0dXBcbiAgICAgICAgICAgIGluc3RhbmNlcy5wdXNoKGluc3RhbmNlKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuIGluc3RhbmNlcztcbiAgICB9XG5cbiAgICAvLyBHZXQgYWxsIGluc3RhbmNlcyB3aXRoaW4gYSBwcm92aWRlZCBjb250YWluZXJcbiAgICBmdW5jdGlvbiBnZXQoY29udGFpbmVyKSB7XG4gICAgICAgIGlmIChfaXMuc3RyaW5nKGNvbnRhaW5lcikpIHtcbiAgICAgICAgICAgIC8vIEdldCBzZWxlY3RvciBpZiBzdHJpbmcgcGFzc2VkXG4gICAgICAgICAgICBjb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNvbnRhaW5lcik7XG4gICAgICAgIH0gZWxzZSBpZiAoX2lzLnVuZGVmaW5lZChjb250YWluZXIpKSB7XG4gICAgICAgICAgICAvLyBVc2UgYm9keSBieSBkZWZhdWx0IHRvIGdldCBhbGwgb24gcGFnZVxuICAgICAgICAgICAgY29udGFpbmVyID0gZG9jdW1lbnQuYm9keTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIElmIHdlIGhhdmUgYSBIVE1MIGVsZW1lbnRcbiAgICAgICAgaWYgKF9pcy5odG1sRWxlbWVudChjb250YWluZXIpKSB7XG4gICAgICAgICAgICB2YXIgZWxlbWVudHMgPSBjb250YWluZXIucXVlcnlTZWxlY3RvckFsbCgnLicgKyBkZWZhdWx0cy5jbGFzc2VzLnNldHVwKSxcbiAgICAgICAgICAgICAgICBpbnN0YW5jZXMgPSBbXTtcblxuICAgICAgICAgICAgQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoZWxlbWVudHMpLmZvckVhY2goZnVuY3Rpb24oZWxlbWVudCkge1xuICAgICAgICAgICAgICAgIGlmIChfaXMub2JqZWN0KGVsZW1lbnQucGx5cikpIHtcbiAgICAgICAgICAgICAgICAgICAgaW5zdGFuY2VzLnB1c2goZWxlbWVudC5wbHlyKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgcmV0dXJuIGluc3RhbmNlcztcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBbXTtcbiAgICB9XG5cbiAgICByZXR1cm4ge1xuICAgICAgICBzZXR1cDogICAgICBzZXR1cCxcbiAgICAgICAgc3VwcG9ydGVkOiAgc3VwcG9ydGVkLFxuICAgICAgICBsb2FkU3ByaXRlOiBsb2FkU3ByaXRlLFxuICAgICAgICBnZXQ6ICAgICAgICBnZXRcbiAgICB9O1xufSkpO1xuXG4vLyBDdXN0b20gZXZlbnQgcG9seWZpbGxcbi8vIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0FQSS9DdXN0b21FdmVudC9DdXN0b21FdmVudFxuKGZ1bmN0aW9uICgpIHtcbiAgICBpZiAodHlwZW9mIHdpbmRvdy5DdXN0b21FdmVudCA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gQ3VzdG9tRXZlbnQoZXZlbnQsIHBhcmFtcykge1xuICAgICAgICBwYXJhbXMgPSBwYXJhbXMgfHwgeyBidWJibGVzOiBmYWxzZSwgY2FuY2VsYWJsZTogZmFsc2UsIGRldGFpbDogdW5kZWZpbmVkIH07XG4gICAgICAgIHZhciBldnQgPSBkb2N1bWVudC5jcmVhdGVFdmVudCgnQ3VzdG9tRXZlbnQnKTtcbiAgICAgICAgZXZ0LmluaXRDdXN0b21FdmVudChldmVudCwgcGFyYW1zLmJ1YmJsZXMsIHBhcmFtcy5jYW5jZWxhYmxlLCBwYXJhbXMuZGV0YWlsKTtcbiAgICAgICAgcmV0dXJuIGV2dDtcbiAgICB9XG5cbiAgICBDdXN0b21FdmVudC5wcm90b3R5cGUgPSB3aW5kb3cuRXZlbnQucHJvdG90eXBlO1xuXG4gICAgd2luZG93LkN1c3RvbUV2ZW50ID0gQ3VzdG9tRXZlbnQ7XG59KSgpO1xuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9+L3BseXIvc3JjL2pzL3BseXIuanNcbi8vIG1vZHVsZSBpZCA9IDRcbi8vIG1vZHVsZSBjaHVua3MgPSAwIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==");

/***/ }),
/* 5 */
/***/ (function(module, exports, __webpack_require__) {

eval("var __WEBPACK_AMD_DEFINE_RESULT__;/* Web Font Loader v1.6.27 - (c) Adobe Systems, Google. License: Apache 2.0 */(function(){function aa(a,b,c){return a.call.apply(a.bind,arguments)}function ba(a,b,c){if(!a)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,d);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}}function p(a,b,c){p=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf(\"native code\")?aa:ba;return p.apply(null,arguments)}var q=Date.now||function(){return+new Date};function ca(a,b){this.a=a;this.m=b||a;this.c=this.m.document}var da=!!window.FontFace;function t(a,b,c,d){b=a.c.createElement(b);if(c)for(var e in c)c.hasOwnProperty(e)&&(\"style\"==e?b.style.cssText=c[e]:b.setAttribute(e,c[e]));d&&b.appendChild(a.c.createTextNode(d));return b}function u(a,b,c){a=a.c.getElementsByTagName(b)[0];a||(a=document.documentElement);a.insertBefore(c,a.lastChild)}function v(a){a.parentNode&&a.parentNode.removeChild(a)}\nfunction w(a,b,c){b=b||[];c=c||[];for(var d=a.className.split(/\\s+/),e=0;e<b.length;e+=1){for(var f=!1,g=0;g<d.length;g+=1)if(b[e]===d[g]){f=!0;break}f||d.push(b[e])}b=[];for(e=0;e<d.length;e+=1){f=!1;for(g=0;g<c.length;g+=1)if(d[e]===c[g]){f=!0;break}f||b.push(d[e])}a.className=b.join(\" \").replace(/\\s+/g,\" \").replace(/^\\s+|\\s+$/,\"\")}function y(a,b){for(var c=a.className.split(/\\s+/),d=0,e=c.length;d<e;d++)if(c[d]==b)return!0;return!1}\nfunction z(a){if(\"string\"===typeof a.f)return a.f;var b=a.m.location.protocol;\"about:\"==b&&(b=a.a.location.protocol);return\"https:\"==b?\"https:\":\"http:\"}function ea(a){return a.m.location.hostname||a.a.location.hostname}\nfunction A(a,b,c){function d(){k&&e&&f&&(k(g),k=null)}b=t(a,\"link\",{rel:\"stylesheet\",href:b,media:\"all\"});var e=!1,f=!0,g=null,k=c||null;da?(b.onload=function(){e=!0;d()},b.onerror=function(){e=!0;g=Error(\"Stylesheet failed to load\");d()}):setTimeout(function(){e=!0;d()},0);u(a,\"head\",b)}\nfunction B(a,b,c,d){var e=a.c.getElementsByTagName(\"head\")[0];if(e){var f=t(a,\"script\",{src:b}),g=!1;f.onload=f.onreadystatechange=function(){g||this.readyState&&\"loaded\"!=this.readyState&&\"complete\"!=this.readyState||(g=!0,c&&c(null),f.onload=f.onreadystatechange=null,\"HEAD\"==f.parentNode.tagName&&e.removeChild(f))};e.appendChild(f);setTimeout(function(){g||(g=!0,c&&c(Error(\"Script load timeout\")))},d||5E3);return f}return null};function C(){this.a=0;this.c=null}function D(a){a.a++;return function(){a.a--;E(a)}}function F(a,b){a.c=b;E(a)}function E(a){0==a.a&&a.c&&(a.c(),a.c=null)};function G(a){this.a=a||\"-\"}G.prototype.c=function(a){for(var b=[],c=0;c<arguments.length;c++)b.push(arguments[c].replace(/[\\W_]+/g,\"\").toLowerCase());return b.join(this.a)};function H(a,b){this.c=a;this.f=4;this.a=\"n\";var c=(b||\"n4\").match(/^([nio])([1-9])$/i);c&&(this.a=c[1],this.f=parseInt(c[2],10))}function fa(a){return I(a)+\" \"+(a.f+\"00\")+\" 300px \"+J(a.c)}function J(a){var b=[];a=a.split(/,\\s*/);for(var c=0;c<a.length;c++){var d=a[c].replace(/['\"]/g,\"\");-1!=d.indexOf(\" \")||/^\\d/.test(d)?b.push(\"'\"+d+\"'\"):b.push(d)}return b.join(\",\")}function K(a){return a.a+a.f}function I(a){var b=\"normal\";\"o\"===a.a?b=\"oblique\":\"i\"===a.a&&(b=\"italic\");return b}\nfunction ga(a){var b=4,c=\"n\",d=null;a&&((d=a.match(/(normal|oblique|italic)/i))&&d[1]&&(c=d[1].substr(0,1).toLowerCase()),(d=a.match(/([1-9]00|normal|bold)/i))&&d[1]&&(/bold/i.test(d[1])?b=7:/[1-9]00/.test(d[1])&&(b=parseInt(d[1].substr(0,1),10))));return c+b};function ha(a,b){this.c=a;this.f=a.m.document.documentElement;this.h=b;this.a=new G(\"-\");this.j=!1!==b.events;this.g=!1!==b.classes}function ia(a){a.g&&w(a.f,[a.a.c(\"wf\",\"loading\")]);L(a,\"loading\")}function M(a){if(a.g){var b=y(a.f,a.a.c(\"wf\",\"active\")),c=[],d=[a.a.c(\"wf\",\"loading\")];b||c.push(a.a.c(\"wf\",\"inactive\"));w(a.f,c,d)}L(a,\"inactive\")}function L(a,b,c){if(a.j&&a.h[b])if(c)a.h[b](c.c,K(c));else a.h[b]()};function ja(){this.c={}}function ka(a,b,c){var d=[],e;for(e in b)if(b.hasOwnProperty(e)){var f=a.c[e];f&&d.push(f(b[e],c))}return d};function N(a,b){this.c=a;this.f=b;this.a=t(this.c,\"span\",{\"aria-hidden\":\"true\"},this.f)}function O(a){u(a.c,\"body\",a.a)}function P(a){return\"display:block;position:absolute;top:-9999px;left:-9999px;font-size:300px;width:auto;height:auto;line-height:normal;margin:0;padding:0;font-variant:normal;white-space:nowrap;font-family:\"+J(a.c)+\";\"+(\"font-style:\"+I(a)+\";font-weight:\"+(a.f+\"00\")+\";\")};function Q(a,b,c,d,e,f){this.g=a;this.j=b;this.a=d;this.c=c;this.f=e||3E3;this.h=f||void 0}Q.prototype.start=function(){var a=this.c.m.document,b=this,c=q(),d=new Promise(function(d,e){function k(){q()-c>=b.f?e():a.fonts.load(fa(b.a),b.h).then(function(a){1<=a.length?d():setTimeout(k,25)},function(){e()})}k()}),e=new Promise(function(a,d){setTimeout(d,b.f)});Promise.race([e,d]).then(function(){b.g(b.a)},function(){b.j(b.a)})};function R(a,b,c,d,e,f,g){this.v=a;this.B=b;this.c=c;this.a=d;this.s=g||\"BESbswy\";this.f={};this.w=e||3E3;this.u=f||null;this.o=this.j=this.h=this.g=null;this.g=new N(this.c,this.s);this.h=new N(this.c,this.s);this.j=new N(this.c,this.s);this.o=new N(this.c,this.s);a=new H(this.a.c+\",serif\",K(this.a));a=P(a);this.g.a.style.cssText=a;a=new H(this.a.c+\",sans-serif\",K(this.a));a=P(a);this.h.a.style.cssText=a;a=new H(\"serif\",K(this.a));a=P(a);this.j.a.style.cssText=a;a=new H(\"sans-serif\",K(this.a));a=\nP(a);this.o.a.style.cssText=a;O(this.g);O(this.h);O(this.j);O(this.o)}var S={D:\"serif\",C:\"sans-serif\"},T=null;function U(){if(null===T){var a=/AppleWebKit\\/([0-9]+)(?:\\.([0-9]+))/.exec(window.navigator.userAgent);T=!!a&&(536>parseInt(a[1],10)||536===parseInt(a[1],10)&&11>=parseInt(a[2],10))}return T}R.prototype.start=function(){this.f.serif=this.j.a.offsetWidth;this.f[\"sans-serif\"]=this.o.a.offsetWidth;this.A=q();la(this)};\nfunction ma(a,b,c){for(var d in S)if(S.hasOwnProperty(d)&&b===a.f[S[d]]&&c===a.f[S[d]])return!0;return!1}function la(a){var b=a.g.a.offsetWidth,c=a.h.a.offsetWidth,d;(d=b===a.f.serif&&c===a.f[\"sans-serif\"])||(d=U()&&ma(a,b,c));d?q()-a.A>=a.w?U()&&ma(a,b,c)&&(null===a.u||a.u.hasOwnProperty(a.a.c))?V(a,a.v):V(a,a.B):na(a):V(a,a.v)}function na(a){setTimeout(p(function(){la(this)},a),50)}function V(a,b){setTimeout(p(function(){v(this.g.a);v(this.h.a);v(this.j.a);v(this.o.a);b(this.a)},a),0)};function W(a,b,c){this.c=a;this.a=b;this.f=0;this.o=this.j=!1;this.s=c}var X=null;W.prototype.g=function(a){var b=this.a;b.g&&w(b.f,[b.a.c(\"wf\",a.c,K(a).toString(),\"active\")],[b.a.c(\"wf\",a.c,K(a).toString(),\"loading\"),b.a.c(\"wf\",a.c,K(a).toString(),\"inactive\")]);L(b,\"fontactive\",a);this.o=!0;oa(this)};\nW.prototype.h=function(a){var b=this.a;if(b.g){var c=y(b.f,b.a.c(\"wf\",a.c,K(a).toString(),\"active\")),d=[],e=[b.a.c(\"wf\",a.c,K(a).toString(),\"loading\")];c||d.push(b.a.c(\"wf\",a.c,K(a).toString(),\"inactive\"));w(b.f,d,e)}L(b,\"fontinactive\",a);oa(this)};function oa(a){0==--a.f&&a.j&&(a.o?(a=a.a,a.g&&w(a.f,[a.a.c(\"wf\",\"active\")],[a.a.c(\"wf\",\"loading\"),a.a.c(\"wf\",\"inactive\")]),L(a,\"active\")):M(a.a))};function pa(a){this.j=a;this.a=new ja;this.h=0;this.f=this.g=!0}pa.prototype.load=function(a){this.c=new ca(this.j,a.context||this.j);this.g=!1!==a.events;this.f=!1!==a.classes;qa(this,new ha(this.c,a),a)};\nfunction ra(a,b,c,d,e){var f=0==--a.h;(a.f||a.g)&&setTimeout(function(){var a=e||null,k=d||null||{};if(0===c.length&&f)M(b.a);else{b.f+=c.length;f&&(b.j=f);var h,m=[];for(h=0;h<c.length;h++){var l=c[h],n=k[l.c],r=b.a,x=l;r.g&&w(r.f,[r.a.c(\"wf\",x.c,K(x).toString(),\"loading\")]);L(r,\"fontloading\",x);r=null;if(null===X)if(window.FontFace){var x=/Gecko.*Firefox\\/(\\d+)/.exec(window.navigator.userAgent),ya=/OS X.*Version\\/10\\..*Safari/.exec(window.navigator.userAgent)&&/Apple/.exec(window.navigator.vendor);\nX=x?42<parseInt(x[1],10):ya?!1:!0}else X=!1;X?r=new Q(p(b.g,b),p(b.h,b),b.c,l,b.s,n):r=new R(p(b.g,b),p(b.h,b),b.c,l,b.s,a,n);m.push(r)}for(h=0;h<m.length;h++)m[h].start()}},0)}function qa(a,b,c){var d=[],e=c.timeout;ia(b);var d=ka(a.a,c,a.c),f=new W(a.c,b,e);a.h=d.length;b=0;for(c=d.length;b<c;b++)d[b].load(function(b,d,c){ra(a,f,b,d,c)})};function sa(a,b){this.c=a;this.a=b}function ta(a,b,c){var d=z(a.c);a=(a.a.api||\"fast.fonts.net/jsapi\").replace(/^.*http(s?):(\\/\\/)?/,\"\");return d+\"//\"+a+\"/\"+b+\".js\"+(c?\"?v=\"+c:\"\")}\nsa.prototype.load=function(a){function b(){if(f[\"__mti_fntLst\"+d]){var c=f[\"__mti_fntLst\"+d](),e=[],h;if(c)for(var m=0;m<c.length;m++){var l=c[m].fontfamily;void 0!=c[m].fontStyle&&void 0!=c[m].fontWeight?(h=c[m].fontStyle+c[m].fontWeight,e.push(new H(l,h))):e.push(new H(l))}a(e)}else setTimeout(function(){b()},50)}var c=this,d=c.a.projectId,e=c.a.version;if(d){var f=c.c.m;B(this.c,ta(c,d,e),function(e){e?a([]):(f[\"__MonotypeConfiguration__\"+d]=function(){return c.a},b())}).id=\"__MonotypeAPIScript__\"+\nd}else a([])};function ua(a,b){this.c=a;this.a=b}ua.prototype.load=function(a){var b,c,d=this.a.urls||[],e=this.a.families||[],f=this.a.testStrings||{},g=new C;b=0;for(c=d.length;b<c;b++)A(this.c,d[b],D(g));var k=[];b=0;for(c=e.length;b<c;b++)if(d=e[b].split(\":\"),d[1])for(var h=d[1].split(\",\"),m=0;m<h.length;m+=1)k.push(new H(d[0],h[m]));else k.push(new H(d[0]));F(g,function(){a(k,f)})};function va(a,b,c){a?this.c=a:this.c=b+wa;this.a=[];this.f=[];this.g=c||\"\"}var wa=\"//fonts.googleapis.com/css\";function xa(a,b){for(var c=b.length,d=0;d<c;d++){var e=b[d].split(\":\");3==e.length&&a.f.push(e.pop());var f=\"\";2==e.length&&\"\"!=e[1]&&(f=\":\");a.a.push(e.join(f))}}\nfunction za(a){if(0==a.a.length)throw Error(\"No fonts to load!\");if(-1!=a.c.indexOf(\"kit=\"))return a.c;for(var b=a.a.length,c=[],d=0;d<b;d++)c.push(a.a[d].replace(/ /g,\"+\"));b=a.c+\"?family=\"+c.join(\"%7C\");0<a.f.length&&(b+=\"&subset=\"+a.f.join(\",\"));0<a.g.length&&(b+=\"&text=\"+encodeURIComponent(a.g));return b};function Aa(a){this.f=a;this.a=[];this.c={}}\nvar Ba={latin:\"BESbswy\",\"latin-ext\":\"\\u00e7\\u00f6\\u00fc\\u011f\\u015f\",cyrillic:\"\\u0439\\u044f\\u0416\",greek:\"\\u03b1\\u03b2\\u03a3\",khmer:\"\\u1780\\u1781\\u1782\",Hanuman:\"\\u1780\\u1781\\u1782\"},Ca={thin:\"1\",extralight:\"2\",\"extra-light\":\"2\",ultralight:\"2\",\"ultra-light\":\"2\",light:\"3\",regular:\"4\",book:\"4\",medium:\"5\",\"semi-bold\":\"6\",semibold:\"6\",\"demi-bold\":\"6\",demibold:\"6\",bold:\"7\",\"extra-bold\":\"8\",extrabold:\"8\",\"ultra-bold\":\"8\",ultrabold:\"8\",black:\"9\",heavy:\"9\",l:\"3\",r:\"4\",b:\"7\"},Da={i:\"i\",italic:\"i\",n:\"n\",normal:\"n\"},\nEa=/^(thin|(?:(?:extra|ultra)-?)?light|regular|book|medium|(?:(?:semi|demi|extra|ultra)-?)?bold|black|heavy|l|r|b|[1-9]00)?(n|i|normal|italic)?$/;\nfunction Fa(a){for(var b=a.f.length,c=0;c<b;c++){var d=a.f[c].split(\":\"),e=d[0].replace(/\\+/g,\" \"),f=[\"n4\"];if(2<=d.length){var g;var k=d[1];g=[];if(k)for(var k=k.split(\",\"),h=k.length,m=0;m<h;m++){var l;l=k[m];if(l.match(/^[\\w-]+$/)){var n=Ea.exec(l.toLowerCase());if(null==n)l=\"\";else{l=n[2];l=null==l||\"\"==l?\"n\":Da[l];n=n[1];if(null==n||\"\"==n)n=\"4\";else var r=Ca[n],n=r?r:isNaN(n)?\"4\":n.substr(0,1);l=[l,n].join(\"\")}}else l=\"\";l&&g.push(l)}0<g.length&&(f=g);3==d.length&&(d=d[2],g=[],d=d?d.split(\",\"):\ng,0<d.length&&(d=Ba[d[0]])&&(a.c[e]=d))}a.c[e]||(d=Ba[e])&&(a.c[e]=d);for(d=0;d<f.length;d+=1)a.a.push(new H(e,f[d]))}};function Ga(a,b){this.c=a;this.a=b}var Ha={Arimo:!0,Cousine:!0,Tinos:!0};Ga.prototype.load=function(a){var b=new C,c=this.c,d=new va(this.a.api,z(c),this.a.text),e=this.a.families;xa(d,e);var f=new Aa(e);Fa(f);A(c,za(d),D(b));F(b,function(){a(f.a,f.c,Ha)})};function Ia(a,b){this.c=a;this.a=b}Ia.prototype.load=function(a){var b=this.a.id,c=this.c.m;b?B(this.c,(this.a.api||\"https://use.typekit.net\")+\"/\"+b+\".js\",function(b){if(b)a([]);else if(c.Typekit&&c.Typekit.config&&c.Typekit.config.fn){b=c.Typekit.config.fn;for(var e=[],f=0;f<b.length;f+=2)for(var g=b[f],k=b[f+1],h=0;h<k.length;h++)e.push(new H(g,k[h]));try{c.Typekit.load({events:!1,classes:!1,async:!0})}catch(m){}a(e)}},2E3):a([])};function Ja(a,b){this.c=a;this.f=b;this.a=[]}Ja.prototype.load=function(a){var b=this.f.id,c=this.c.m,d=this;b?(c.__webfontfontdeckmodule__||(c.__webfontfontdeckmodule__={}),c.__webfontfontdeckmodule__[b]=function(b,c){for(var g=0,k=c.fonts.length;g<k;++g){var h=c.fonts[g];d.a.push(new H(h.name,ga(\"font-weight:\"+h.weight+\";font-style:\"+h.style)))}a(d.a)},B(this.c,z(this.c)+(this.f.api||\"//f.fontdeck.com/s/css/js/\")+ea(this.c)+\"/\"+b+\".js\",function(b){b&&a([])})):a([])};var Y=new pa(window);Y.a.c.custom=function(a,b){return new ua(b,a)};Y.a.c.fontdeck=function(a,b){return new Ja(b,a)};Y.a.c.monotype=function(a,b){return new sa(b,a)};Y.a.c.typekit=function(a,b){return new Ia(b,a)};Y.a.c.google=function(a,b){return new Ga(b,a)};var Z={load:p(Y.load,Y)}; true?!(__WEBPACK_AMD_DEFINE_RESULT__ = function(){return Z}.call(exports, __webpack_require__, exports, module),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__)):\"undefined\"!==typeof module&&module.exports?module.exports=Z:(window.WebFont=Z,window.WebFontConfig&&Y.load(window.WebFontConfig));}());\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNS5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL34vd2ViZm9udGxvYWRlci93ZWJmb250bG9hZGVyLmpzPzA0MWYiXSwic291cmNlc0NvbnRlbnQiOlsiLyogV2ViIEZvbnQgTG9hZGVyIHYxLjYuMjcgLSAoYykgQWRvYmUgU3lzdGVtcywgR29vZ2xlLiBMaWNlbnNlOiBBcGFjaGUgMi4wICovKGZ1bmN0aW9uKCl7ZnVuY3Rpb24gYWEoYSxiLGMpe3JldHVybiBhLmNhbGwuYXBwbHkoYS5iaW5kLGFyZ3VtZW50cyl9ZnVuY3Rpb24gYmEoYSxiLGMpe2lmKCFhKXRocm93IEVycm9yKCk7aWYoMjxhcmd1bWVudHMubGVuZ3RoKXt2YXIgZD1BcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMik7cmV0dXJuIGZ1bmN0aW9uKCl7dmFyIGM9QXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzKTtBcnJheS5wcm90b3R5cGUudW5zaGlmdC5hcHBseShjLGQpO3JldHVybiBhLmFwcGx5KGIsYyl9fXJldHVybiBmdW5jdGlvbigpe3JldHVybiBhLmFwcGx5KGIsYXJndW1lbnRzKX19ZnVuY3Rpb24gcChhLGIsYyl7cD1GdW5jdGlvbi5wcm90b3R5cGUuYmluZCYmLTEhPUZ1bmN0aW9uLnByb3RvdHlwZS5iaW5kLnRvU3RyaW5nKCkuaW5kZXhPZihcIm5hdGl2ZSBjb2RlXCIpP2FhOmJhO3JldHVybiBwLmFwcGx5KG51bGwsYXJndW1lbnRzKX12YXIgcT1EYXRlLm5vd3x8ZnVuY3Rpb24oKXtyZXR1cm4rbmV3IERhdGV9O2Z1bmN0aW9uIGNhKGEsYil7dGhpcy5hPWE7dGhpcy5tPWJ8fGE7dGhpcy5jPXRoaXMubS5kb2N1bWVudH12YXIgZGE9ISF3aW5kb3cuRm9udEZhY2U7ZnVuY3Rpb24gdChhLGIsYyxkKXtiPWEuYy5jcmVhdGVFbGVtZW50KGIpO2lmKGMpZm9yKHZhciBlIGluIGMpYy5oYXNPd25Qcm9wZXJ0eShlKSYmKFwic3R5bGVcIj09ZT9iLnN0eWxlLmNzc1RleHQ9Y1tlXTpiLnNldEF0dHJpYnV0ZShlLGNbZV0pKTtkJiZiLmFwcGVuZENoaWxkKGEuYy5jcmVhdGVUZXh0Tm9kZShkKSk7cmV0dXJuIGJ9ZnVuY3Rpb24gdShhLGIsYyl7YT1hLmMuZ2V0RWxlbWVudHNCeVRhZ05hbWUoYilbMF07YXx8KGE9ZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50KTthLmluc2VydEJlZm9yZShjLGEubGFzdENoaWxkKX1mdW5jdGlvbiB2KGEpe2EucGFyZW50Tm9kZSYmYS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGEpfVxuZnVuY3Rpb24gdyhhLGIsYyl7Yj1ifHxbXTtjPWN8fFtdO2Zvcih2YXIgZD1hLmNsYXNzTmFtZS5zcGxpdCgvXFxzKy8pLGU9MDtlPGIubGVuZ3RoO2UrPTEpe2Zvcih2YXIgZj0hMSxnPTA7ZzxkLmxlbmd0aDtnKz0xKWlmKGJbZV09PT1kW2ddKXtmPSEwO2JyZWFrfWZ8fGQucHVzaChiW2VdKX1iPVtdO2ZvcihlPTA7ZTxkLmxlbmd0aDtlKz0xKXtmPSExO2ZvcihnPTA7ZzxjLmxlbmd0aDtnKz0xKWlmKGRbZV09PT1jW2ddKXtmPSEwO2JyZWFrfWZ8fGIucHVzaChkW2VdKX1hLmNsYXNzTmFtZT1iLmpvaW4oXCIgXCIpLnJlcGxhY2UoL1xccysvZyxcIiBcIikucmVwbGFjZSgvXlxccyt8XFxzKyQvLFwiXCIpfWZ1bmN0aW9uIHkoYSxiKXtmb3IodmFyIGM9YS5jbGFzc05hbWUuc3BsaXQoL1xccysvKSxkPTAsZT1jLmxlbmd0aDtkPGU7ZCsrKWlmKGNbZF09PWIpcmV0dXJuITA7cmV0dXJuITF9XG5mdW5jdGlvbiB6KGEpe2lmKFwic3RyaW5nXCI9PT10eXBlb2YgYS5mKXJldHVybiBhLmY7dmFyIGI9YS5tLmxvY2F0aW9uLnByb3RvY29sO1wiYWJvdXQ6XCI9PWImJihiPWEuYS5sb2NhdGlvbi5wcm90b2NvbCk7cmV0dXJuXCJodHRwczpcIj09Yj9cImh0dHBzOlwiOlwiaHR0cDpcIn1mdW5jdGlvbiBlYShhKXtyZXR1cm4gYS5tLmxvY2F0aW9uLmhvc3RuYW1lfHxhLmEubG9jYXRpb24uaG9zdG5hbWV9XG5mdW5jdGlvbiBBKGEsYixjKXtmdW5jdGlvbiBkKCl7ayYmZSYmZiYmKGsoZyksaz1udWxsKX1iPXQoYSxcImxpbmtcIix7cmVsOlwic3R5bGVzaGVldFwiLGhyZWY6YixtZWRpYTpcImFsbFwifSk7dmFyIGU9ITEsZj0hMCxnPW51bGwsaz1jfHxudWxsO2RhPyhiLm9ubG9hZD1mdW5jdGlvbigpe2U9ITA7ZCgpfSxiLm9uZXJyb3I9ZnVuY3Rpb24oKXtlPSEwO2c9RXJyb3IoXCJTdHlsZXNoZWV0IGZhaWxlZCB0byBsb2FkXCIpO2QoKX0pOnNldFRpbWVvdXQoZnVuY3Rpb24oKXtlPSEwO2QoKX0sMCk7dShhLFwiaGVhZFwiLGIpfVxuZnVuY3Rpb24gQihhLGIsYyxkKXt2YXIgZT1hLmMuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJoZWFkXCIpWzBdO2lmKGUpe3ZhciBmPXQoYSxcInNjcmlwdFwiLHtzcmM6Yn0pLGc9ITE7Zi5vbmxvYWQ9Zi5vbnJlYWR5c3RhdGVjaGFuZ2U9ZnVuY3Rpb24oKXtnfHx0aGlzLnJlYWR5U3RhdGUmJlwibG9hZGVkXCIhPXRoaXMucmVhZHlTdGF0ZSYmXCJjb21wbGV0ZVwiIT10aGlzLnJlYWR5U3RhdGV8fChnPSEwLGMmJmMobnVsbCksZi5vbmxvYWQ9Zi5vbnJlYWR5c3RhdGVjaGFuZ2U9bnVsbCxcIkhFQURcIj09Zi5wYXJlbnROb2RlLnRhZ05hbWUmJmUucmVtb3ZlQ2hpbGQoZikpfTtlLmFwcGVuZENoaWxkKGYpO3NldFRpbWVvdXQoZnVuY3Rpb24oKXtnfHwoZz0hMCxjJiZjKEVycm9yKFwiU2NyaXB0IGxvYWQgdGltZW91dFwiKSkpfSxkfHw1RTMpO3JldHVybiBmfXJldHVybiBudWxsfTtmdW5jdGlvbiBDKCl7dGhpcy5hPTA7dGhpcy5jPW51bGx9ZnVuY3Rpb24gRChhKXthLmErKztyZXR1cm4gZnVuY3Rpb24oKXthLmEtLTtFKGEpfX1mdW5jdGlvbiBGKGEsYil7YS5jPWI7RShhKX1mdW5jdGlvbiBFKGEpezA9PWEuYSYmYS5jJiYoYS5jKCksYS5jPW51bGwpfTtmdW5jdGlvbiBHKGEpe3RoaXMuYT1hfHxcIi1cIn1HLnByb3RvdHlwZS5jPWZ1bmN0aW9uKGEpe2Zvcih2YXIgYj1bXSxjPTA7Yzxhcmd1bWVudHMubGVuZ3RoO2MrKyliLnB1c2goYXJndW1lbnRzW2NdLnJlcGxhY2UoL1tcXFdfXSsvZyxcIlwiKS50b0xvd2VyQ2FzZSgpKTtyZXR1cm4gYi5qb2luKHRoaXMuYSl9O2Z1bmN0aW9uIEgoYSxiKXt0aGlzLmM9YTt0aGlzLmY9NDt0aGlzLmE9XCJuXCI7dmFyIGM9KGJ8fFwibjRcIikubWF0Y2goL14oW25pb10pKFsxLTldKSQvaSk7YyYmKHRoaXMuYT1jWzFdLHRoaXMuZj1wYXJzZUludChjWzJdLDEwKSl9ZnVuY3Rpb24gZmEoYSl7cmV0dXJuIEkoYSkrXCIgXCIrKGEuZitcIjAwXCIpK1wiIDMwMHB4IFwiK0ooYS5jKX1mdW5jdGlvbiBKKGEpe3ZhciBiPVtdO2E9YS5zcGxpdCgvLFxccyovKTtmb3IodmFyIGM9MDtjPGEubGVuZ3RoO2MrKyl7dmFyIGQ9YVtjXS5yZXBsYWNlKC9bJ1wiXS9nLFwiXCIpOy0xIT1kLmluZGV4T2YoXCIgXCIpfHwvXlxcZC8udGVzdChkKT9iLnB1c2goXCInXCIrZCtcIidcIik6Yi5wdXNoKGQpfXJldHVybiBiLmpvaW4oXCIsXCIpfWZ1bmN0aW9uIEsoYSl7cmV0dXJuIGEuYSthLmZ9ZnVuY3Rpb24gSShhKXt2YXIgYj1cIm5vcm1hbFwiO1wib1wiPT09YS5hP2I9XCJvYmxpcXVlXCI6XCJpXCI9PT1hLmEmJihiPVwiaXRhbGljXCIpO3JldHVybiBifVxuZnVuY3Rpb24gZ2EoYSl7dmFyIGI9NCxjPVwiblwiLGQ9bnVsbDthJiYoKGQ9YS5tYXRjaCgvKG5vcm1hbHxvYmxpcXVlfGl0YWxpYykvaSkpJiZkWzFdJiYoYz1kWzFdLnN1YnN0cigwLDEpLnRvTG93ZXJDYXNlKCkpLChkPWEubWF0Y2goLyhbMS05XTAwfG5vcm1hbHxib2xkKS9pKSkmJmRbMV0mJigvYm9sZC9pLnRlc3QoZFsxXSk/Yj03Oi9bMS05XTAwLy50ZXN0KGRbMV0pJiYoYj1wYXJzZUludChkWzFdLnN1YnN0cigwLDEpLDEwKSkpKTtyZXR1cm4gYytifTtmdW5jdGlvbiBoYShhLGIpe3RoaXMuYz1hO3RoaXMuZj1hLm0uZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50O3RoaXMuaD1iO3RoaXMuYT1uZXcgRyhcIi1cIik7dGhpcy5qPSExIT09Yi5ldmVudHM7dGhpcy5nPSExIT09Yi5jbGFzc2VzfWZ1bmN0aW9uIGlhKGEpe2EuZyYmdyhhLmYsW2EuYS5jKFwid2ZcIixcImxvYWRpbmdcIildKTtMKGEsXCJsb2FkaW5nXCIpfWZ1bmN0aW9uIE0oYSl7aWYoYS5nKXt2YXIgYj15KGEuZixhLmEuYyhcIndmXCIsXCJhY3RpdmVcIikpLGM9W10sZD1bYS5hLmMoXCJ3ZlwiLFwibG9hZGluZ1wiKV07Ynx8Yy5wdXNoKGEuYS5jKFwid2ZcIixcImluYWN0aXZlXCIpKTt3KGEuZixjLGQpfUwoYSxcImluYWN0aXZlXCIpfWZ1bmN0aW9uIEwoYSxiLGMpe2lmKGEuaiYmYS5oW2JdKWlmKGMpYS5oW2JdKGMuYyxLKGMpKTtlbHNlIGEuaFtiXSgpfTtmdW5jdGlvbiBqYSgpe3RoaXMuYz17fX1mdW5jdGlvbiBrYShhLGIsYyl7dmFyIGQ9W10sZTtmb3IoZSBpbiBiKWlmKGIuaGFzT3duUHJvcGVydHkoZSkpe3ZhciBmPWEuY1tlXTtmJiZkLnB1c2goZihiW2VdLGMpKX1yZXR1cm4gZH07ZnVuY3Rpb24gTihhLGIpe3RoaXMuYz1hO3RoaXMuZj1iO3RoaXMuYT10KHRoaXMuYyxcInNwYW5cIix7XCJhcmlhLWhpZGRlblwiOlwidHJ1ZVwifSx0aGlzLmYpfWZ1bmN0aW9uIE8oYSl7dShhLmMsXCJib2R5XCIsYS5hKX1mdW5jdGlvbiBQKGEpe3JldHVyblwiZGlzcGxheTpibG9jaztwb3NpdGlvbjphYnNvbHV0ZTt0b3A6LTk5OTlweDtsZWZ0Oi05OTk5cHg7Zm9udC1zaXplOjMwMHB4O3dpZHRoOmF1dG87aGVpZ2h0OmF1dG87bGluZS1oZWlnaHQ6bm9ybWFsO21hcmdpbjowO3BhZGRpbmc6MDtmb250LXZhcmlhbnQ6bm9ybWFsO3doaXRlLXNwYWNlOm5vd3JhcDtmb250LWZhbWlseTpcIitKKGEuYykrXCI7XCIrKFwiZm9udC1zdHlsZTpcIitJKGEpK1wiO2ZvbnQtd2VpZ2h0OlwiKyhhLmYrXCIwMFwiKStcIjtcIil9O2Z1bmN0aW9uIFEoYSxiLGMsZCxlLGYpe3RoaXMuZz1hO3RoaXMuaj1iO3RoaXMuYT1kO3RoaXMuYz1jO3RoaXMuZj1lfHwzRTM7dGhpcy5oPWZ8fHZvaWQgMH1RLnByb3RvdHlwZS5zdGFydD1mdW5jdGlvbigpe3ZhciBhPXRoaXMuYy5tLmRvY3VtZW50LGI9dGhpcyxjPXEoKSxkPW5ldyBQcm9taXNlKGZ1bmN0aW9uKGQsZSl7ZnVuY3Rpb24gaygpe3EoKS1jPj1iLmY/ZSgpOmEuZm9udHMubG9hZChmYShiLmEpLGIuaCkudGhlbihmdW5jdGlvbihhKXsxPD1hLmxlbmd0aD9kKCk6c2V0VGltZW91dChrLDI1KX0sZnVuY3Rpb24oKXtlKCl9KX1rKCl9KSxlPW5ldyBQcm9taXNlKGZ1bmN0aW9uKGEsZCl7c2V0VGltZW91dChkLGIuZil9KTtQcm9taXNlLnJhY2UoW2UsZF0pLnRoZW4oZnVuY3Rpb24oKXtiLmcoYi5hKX0sZnVuY3Rpb24oKXtiLmooYi5hKX0pfTtmdW5jdGlvbiBSKGEsYixjLGQsZSxmLGcpe3RoaXMudj1hO3RoaXMuQj1iO3RoaXMuYz1jO3RoaXMuYT1kO3RoaXMucz1nfHxcIkJFU2Jzd3lcIjt0aGlzLmY9e307dGhpcy53PWV8fDNFMzt0aGlzLnU9Znx8bnVsbDt0aGlzLm89dGhpcy5qPXRoaXMuaD10aGlzLmc9bnVsbDt0aGlzLmc9bmV3IE4odGhpcy5jLHRoaXMucyk7dGhpcy5oPW5ldyBOKHRoaXMuYyx0aGlzLnMpO3RoaXMuaj1uZXcgTih0aGlzLmMsdGhpcy5zKTt0aGlzLm89bmV3IE4odGhpcy5jLHRoaXMucyk7YT1uZXcgSCh0aGlzLmEuYytcIixzZXJpZlwiLEsodGhpcy5hKSk7YT1QKGEpO3RoaXMuZy5hLnN0eWxlLmNzc1RleHQ9YTthPW5ldyBIKHRoaXMuYS5jK1wiLHNhbnMtc2VyaWZcIixLKHRoaXMuYSkpO2E9UChhKTt0aGlzLmguYS5zdHlsZS5jc3NUZXh0PWE7YT1uZXcgSChcInNlcmlmXCIsSyh0aGlzLmEpKTthPVAoYSk7dGhpcy5qLmEuc3R5bGUuY3NzVGV4dD1hO2E9bmV3IEgoXCJzYW5zLXNlcmlmXCIsSyh0aGlzLmEpKTthPVxuUChhKTt0aGlzLm8uYS5zdHlsZS5jc3NUZXh0PWE7Tyh0aGlzLmcpO08odGhpcy5oKTtPKHRoaXMuaik7Tyh0aGlzLm8pfXZhciBTPXtEOlwic2VyaWZcIixDOlwic2Fucy1zZXJpZlwifSxUPW51bGw7ZnVuY3Rpb24gVSgpe2lmKG51bGw9PT1UKXt2YXIgYT0vQXBwbGVXZWJLaXRcXC8oWzAtOV0rKSg/OlxcLihbMC05XSspKS8uZXhlYyh3aW5kb3cubmF2aWdhdG9yLnVzZXJBZ2VudCk7VD0hIWEmJig1MzY+cGFyc2VJbnQoYVsxXSwxMCl8fDUzNj09PXBhcnNlSW50KGFbMV0sMTApJiYxMT49cGFyc2VJbnQoYVsyXSwxMCkpfXJldHVybiBUfVIucHJvdG90eXBlLnN0YXJ0PWZ1bmN0aW9uKCl7dGhpcy5mLnNlcmlmPXRoaXMuai5hLm9mZnNldFdpZHRoO3RoaXMuZltcInNhbnMtc2VyaWZcIl09dGhpcy5vLmEub2Zmc2V0V2lkdGg7dGhpcy5BPXEoKTtsYSh0aGlzKX07XG5mdW5jdGlvbiBtYShhLGIsYyl7Zm9yKHZhciBkIGluIFMpaWYoUy5oYXNPd25Qcm9wZXJ0eShkKSYmYj09PWEuZltTW2RdXSYmYz09PWEuZltTW2RdXSlyZXR1cm4hMDtyZXR1cm4hMX1mdW5jdGlvbiBsYShhKXt2YXIgYj1hLmcuYS5vZmZzZXRXaWR0aCxjPWEuaC5hLm9mZnNldFdpZHRoLGQ7KGQ9Yj09PWEuZi5zZXJpZiYmYz09PWEuZltcInNhbnMtc2VyaWZcIl0pfHwoZD1VKCkmJm1hKGEsYixjKSk7ZD9xKCktYS5BPj1hLnc/VSgpJiZtYShhLGIsYykmJihudWxsPT09YS51fHxhLnUuaGFzT3duUHJvcGVydHkoYS5hLmMpKT9WKGEsYS52KTpWKGEsYS5CKTpuYShhKTpWKGEsYS52KX1mdW5jdGlvbiBuYShhKXtzZXRUaW1lb3V0KHAoZnVuY3Rpb24oKXtsYSh0aGlzKX0sYSksNTApfWZ1bmN0aW9uIFYoYSxiKXtzZXRUaW1lb3V0KHAoZnVuY3Rpb24oKXt2KHRoaXMuZy5hKTt2KHRoaXMuaC5hKTt2KHRoaXMuai5hKTt2KHRoaXMuby5hKTtiKHRoaXMuYSl9LGEpLDApfTtmdW5jdGlvbiBXKGEsYixjKXt0aGlzLmM9YTt0aGlzLmE9Yjt0aGlzLmY9MDt0aGlzLm89dGhpcy5qPSExO3RoaXMucz1jfXZhciBYPW51bGw7Vy5wcm90b3R5cGUuZz1mdW5jdGlvbihhKXt2YXIgYj10aGlzLmE7Yi5nJiZ3KGIuZixbYi5hLmMoXCJ3ZlwiLGEuYyxLKGEpLnRvU3RyaW5nKCksXCJhY3RpdmVcIildLFtiLmEuYyhcIndmXCIsYS5jLEsoYSkudG9TdHJpbmcoKSxcImxvYWRpbmdcIiksYi5hLmMoXCJ3ZlwiLGEuYyxLKGEpLnRvU3RyaW5nKCksXCJpbmFjdGl2ZVwiKV0pO0woYixcImZvbnRhY3RpdmVcIixhKTt0aGlzLm89ITA7b2EodGhpcyl9O1xuVy5wcm90b3R5cGUuaD1mdW5jdGlvbihhKXt2YXIgYj10aGlzLmE7aWYoYi5nKXt2YXIgYz15KGIuZixiLmEuYyhcIndmXCIsYS5jLEsoYSkudG9TdHJpbmcoKSxcImFjdGl2ZVwiKSksZD1bXSxlPVtiLmEuYyhcIndmXCIsYS5jLEsoYSkudG9TdHJpbmcoKSxcImxvYWRpbmdcIildO2N8fGQucHVzaChiLmEuYyhcIndmXCIsYS5jLEsoYSkudG9TdHJpbmcoKSxcImluYWN0aXZlXCIpKTt3KGIuZixkLGUpfUwoYixcImZvbnRpbmFjdGl2ZVwiLGEpO29hKHRoaXMpfTtmdW5jdGlvbiBvYShhKXswPT0tLWEuZiYmYS5qJiYoYS5vPyhhPWEuYSxhLmcmJncoYS5mLFthLmEuYyhcIndmXCIsXCJhY3RpdmVcIildLFthLmEuYyhcIndmXCIsXCJsb2FkaW5nXCIpLGEuYS5jKFwid2ZcIixcImluYWN0aXZlXCIpXSksTChhLFwiYWN0aXZlXCIpKTpNKGEuYSkpfTtmdW5jdGlvbiBwYShhKXt0aGlzLmo9YTt0aGlzLmE9bmV3IGphO3RoaXMuaD0wO3RoaXMuZj10aGlzLmc9ITB9cGEucHJvdG90eXBlLmxvYWQ9ZnVuY3Rpb24oYSl7dGhpcy5jPW5ldyBjYSh0aGlzLmosYS5jb250ZXh0fHx0aGlzLmopO3RoaXMuZz0hMSE9PWEuZXZlbnRzO3RoaXMuZj0hMSE9PWEuY2xhc3NlcztxYSh0aGlzLG5ldyBoYSh0aGlzLmMsYSksYSl9O1xuZnVuY3Rpb24gcmEoYSxiLGMsZCxlKXt2YXIgZj0wPT0tLWEuaDsoYS5mfHxhLmcpJiZzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7dmFyIGE9ZXx8bnVsbCxrPWR8fG51bGx8fHt9O2lmKDA9PT1jLmxlbmd0aCYmZilNKGIuYSk7ZWxzZXtiLmYrPWMubGVuZ3RoO2YmJihiLmo9Zik7dmFyIGgsbT1bXTtmb3IoaD0wO2g8Yy5sZW5ndGg7aCsrKXt2YXIgbD1jW2hdLG49a1tsLmNdLHI9Yi5hLHg9bDtyLmcmJncoci5mLFtyLmEuYyhcIndmXCIseC5jLEsoeCkudG9TdHJpbmcoKSxcImxvYWRpbmdcIildKTtMKHIsXCJmb250bG9hZGluZ1wiLHgpO3I9bnVsbDtpZihudWxsPT09WClpZih3aW5kb3cuRm9udEZhY2Upe3ZhciB4PS9HZWNrby4qRmlyZWZveFxcLyhcXGQrKS8uZXhlYyh3aW5kb3cubmF2aWdhdG9yLnVzZXJBZ2VudCkseWE9L09TIFguKlZlcnNpb25cXC8xMFxcLi4qU2FmYXJpLy5leGVjKHdpbmRvdy5uYXZpZ2F0b3IudXNlckFnZW50KSYmL0FwcGxlLy5leGVjKHdpbmRvdy5uYXZpZ2F0b3IudmVuZG9yKTtcblg9eD80MjxwYXJzZUludCh4WzFdLDEwKTp5YT8hMTohMH1lbHNlIFg9ITE7WD9yPW5ldyBRKHAoYi5nLGIpLHAoYi5oLGIpLGIuYyxsLGIucyxuKTpyPW5ldyBSKHAoYi5nLGIpLHAoYi5oLGIpLGIuYyxsLGIucyxhLG4pO20ucHVzaChyKX1mb3IoaD0wO2g8bS5sZW5ndGg7aCsrKW1baF0uc3RhcnQoKX19LDApfWZ1bmN0aW9uIHFhKGEsYixjKXt2YXIgZD1bXSxlPWMudGltZW91dDtpYShiKTt2YXIgZD1rYShhLmEsYyxhLmMpLGY9bmV3IFcoYS5jLGIsZSk7YS5oPWQubGVuZ3RoO2I9MDtmb3IoYz1kLmxlbmd0aDtiPGM7YisrKWRbYl0ubG9hZChmdW5jdGlvbihiLGQsYyl7cmEoYSxmLGIsZCxjKX0pfTtmdW5jdGlvbiBzYShhLGIpe3RoaXMuYz1hO3RoaXMuYT1ifWZ1bmN0aW9uIHRhKGEsYixjKXt2YXIgZD16KGEuYyk7YT0oYS5hLmFwaXx8XCJmYXN0LmZvbnRzLm5ldC9qc2FwaVwiKS5yZXBsYWNlKC9eLipodHRwKHM/KTooXFwvXFwvKT8vLFwiXCIpO3JldHVybiBkK1wiLy9cIithK1wiL1wiK2IrXCIuanNcIisoYz9cIj92PVwiK2M6XCJcIil9XG5zYS5wcm90b3R5cGUubG9hZD1mdW5jdGlvbihhKXtmdW5jdGlvbiBiKCl7aWYoZltcIl9fbXRpX2ZudExzdFwiK2RdKXt2YXIgYz1mW1wiX19tdGlfZm50THN0XCIrZF0oKSxlPVtdLGg7aWYoYylmb3IodmFyIG09MDttPGMubGVuZ3RoO20rKyl7dmFyIGw9Y1ttXS5mb250ZmFtaWx5O3ZvaWQgMCE9Y1ttXS5mb250U3R5bGUmJnZvaWQgMCE9Y1ttXS5mb250V2VpZ2h0PyhoPWNbbV0uZm9udFN0eWxlK2NbbV0uZm9udFdlaWdodCxlLnB1c2gobmV3IEgobCxoKSkpOmUucHVzaChuZXcgSChsKSl9YShlKX1lbHNlIHNldFRpbWVvdXQoZnVuY3Rpb24oKXtiKCl9LDUwKX12YXIgYz10aGlzLGQ9Yy5hLnByb2plY3RJZCxlPWMuYS52ZXJzaW9uO2lmKGQpe3ZhciBmPWMuYy5tO0IodGhpcy5jLHRhKGMsZCxlKSxmdW5jdGlvbihlKXtlP2EoW10pOihmW1wiX19Nb25vdHlwZUNvbmZpZ3VyYXRpb25fX1wiK2RdPWZ1bmN0aW9uKCl7cmV0dXJuIGMuYX0sYigpKX0pLmlkPVwiX19Nb25vdHlwZUFQSVNjcmlwdF9fXCIrXG5kfWVsc2UgYShbXSl9O2Z1bmN0aW9uIHVhKGEsYil7dGhpcy5jPWE7dGhpcy5hPWJ9dWEucHJvdG90eXBlLmxvYWQ9ZnVuY3Rpb24oYSl7dmFyIGIsYyxkPXRoaXMuYS51cmxzfHxbXSxlPXRoaXMuYS5mYW1pbGllc3x8W10sZj10aGlzLmEudGVzdFN0cmluZ3N8fHt9LGc9bmV3IEM7Yj0wO2ZvcihjPWQubGVuZ3RoO2I8YztiKyspQSh0aGlzLmMsZFtiXSxEKGcpKTt2YXIgaz1bXTtiPTA7Zm9yKGM9ZS5sZW5ndGg7YjxjO2IrKylpZihkPWVbYl0uc3BsaXQoXCI6XCIpLGRbMV0pZm9yKHZhciBoPWRbMV0uc3BsaXQoXCIsXCIpLG09MDttPGgubGVuZ3RoO20rPTEpay5wdXNoKG5ldyBIKGRbMF0saFttXSkpO2Vsc2Ugay5wdXNoKG5ldyBIKGRbMF0pKTtGKGcsZnVuY3Rpb24oKXthKGssZil9KX07ZnVuY3Rpb24gdmEoYSxiLGMpe2E/dGhpcy5jPWE6dGhpcy5jPWIrd2E7dGhpcy5hPVtdO3RoaXMuZj1bXTt0aGlzLmc9Y3x8XCJcIn12YXIgd2E9XCIvL2ZvbnRzLmdvb2dsZWFwaXMuY29tL2Nzc1wiO2Z1bmN0aW9uIHhhKGEsYil7Zm9yKHZhciBjPWIubGVuZ3RoLGQ9MDtkPGM7ZCsrKXt2YXIgZT1iW2RdLnNwbGl0KFwiOlwiKTszPT1lLmxlbmd0aCYmYS5mLnB1c2goZS5wb3AoKSk7dmFyIGY9XCJcIjsyPT1lLmxlbmd0aCYmXCJcIiE9ZVsxXSYmKGY9XCI6XCIpO2EuYS5wdXNoKGUuam9pbihmKSl9fVxuZnVuY3Rpb24gemEoYSl7aWYoMD09YS5hLmxlbmd0aCl0aHJvdyBFcnJvcihcIk5vIGZvbnRzIHRvIGxvYWQhXCIpO2lmKC0xIT1hLmMuaW5kZXhPZihcImtpdD1cIikpcmV0dXJuIGEuYztmb3IodmFyIGI9YS5hLmxlbmd0aCxjPVtdLGQ9MDtkPGI7ZCsrKWMucHVzaChhLmFbZF0ucmVwbGFjZSgvIC9nLFwiK1wiKSk7Yj1hLmMrXCI/ZmFtaWx5PVwiK2Muam9pbihcIiU3Q1wiKTswPGEuZi5sZW5ndGgmJihiKz1cIiZzdWJzZXQ9XCIrYS5mLmpvaW4oXCIsXCIpKTswPGEuZy5sZW5ndGgmJihiKz1cIiZ0ZXh0PVwiK2VuY29kZVVSSUNvbXBvbmVudChhLmcpKTtyZXR1cm4gYn07ZnVuY3Rpb24gQWEoYSl7dGhpcy5mPWE7dGhpcy5hPVtdO3RoaXMuYz17fX1cbnZhciBCYT17bGF0aW46XCJCRVNic3d5XCIsXCJsYXRpbi1leHRcIjpcIlxcdTAwZTdcXHUwMGY2XFx1MDBmY1xcdTAxMWZcXHUwMTVmXCIsY3lyaWxsaWM6XCJcXHUwNDM5XFx1MDQ0ZlxcdTA0MTZcIixncmVlazpcIlxcdTAzYjFcXHUwM2IyXFx1MDNhM1wiLGtobWVyOlwiXFx1MTc4MFxcdTE3ODFcXHUxNzgyXCIsSGFudW1hbjpcIlxcdTE3ODBcXHUxNzgxXFx1MTc4MlwifSxDYT17dGhpbjpcIjFcIixleHRyYWxpZ2h0OlwiMlwiLFwiZXh0cmEtbGlnaHRcIjpcIjJcIix1bHRyYWxpZ2h0OlwiMlwiLFwidWx0cmEtbGlnaHRcIjpcIjJcIixsaWdodDpcIjNcIixyZWd1bGFyOlwiNFwiLGJvb2s6XCI0XCIsbWVkaXVtOlwiNVwiLFwic2VtaS1ib2xkXCI6XCI2XCIsc2VtaWJvbGQ6XCI2XCIsXCJkZW1pLWJvbGRcIjpcIjZcIixkZW1pYm9sZDpcIjZcIixib2xkOlwiN1wiLFwiZXh0cmEtYm9sZFwiOlwiOFwiLGV4dHJhYm9sZDpcIjhcIixcInVsdHJhLWJvbGRcIjpcIjhcIix1bHRyYWJvbGQ6XCI4XCIsYmxhY2s6XCI5XCIsaGVhdnk6XCI5XCIsbDpcIjNcIixyOlwiNFwiLGI6XCI3XCJ9LERhPXtpOlwiaVwiLGl0YWxpYzpcImlcIixuOlwiblwiLG5vcm1hbDpcIm5cIn0sXG5FYT0vXih0aGlufCg/Oig/OmV4dHJhfHVsdHJhKS0/KT9saWdodHxyZWd1bGFyfGJvb2t8bWVkaXVtfCg/Oig/OnNlbWl8ZGVtaXxleHRyYXx1bHRyYSktPyk/Ym9sZHxibGFja3xoZWF2eXxsfHJ8YnxbMS05XTAwKT8obnxpfG5vcm1hbHxpdGFsaWMpPyQvO1xuZnVuY3Rpb24gRmEoYSl7Zm9yKHZhciBiPWEuZi5sZW5ndGgsYz0wO2M8YjtjKyspe3ZhciBkPWEuZltjXS5zcGxpdChcIjpcIiksZT1kWzBdLnJlcGxhY2UoL1xcKy9nLFwiIFwiKSxmPVtcIm40XCJdO2lmKDI8PWQubGVuZ3RoKXt2YXIgZzt2YXIgaz1kWzFdO2c9W107aWYoaylmb3IodmFyIGs9ay5zcGxpdChcIixcIiksaD1rLmxlbmd0aCxtPTA7bTxoO20rKyl7dmFyIGw7bD1rW21dO2lmKGwubWF0Y2goL15bXFx3LV0rJC8pKXt2YXIgbj1FYS5leGVjKGwudG9Mb3dlckNhc2UoKSk7aWYobnVsbD09bilsPVwiXCI7ZWxzZXtsPW5bMl07bD1udWxsPT1sfHxcIlwiPT1sP1wiblwiOkRhW2xdO249blsxXTtpZihudWxsPT1ufHxcIlwiPT1uKW49XCI0XCI7ZWxzZSB2YXIgcj1DYVtuXSxuPXI/cjppc05hTihuKT9cIjRcIjpuLnN1YnN0cigwLDEpO2w9W2wsbl0uam9pbihcIlwiKX19ZWxzZSBsPVwiXCI7bCYmZy5wdXNoKGwpfTA8Zy5sZW5ndGgmJihmPWcpOzM9PWQubGVuZ3RoJiYoZD1kWzJdLGc9W10sZD1kP2Quc3BsaXQoXCIsXCIpOlxuZywwPGQubGVuZ3RoJiYoZD1CYVtkWzBdXSkmJihhLmNbZV09ZCkpfWEuY1tlXXx8KGQ9QmFbZV0pJiYoYS5jW2VdPWQpO2ZvcihkPTA7ZDxmLmxlbmd0aDtkKz0xKWEuYS5wdXNoKG5ldyBIKGUsZltkXSkpfX07ZnVuY3Rpb24gR2EoYSxiKXt0aGlzLmM9YTt0aGlzLmE9Yn12YXIgSGE9e0FyaW1vOiEwLENvdXNpbmU6ITAsVGlub3M6ITB9O0dhLnByb3RvdHlwZS5sb2FkPWZ1bmN0aW9uKGEpe3ZhciBiPW5ldyBDLGM9dGhpcy5jLGQ9bmV3IHZhKHRoaXMuYS5hcGkseihjKSx0aGlzLmEudGV4dCksZT10aGlzLmEuZmFtaWxpZXM7eGEoZCxlKTt2YXIgZj1uZXcgQWEoZSk7RmEoZik7QShjLHphKGQpLEQoYikpO0YoYixmdW5jdGlvbigpe2EoZi5hLGYuYyxIYSl9KX07ZnVuY3Rpb24gSWEoYSxiKXt0aGlzLmM9YTt0aGlzLmE9Yn1JYS5wcm90b3R5cGUubG9hZD1mdW5jdGlvbihhKXt2YXIgYj10aGlzLmEuaWQsYz10aGlzLmMubTtiP0IodGhpcy5jLCh0aGlzLmEuYXBpfHxcImh0dHBzOi8vdXNlLnR5cGVraXQubmV0XCIpK1wiL1wiK2IrXCIuanNcIixmdW5jdGlvbihiKXtpZihiKWEoW10pO2Vsc2UgaWYoYy5UeXBla2l0JiZjLlR5cGVraXQuY29uZmlnJiZjLlR5cGVraXQuY29uZmlnLmZuKXtiPWMuVHlwZWtpdC5jb25maWcuZm47Zm9yKHZhciBlPVtdLGY9MDtmPGIubGVuZ3RoO2YrPTIpZm9yKHZhciBnPWJbZl0saz1iW2YrMV0saD0wO2g8ay5sZW5ndGg7aCsrKWUucHVzaChuZXcgSChnLGtbaF0pKTt0cnl7Yy5UeXBla2l0LmxvYWQoe2V2ZW50czohMSxjbGFzc2VzOiExLGFzeW5jOiEwfSl9Y2F0Y2gobSl7fWEoZSl9fSwyRTMpOmEoW10pfTtmdW5jdGlvbiBKYShhLGIpe3RoaXMuYz1hO3RoaXMuZj1iO3RoaXMuYT1bXX1KYS5wcm90b3R5cGUubG9hZD1mdW5jdGlvbihhKXt2YXIgYj10aGlzLmYuaWQsYz10aGlzLmMubSxkPXRoaXM7Yj8oYy5fX3dlYmZvbnRmb250ZGVja21vZHVsZV9ffHwoYy5fX3dlYmZvbnRmb250ZGVja21vZHVsZV9fPXt9KSxjLl9fd2ViZm9udGZvbnRkZWNrbW9kdWxlX19bYl09ZnVuY3Rpb24oYixjKXtmb3IodmFyIGc9MCxrPWMuZm9udHMubGVuZ3RoO2c8azsrK2cpe3ZhciBoPWMuZm9udHNbZ107ZC5hLnB1c2gobmV3IEgoaC5uYW1lLGdhKFwiZm9udC13ZWlnaHQ6XCIraC53ZWlnaHQrXCI7Zm9udC1zdHlsZTpcIitoLnN0eWxlKSkpfWEoZC5hKX0sQih0aGlzLmMseih0aGlzLmMpKyh0aGlzLmYuYXBpfHxcIi8vZi5mb250ZGVjay5jb20vcy9jc3MvanMvXCIpK2VhKHRoaXMuYykrXCIvXCIrYitcIi5qc1wiLGZ1bmN0aW9uKGIpe2ImJmEoW10pfSkpOmEoW10pfTt2YXIgWT1uZXcgcGEod2luZG93KTtZLmEuYy5jdXN0b209ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbmV3IHVhKGIsYSl9O1kuYS5jLmZvbnRkZWNrPWZ1bmN0aW9uKGEsYil7cmV0dXJuIG5ldyBKYShiLGEpfTtZLmEuYy5tb25vdHlwZT1mdW5jdGlvbihhLGIpe3JldHVybiBuZXcgc2EoYixhKX07WS5hLmMudHlwZWtpdD1mdW5jdGlvbihhLGIpe3JldHVybiBuZXcgSWEoYixhKX07WS5hLmMuZ29vZ2xlPWZ1bmN0aW9uKGEsYil7cmV0dXJuIG5ldyBHYShiLGEpfTt2YXIgWj17bG9hZDpwKFkubG9hZCxZKX07XCJmdW5jdGlvblwiPT09dHlwZW9mIGRlZmluZSYmZGVmaW5lLmFtZD9kZWZpbmUoZnVuY3Rpb24oKXtyZXR1cm4gWn0pOlwidW5kZWZpbmVkXCIhPT10eXBlb2YgbW9kdWxlJiZtb2R1bGUuZXhwb3J0cz9tb2R1bGUuZXhwb3J0cz1aOih3aW5kb3cuV2ViRm9udD1aLHdpbmRvdy5XZWJGb250Q29uZmlnJiZZLmxvYWQod2luZG93LldlYkZvbnRDb25maWcpKTt9KCkpO1xuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9+L3dlYmZvbnRsb2FkZXIvd2ViZm9udGxvYWRlci5qc1xuLy8gbW9kdWxlIGlkID0gNVxuLy8gbW9kdWxlIGNodW5rcyA9IDAiXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==");

/***/ }),
/* 6 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\n__webpack_require__(0);\n\n__webpack_require__(1);\n\n__webpack_require__(2);\n\nconsole.log(true);//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNi5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL2pzL21haW4uanM/MTgxMyJdLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG5cbnJlcXVpcmUoJy4vX2Zhc3RjbGljaycpO1xuXG5yZXF1aXJlKCcuL19mb250cycpO1xuXG5yZXF1aXJlKCcuL192aWRlb3MnKTtcblxuY29uc29sZS5sb2codHJ1ZSk7XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9qcy9tYWluLmpzXG4vLyBtb2R1bGUgaWQgPSA2XG4vLyBtb2R1bGUgY2h1bmtzID0gMCJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlUm9vdCI6IiJ9");

/***/ })
/******/ ]);